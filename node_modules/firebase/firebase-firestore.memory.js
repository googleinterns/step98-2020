!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(lf){"use strict";try{(function(){lf=lf&&Object.prototype.hasOwnProperty.call(lf,"default")?lf.default:lf;var t,p,e,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function l(t,s,u,a){return new(u=u||Promise)(function(n,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function r(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(i,r)}o((a=a.apply(t,s||[])).next())})}function d(n,i){var r,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=i.call(n,u)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";function r(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+r+"]  "+t.name+":"],n))}}var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},u=p.INFO,a=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!0,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},c);function c(t){this.name=t,this._logLevel=u,this._logHandler=r,this._userLogHandler=null}function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var f,g="FirebaseError",m=(n(w,f=Error),w);function w(t,e){var n=f.call(this,e)||this;return n.code=t,n.name=g,Object.setPrototypeOf(n,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,b.prototype.create),n}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(i=r,s.replace(I,function(t,e){var n=i[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new m(o,a),c=0,f=Object.keys(r);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=r[l])}return h},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=(A.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},A.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},A.prototype.setServiceProps=function(t){return this.serviceProps=t,this},A);function A(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}function N(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var _,D="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=S||{},R=D||self;function O(){}function k(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function P(t){var e=k(t);return"array"==e||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var U="closure_uid_"+(1e9*Math.random()>>>0),V=0;function M(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function q(t,e,n){return(q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?M:C).apply(null,arguments)}function x(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now||function(){return+new Date};function F(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function B(){this.j,this.i}B.prototype.j=!1,B.prototype.da=function(){var t;!this.j&&(this.j=!0,this.C(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,U)&&t[U]||(t[U]=++V))},B.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},z=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function H(t){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function Q(t){return/^[\s\xa0]*$/.test(t)}var Y,X=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function K(t,e){return-1!=t.indexOf(e)}function $(t,e){return t<e?-1:e<t?1:0}t:{var J=R.navigator;if(J){var Z=J.userAgent;if(Z){Y=Z;break t}}Y=""}function tt(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function et(t){var e={};for(var n in t)e[n]=t[n];return e}var nt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function it(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<nt.length;o++)n=nt[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function rt(t){return rt[" "](t),t}rt[" "]=O;var ot,st,ut=K(Y,"Opera"),at=K(Y,"Trident")||K(Y,"MSIE"),ht=K(Y,"Edge"),ct=ht||at,ft=K(Y,"Gecko")&&!(K(Y.toLowerCase(),"webkit")&&!K(Y,"Edge"))&&!(K(Y,"Trident")||K(Y,"MSIE"))&&!K(Y,"Edge"),lt=K(Y.toLowerCase(),"webkit")&&!K(Y,"Edge");function pt(){var t=R.document;return t?t.documentMode:void 0}t:{var dt="",yt=(st=Y,ft?/rv:([^\);]+)(\)|;)/.exec(st):ht?/Edge\/([\d\.]+)/.exec(st):at?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(st):lt?/WebKit\/(\S+)/.exec(st):ut?/(?:Version)[ \/]?(\S+)/.exec(st):void 0);if(yt&&(dt=yt?yt[1]:""),at){var vt=pt();if(null!=vt&&vt>parseFloat(dt)){ot=String(vt);break t}}ot=dt}var gt={};function mt(u){return t=u,e=function(){for(var t=0,e=X(String(ot)).split("."),n=X(String(u)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=$(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||$(0==o[2].length,0==s[2].length)||$(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=gt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var wt=R.document&&at?pt()||(parseInt(ot,10)||void 0):void 0,bt=!at||9<=Number(wt),Et=at&&!mt("9"),It=function(){if(!R.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{R.addEventListener("test",O,e),R.removeEventListener("test",O,e)}catch(t){}return t}();function Tt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function At(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ft){t:{try{rt(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Tt.prototype.b=function(){this.defaultPrevented=!0},F(At,Tt);var Nt={2:"touch",3:"pen",4:"mouse"};At.prototype.b=function(){At.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Et)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var _t="closure_listenable_"+(1e6*Math.random()|0),Dt=0;function St(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.aa=r,this.key=++Dt,this.V=this.X=!1}function Rt(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function Ot(t){this.src=t,this.a={},this.b=0}function kt(t,e){var n,i,r,o=e.type;o in t.a&&(n=t.a[o],(r=0<=(i=G(n,e)))&&Array.prototype.splice.call(n,i,1),r&&(Rt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Pt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==i)return r}return-1}Ot.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Pt(t,e,i,r);return-1<s?(e=t[s],n||(e.X=!1)):((e=new St(e,this.src,o,!!i,r)).X=n,t.push(e)),e};var Lt="closure_lm_"+(1e6*Math.random()|0),Ut={};function Vt(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}i=Gt(i);return e&&e[_t]?e.sa(n,i,L(r)?!!r.capture:!!r,o):Mt(e,n,i,!0,r,o)}(t,e,n,i,r);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vt(t,e[o],n,i,r);return null}return n=Gt(n),t&&t[_t]?t.ra(e,n,L(i)?!!i.capture:!!i,r):Mt(t,e,n,!1,i,r)}function Mt(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=L(r)?!!r.capture:!!r;if(s&&!bt)return null;var u,a,h=Ft(t);if(h||(t[Lt]=h=new Ot(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(u=jt,i=a=bt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)It||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(qt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Ct(t){var e,n,i;"number"!=typeof t&&t&&!t.V&&((e=t.src)&&e[_t]?kt(e.c,t):(n=t.type,i=t.proxy,e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(qt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Ft(e))?(kt(n,t),0==n.b&&(n.src=null,e[Lt]=null)):Rt(t)))}function qt(t){return t in Ut?Ut[t]:Ut[t]="on"+t}function xt(t,e){var n=t.listener,i=t.aa||t.src;return t.X&&Ct(t),n.call(i,e)}function jt(t,e){if(t.V)return!0;if(bt)return xt(t,new At(e,this));if(!e)t:{e=["window","event"];for(var n=R,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}return xt(t,e=new At(e,this))}function Ft(t){return(t=t[Lt])instanceof Ot?t:null}var Bt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gt(e){return"function"==k(e)?e:(e[Bt]||(e[Bt]=function(t){return e.handleEvent(t)}),e[Bt])}function zt(){B.call(this),this.c=new Ot(this),(this.J=this).A=null}function Ht(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.V&&a.capture==n&&(s=a.listener,u=a.aa||a.src,a.X&&kt(t.c,a),r=!1!==s.call(u,i)&&r)}return r&&!i.defaultPrevented}F(zt,B),zt.prototype[_t]=!0,(_=zt.prototype).addEventListener=function(t,e,n,i){Vt(this,t,e,n,i)},_.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=L(r)?!!r.capture:!!r,i=Gt(i),e&&e[_t]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Pt(s=e.a[n],i,r,o))&&(Rt(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ft(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Pt(n,i,r,o)),(i=-1<e?n[e]:null)&&Ct(i))}(this,t,e,n,i)},_.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var i=t.type||t;if("string"==typeof t?t=new Tt(t,n):t instanceof Tt?t.target=t.target||n:(s=t,it(t=new Tt(i,n),s)),s=!0,e)for(var r=e.length-1;0<=r;r--)var o=t.a=e[r],s=Ht(o,i,!0,t)&&s;if(s=Ht(o=t.a=n,i,!0,t)&&s,s=Ht(o,i,!1,t)&&s,e)for(r=0;r<e.length;r++)s=Ht(o=t.a=e[r],i,!1,t)&&s;return s},_.C=function(){if(zt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)Rt(n[i]);delete e.a[t],e.b--}}this.A=null},_.ra=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},_.sa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var Wt=R.JSON.stringify;function Qt(){this.b=this.a=null}var Yt,Xt=(Kt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Kt(function(){return new $t},function(t){t.reset()},100));function Kt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function $t(){this.next=this.b=this.a=null}function Jt(t,e){var n;Yt||(n=R.Promise.resolve(void 0),Yt=function(){n.then(ee)}),Zt||(Yt(),Zt=!0),te.add(t,e)}Qt.prototype.add=function(t,e){var n=Xt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},$t.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Zt=!($t.prototype.reset=function(){this.next=this.b=this.a=null}),te=new Qt;function ee(){for(var t,e,n;n=e=void 0,n=null,(e=te).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){R.setTimeout(function(){throw t},0)}(t)}var i=Xt;i.g(t),i.b<i.f&&(i.b++,t.next=i.a,i.a=t)}Zt=!1}function ne(t,e){zt.call(this),this.b=t||1,this.a=e||R,this.f=q(this.Ua,this),this.g=j()}function ie(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function re(t,e,n){if("function"==k(t))n&&(t=q(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=q(t.handleEvent,t)}return 2147483647<Number(e)?-1:R.setTimeout(t,e||0)}function oe(t,e,n){B.call(this),this.f=null!=n?q(t,n):t,this.c=e,this.b=q(this.Pa,this),this.a=[]}function se(t){t.T=re(t.b,t.c),t.f.apply(null,t.a)}function ue(t){B.call(this),this.b=t,this.a={}}F(ne,zt),(_=ne.prototype).Z=!1,_.L=null,_.Ua=function(){var t;this.Z&&(0<(t=j()-this.g)&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(ie(this),this.start())))},_.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=j())},_.C=function(){ne.M.C.call(this),ie(this),delete this.a},F(oe,B),(_=oe.prototype).ba=!1,_.T=null,_.Ia=function(t){this.a=arguments,this.T?this.ba=!0:se(this)},_.C=function(){oe.M.C.call(this),this.T&&(R.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},_.Pa=function(){this.T=null,this.ba&&(this.ba=!1,se(this))},F(ue,B);var ae=[];function he(t,e,n,i){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var r=0;r<n.length;r++){var o=Vt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){tt(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ct(t)},t),t.a={}}function fe(){}ue.prototype.C=function(){ue.M.C.call(this),ce(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var le=null;function pe(){return le=le||new zt}function de(t){Tt.call(this,"serverreachability",t)}function ye(t){var e=pe();e.dispatchEvent(new de(e))}function ve(t){Tt.call(this,"statevent",t)}function ge(t){var e=pe();e.dispatchEvent(new ve(e))}function me(t){Tt.call(this,"timingevent",t)}function we(t,e){if("function"!=k(t))throw Error("Fn must not be null and must be a function");return R.setTimeout(function(){t()},e)}F(de,Tt),F(ve,Tt),F(me,Tt);var be={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},Ee={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function Ie(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}Ie.prototype.a=null;var Ne,_e={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function De(){Tt.call(this,"d")}function Se(){Tt.call(this,"c")}function Re(){}function Oe(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new ue(this),this.N=ke,t=ct?125:void 0,this.O=new ne(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}F(De,Tt),F(Se,Tt),F(Re,Ie),Ne=new Re;var ke=45e3,Pe={},Le={};function Ue(t,e,n){t.B=1,t.f=en(Xe(e)),t.j=n,t.F=!0,Ve(t,null)}function Ve(t,e){t.s=j(),Ce(t),t.A=Xe(t.f);var n=t.A,i=t.U;Array.isArray(i)||(i=[String(i)]),yn(n.b,"t",i),t.w=0,t.a=oi(t.g,t.g.w?e:null),0<t.J&&(t.D=new oe(q(t.ya,t,t.a),t.J)),he(t.G,t.a,"readystatechange",t.Sa),e=t.m?et(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),ye(1)}function Me(t,e,n){for(var i,r,o,s,u=!0;!t.l&&t.w<n.length;){var a=(r=n,s=o=void 0,o=(i=t).w,-1==(s=r.indexOf("\n",o))?Le:(o=Number(r.substring(o,s)),isNaN(o)?Pe:(s+=1)+o>r.length?Le:(r=r.substr(s,o),i.w=s+o,r)));if(a==Le){4==e&&(t.c=4,ge(14),u=!1);break}if(a==Pe){t.c=4,ge(15),u=!1;break}Be(t,a)}4==e&&0==n.length&&(t.c=1,ge(16),u=!1),t.b=t.b&&u,u||(Fe(t),je(t))}function Ce(t){t.P=j()+t.N,qe(t,t.N)}function qe(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=we(q(t.Qa,t),e)}function xe(t){t.h&&(R.clearTimeout(t.h),t.h=null)}function je(t){0==t.g.u||t.l||ti(t.g,t)}function Fe(t){xe(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,ie(t.O),ce(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function Be(t,e){try{var n,i,r,o,s,u,a,h,c,f,l=t.g;if(0!=l.u&&(l.a==t||In(l.b,t)))if(l.A=t.H,!t.o&&In(l.b,t)&&3==l.u){try{var p=l.ja.a.parse(e)}catch(t){p=null}if(Array.isArray(p)&&3==p.length){var d=p;if(0==d[0]){t:if(!l.i){if(l.a){if(!(l.a.s+3e3<t.s))break t;Zn(l),l.a.cancel(),l.a=null}Jn(l),ge(18)}}else l.ia=d[1],0<l.ia-l.G&&d[2]<37500&&l.U&&0==l.m&&!l.l&&(l.l=we(q(l.Na,l),6e3));if(En(l.b)<=1&&l.O){try{l.O()}catch(t){}l.O=void 0}}else ni(l,11)}else if(!t.o&&l.a!=t||Zn(l),!Q(e))for(e=p=l.ja.a.parse(e),p=0;p<e.length;p++){d=e[p],l.G=d[0],d=d[1],2==l.u?"c"==d[0]?(l.B=d[1],l.R=d[2],null!=(n=d[3])&&(l.oa=n),null!=(i=d[5])&&"number"==typeof i&&0<i&&(l.D=1.5*i),r=l,(o=t.a)&&(!(s=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=r.b).a&&(K(s,"spdy")||K(s,"quic")||K(s,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(Tn(u,u.b),u.b=null)),!r.s||(a=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(r.ha=a,tn(r.v,r.s,a))),l.u=3,l.c&&l.c.na(),h=t,(r=l).ea=ri(r,r.w?r.R:null,r.P),h.o?(An(r.b,h),c=h,(f=r.D)&&c.setTimeout(f),c.h&&(xe(c),Ce(c)),r.a=h):$n(r),0<l.f.length&&Qn(l)):"stop"!=d[0]&&"close"!=d[0]||ni(l,7):3==l.u&&("stop"==d[0]||"close"==d[0]?"stop"==d[0]?ni(l,7):zn(l):"noop"!=d[0]&&l.c&&l.c.ma(d),l.m=0)}ye(4)}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(P(t)||"string"==typeof t)z(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(P(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(P(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof ze)for(n=t.K(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];We(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){for(var r={},n=e=0;e<t.a.length;)We(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function We(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(_=Oe.prototype).setTimeout=function(t){this.N=t},_.Sa=function(t){t=t.target;var e=this.D;e&&3==jn(t)?e.Ia():this.ya(t)},_.ya=function(t){try{if(t==this.a)t:{var e=jn(this.a),n=this.a.qa(),i=this.a.S();if(!(e<3||3==e&&!ct&&!this.a.Y())){this.l||4!=e||7==n||ye(8==n||i<=0?3:2),xe(this);var r=this.a.S();this.H=r;var o=this.a.Y();if(this.b=200==r){if(this.R&&!this.o){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.c=3,ge(12),Fe(this),je(this);break t}this.o=!0,Be(this,a)}this.F?(Me(this,e,o),ct&&this.b&&3==e&&(he(this.G,this.O,"tick",this.Ra),this.O.start())):Be(this,o),4==e&&Fe(this),this.b&&!this.l&&(4==e?ti(this.g,this):(this.b=!1,Ce(this)))}else 400==r&&0<o.indexOf("Unknown SID")?(this.c=3,ge(12)):(this.c=0,ge(13)),Fe(this),je(this)}}}catch(t){}},_.Ra=function(){var t,e;this.a&&(t=jn(this.a),e=this.a.Y(),this.w<e.length&&(xe(this),Me(this,t,e),this.b&&4!=t&&Ce(this)))},_.cancel=function(){this.l=!0,Fe(this)},_.Qa=function(){this.h=null;var t=j();0<=t-this.P?(2!=this.B&&(ye(3),ge(17)),Fe(this),this.c=2,je(this)):qe(this,this.P-t)},(_=ze.prototype).I=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},_.K=function(){return He(this),this.a.concat()},_.get=function(t,e){return We(this.b,t)?this.b[t]:e},_.set=function(t,e){We(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},_.forEach=function(t,e){for(var n=this.K(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ye(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ye?(this.a=void 0!==e?e:t.a,Ke(this,t.f),this.j=t.j,$e(this,t.c),Je(this,t.h),this.g=t.g,e=t.b,(n=new fn).c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),Ze(this,n),this.i=t.i):t&&(n=String(t).match(Qe))?(this.a=!!e,Ke(this,n[1]||"",!0),this.j=nn(n[2]||""),$e(this,n[3]||"",!0),Je(this,n[4]),this.g=nn(n[5]||"",!0),Ze(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Xe(t){return new Ye(t)}function Ke(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?nn(e,!0):e}function Je(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ze(t,e,n){var i,r;e instanceof fn?(t.b=e,i=t.b,(r=t.a)&&!i.f&&(ln(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},i)),i.f=r):(n||(e=rn(e,hn)),t.b=new fn(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ye.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,cn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,hn=/[#\?@]/g,cn=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(n){n.a||(n.a=new ze,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i,r=t[n].indexOf("="),o=null;0<=r?(i=t[n].substring(0,r),o=t[n].substring(r+1)):i=t[n],e(i,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function pn(t,e){ln(t),e=vn(t,e),We(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function dn(t,e){return ln(t),e=vn(t,e),We(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),W(n)),t.b+=n.length)}function vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t,e){this.b=t,this.a=e}function mn(t){this.g=t||wn,t=R.PerformanceNavigationTiming?0<(t=R.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(R.ca&&R.ca.ua&&R.ca.ua()&&R.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(_=fn.prototype).add=function(t,e){ln(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},_.forEach=function(n,i){ln(this),this.a.forEach(function(t,e){z(t,function(t){n.call(i,t,e,this)},this)},this)},_.K=function(){ln(this);for(var t=this.a.I(),e=this.a.K(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},_.I=function(t){ln(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=H(e,this.a.get(vn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=H(e,t[n])}return e},_.set=function(t,e){return ln(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},_.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},_.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++)for(var i=e[n],r=encodeURIComponent(String(i)),i=this.I(i),o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}return this.c=t.join("&")};var wn=10;function bn(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return W(t.c);var i=t.c;try{for(var r=N(t.a.values()),o=r.next();!o.done;o=r.next())var s=o.value,i=i.concat(s.i)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function _n(){}function Dn(){this.a=new _n}function Sn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}mn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=N(this.a.values()),i=n.next();!i.done;i=n.next()){i.value.cancel()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},_n.prototype.stringify=function(t){return R.JSON.stringify(t,void 0)},_n.prototype.parse=function(t){return R.JSON.parse(t,void 0)};var Rn=R.JSON.parse;function On(t){zt.call(this),this.headers=new ze,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=kn,this.B=this.F=!1}F(On,zt);var kn="",Pn=/^https?$/i,Ln=["POST","PUT"];function Un(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Mn(t),qn(t)}function Mn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Cn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=jn(t)||2!=t.S()))if(t.l&&4==jn(t))re(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==jn(t)){t.b=!1;try{var e,n,i,r,o=t.S();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(r=String(t.D).match(Qe)[1]||null)&&R.self&&R.self.location&&(r=(i=R.self.location.protocol).substr(0,i.length-1)),n=!Pn.test(r?r.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<jn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.S()+"]",Mn(t)}}finally{qn(t)}}}function qn(t,e){if(t.a){xn(t);var n=t.a,i=t.s[0]?O:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function xn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(R.clearTimeout(t.m),t.m=null)}function jn(t){return t.a?t.a.readyState:0}function Fn(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}var r;i||(r="",tt(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function Bn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=Bn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=Bn("baseRetryDelayMs",5e3,t),this.Ga=Bn("retryDelaySeedMs",1e4,t),this.Da=Bn("forwardChannelMaxRetries",2,t),this.ga=Bn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new mn(t&&t.concurrentRequestLimit),this.ja=new Dn,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function zn(t){var e,n;Hn(t),3==t.u&&(e=t.H++,tn(n=Xe(t.v),"SID",t.B),tn(n,"RID",e),tn(n,"TYPE","terminate"),Xn(t,n),(e=new Oe(t,e,void 0)).B=2,e.f=en(Xe(n)),n=!1,R.navigator&&R.navigator.sendBeacon&&(n=R.navigator.sendBeacon(e.f.toString(),"")),!n&&R.Image&&((new Image).src=e.f,n=!0),n||(e.a=oi(e.g,null),e.a.$(e.f)),e.s=j(),Ce(e)),ii(t)}function Hn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(R.clearTimeout(t.i),t.i=null),Zn(t),t.b.cancel(),t.g&&("number"==typeof t.g&&R.clearTimeout(t.g),t.g=null)}function Wn(t,e){t.f.push(new gn(t.Fa++,e)),3==t.u&&Qn(t)}function Qn(t){bn(t.b)||t.g||(t.g=!0,Jt(t.xa,t),t.o=0)}function Yn(t,e){var n=e?e.W:t.H++,i=Xe(t.v);tn(i,"SID",t.B),tn(i,"RID",n),tn(i,"AID",t.G),Xn(t,i),t.h&&t.j&&Fn(i,t.h,t.j),n=new Oe(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Kn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),Tn(t.b,n),Ue(n,i,e)}function Xn(t,n){t.c&&Ge({},function(t,e){tn(n,e,t)})}function Kn(t,e,n){n=Math.min(t.f.length,n);var i=t.c?q(t.c.Ha,t.c,t):null;t:for(var r=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=r[a].b,c=r[a].a;if((h-=o)<0)o=Math.max(0,r[a].b-100),u=!1;else try{!function(t,i,e){var r=e||"";try{Ge(t,function(t,e){var n=t;L(t)&&(n=Wt(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){i&&i(c)}}if(u){i=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,i}function $n(t){t.a||t.i||(t.J=1,Jt(t.wa,t),t.m=0)}function Jn(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=we(q(t.wa,t),ei(t,t.m)),t.m++,1)}function Zn(t){null!=t.l&&(R.clearTimeout(t.l),t.l=null)}function ti(t,e){var n,i=null;if(t.a==e){Zn(t),t.a=null;var r=2}else{if(!In(t.b,e))return;i=e.i,An(t.b,e),r=1}if(t.A=e.H,0!=t.u)if(e.b){1==r?(i=e.j?e.j.length:0,e=j()-e.s,n=t.o,(r=pe()).dispatchEvent(new me(r)),Qn(t)):$n(t)}else if(3==(n=e.c)||0==n&&0<t.A||!(1==r&&function(t,e){if(!(En(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=we(q(t.xa,t,e),ei(t,t.o)),t.o++,1}}(t,e)||2==r&&Jn(t)))switch(i&&0<i.length&&(e=t.b,e.c=e.c.concat(i)),n){case 1:ni(t,5);break;case 4:ni(t,10);break;case 3:ni(t,6);break;default:ni(t,2)}}function ei(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function ni(t,e){var n,i,r,o,s,u;2==e?(n=null,t.c&&(n=null),i=q(t.Ta,t),n||(n=new Ye("//www.google.com/images/cleardot.gif"),R.location&&"http"==R.location.protocol||Ke(n,"https"),en(n)),r=n.toString(),o=i,u=new fe,R.Image?((s=new Image).onload=x(Sn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=x(Sn,u,s,"TestLoadImage: error",!1,o),s.onabort=x(Sn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=x(Sn,u,s,"TestLoadImage: timeout",!1,o),R.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=r):o(!1)):ge(2),t.u=0,t.c&&t.c.la(e),ii(t),Hn(t)}function ii(t){t.u=0,t.A=-1,t.c&&(0==Nn(t.b).length&&0==t.f.length||(t.b.c.length=0,W(t.f),t.f.length=0),t.c.ka())}function ri(t,e,n){var i,r,o,s,u,a,h,c=(i=n)instanceof Ye?Xe(i):new Ye(i,void 0);return""!=c.c?(e&&$e(c,e+"."+c.c),Je(c,c.h)):(r=R.location,o=r.protocol,s=e?e+"."+r.hostname:r.hostname,u=+r.port,a=n,h=new Ye(null,void 0),o&&Ke(h,o),s&&$e(h,s),u&&Je(h,u),a&&(h.g=a),c=h),t.N&&tt(t.N,function(t,e){tn(c,e,t)}),e=t.s,n=t.ha,e&&n&&tn(c,e,n),tn(c,"VER",t.oa),Xn(t,c),c}function oi(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.Ea)).F=t.w,e}function si(){}function ui(){if(at&&!(10<=Number(wt)))throw Error("Environmental error: no available transport.")}function ai(t,e){zt.call(this),this.a=new Gn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!Q(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Q(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new fi(this)}function hi(t){De.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function ci(){Se.call(this),this.status=1}function fi(t){this.a=t}(_=On.prototype).$=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Te(this.G):Te(Ne),this.a.onreadystatechange=q(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Vn(this,t)}t=n||"";var r,o=new ze(this.headers);i&&Ge(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=Un,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=R.FormData&&t instanceof R.FormData,0<=G(Ln,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{xn(this),0<this.o&&((this.B=(r=this.a,at&&mt(9)&&"number"==typeof r.timeout&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=q(this.ta,this)):this.m=re(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},_.ta=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},_.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),qn(this))},_.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),qn(this,!0)),On.M.C.call(this)},_.va=function(){this.j||(this.w||this.l||this.g?Cn(this):this.Oa())},_.Oa=function(){Cn(this)},_.S=function(){try{return 2<jn(this)?this.a.status:-1}catch(t){return-1}},_.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},_.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Rn(e)}},_.qa=function(){return this.h},_.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(_=Gn.prototype).oa=8,_.u=1,_.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new Oe(this,t,void 0),i=this.j;if(this.F&&(i?it(i=et(i),this.F):i=this.F),null===this.h&&(n.m=i),this.fa)t:{for(var r=e=0;r<this.f.length;r++){var o=this.f[r];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.f.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=Kn(this,n,e),tn(r=Xe(this.v),"RID",t),tn(r,"CVER",22),this.s&&tn(r,"X-HTTP-Session-Id",this.s),Xn(this,r),this.h&&i&&Fn(r,this.h,i),Tn(this.b,n),this.fa?(tn(r,"$req",e),tn(r,"SID","null"),n.R=!0,Ue(n,r,null)):Ue(n,r,e),this.u=2}}else 3==this.u&&(t?Yn(this,t):0==this.f.length||bn(this.b)||Yn(this))},_.wa=function(){this.i=null,this.a=new Oe(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Xe(this.ea);tn(t,"RID","rpc"),tn(t,"SID",this.B),tn(t,"CI",this.U?"0":"1"),tn(t,"AID",this.G),Xn(this,t),tn(t,"TYPE","xmlhttp"),this.h&&this.j&&Fn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=en(Xe(t)),e.j=null,e.F=!0,Ve(e,n)},_.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,Jn(this),ge(19))},_.Ta=function(t){ge(t?2:1)},(_=si.prototype).na=function(){},_.ma=function(){},_.la=function(){},_.ka=function(){},_.Ha=function(){},ui.prototype.a=function(t,e){return new ai(t,e)},F(ai,zt),(_=ai.prototype).addEventListener=function(t,e,n,i){ai.M.addEventListener.call(this,t,e,n,i)},_.removeEventListener=function(t,e,n,i){ai.M.removeEventListener.call(this,t,e,n,i)},_.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(0),t.P=e,t.N=n||{},t.U=t.W,t.v=ri(t,null,t.P),Qn(t)},_.close=function(){zn(this.a)},_.La=function(t){var e;"string"==typeof t?((e={}).__data__=t,Wn(this.a,e)):this.g?((e={}).__data__=Wt(t),Wn(this.a,e)):Wn(this.a,t)},_.C=function(){this.a.c=null,delete this.f,zn(this.a),delete this.a,ai.M.C.call(this)},F(hi,De),F(ci,Se),F(fi,si),fi.prototype.na=function(){this.a.dispatchEvent("a")},fi.prototype.ma=function(t){this.a.dispatchEvent(new hi(t))},fi.prototype.la=function(t){this.a.dispatchEvent(new ci)},fi.prototype.ka=function(){this.a.dispatchEvent("b")},ui.prototype.createWebChannel=ui.prototype.a,ai.prototype.send=ai.prototype.La,ai.prototype.open=ai.prototype.Ka,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ae.EventType=_e).OPEN="a",_e.CLOSE="b",_e.ERROR="c",_e.MESSAGE="d",zt.prototype.listen=zt.prototype.ra,On.prototype.listenOnce=On.prototype.sa,On.prototype.getLastError=On.prototype.Ma,On.prototype.getLastErrorCode=On.prototype.qa,On.prototype.getStatus=On.prototype.S,On.prototype.getResponseJson=On.prototype.Ja,On.prototype.getResponseText=On.prototype.Y,On.prototype.send=On.prototype.$;var li={createWebChannelTransport:function(){return new ui},ErrorCode:be,EventType:Ee,WebChannel:Ae,XhrIo:On},pi=li.createWebChannelTransport,di=li.ErrorCode,yi=li.EventType,vi=li.WebChannel,gi=li.XhrIo,mi=lf.SDK_VERSION,wi=(bi.prototype.t=function(){return null!=this.uid},bi.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},bi.prototype.isEqual=function(t){return t.uid===this.uid},bi);function bi(t){this.uid=t}wi.UNAUTHENTICATED=new wi(null),wi.i=new wi("google-credentials-uid"),wi.h=new wi("first-party-uid");function Ei(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}var Ii,Ti,Ai={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ni=(n(Bi,Ti=Error),Bi),_i=(Fi.prototype.getToken=function(){return Promise.resolve(null)},Fi.prototype.l=function(){},Fi.prototype._=function(t){(this.u=t)(wi.UNAUTHENTICATED)},Fi.prototype.T=function(){this.u=null},Fi),Di=(ji.prototype.getToken=function(){var e=this,n=this.m,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.m!==n?(qs("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Bs("string"==typeof t.accessToken),new Ei(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},ji.prototype.l=function(){this.forceRefresh=!0},ji.prototype._=function(t){this.u=t,this.R&&t(this.currentUser)},ji.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.I),this.I=null,this.u=null},ji.prototype.A=function(){var t=this.auth&&this.auth.getUid();return Bs(null===t||"string"==typeof t),new wi(t)},ji),Si=(Object.defineProperty(xi.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.p([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),xi),Ri=(qi.prototype.getToken=function(){return Promise.resolve(new Si(this.P,this.V))},qi.prototype._=function(t){t(wi.h)},qi.prototype.T=function(){},qi.prototype.l=function(){},qi),Oi=(Ci.now=function(){return Ci.fromMillis(Date.now())},Ci.fromDate=function(t){return Ci.fromMillis(t.getTime())},Ci.fromMillis=function(t){var e=Math.floor(t/1e3);return new Ci(e,1e6*(t-1e3*e))},Ci.prototype.toDate=function(){return new Date(this.toMillis())},Ci.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Ci.prototype.g=function(t){return this.seconds===t.seconds?Hs(this.nanoseconds,t.nanoseconds):Hs(this.seconds,t.seconds)},Ci.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Ci.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Ci.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Ci),ki=(Mi.v=function(t){return new Mi(t)},Mi.min=function(){return new Mi(new Oi(0,0))},Mi.prototype.S=function(t){return this.timestamp.g(t.timestamp)},Mi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Mi.prototype.C=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Mi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Mi.prototype.D=function(){return this.timestamp},Mi),Pi=(Object.defineProperty(Vi.prototype,"length",{get:function(){return this.F},enumerable:!0,configurable:!0}),Vi.prototype.isEqual=function(t){return 0===Vi.N(this,t)},Vi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Vi?t.forEach(function(t){e.push(t)}):e.push(t),this.$(e)},Vi.prototype.limit=function(){return this.offset+this.length},Vi.prototype.L=function(t){return t=void 0===t?1:t,this.$(this.segments,this.offset+t,this.length-t)},Vi.prototype.O=function(){return this.$(this.segments,this.offset,this.length-1)},Vi.prototype.k=function(){return this.segments[this.offset]},Vi.prototype.q=function(){return this.get(this.length-1)},Vi.prototype.get=function(t){return this.segments[this.offset+t]},Vi.prototype.M=function(){return 0===this.length},Vi.prototype.B=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Vi.prototype.U=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Vi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Vi.prototype.W=function(){return this.segments.slice(this.offset,this.limit())},Vi.N=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Vi),Li=(n(Ui,Ii=Pi),Ui.prototype.$=function(t,e,n){return new Ui(t,e,n)},Ui.prototype.j=function(){return this.W().join("/")},Ui.prototype.toString=function(){return this.j()},Ui.G=function(t){if(0<=t.indexOf("//"))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new Ui(t.split("/").filter(function(t){return 0<t.length}))},Ui);function Ui(){return null!==Ii&&Ii.apply(this,arguments)||this}function Vi(t,e,n){void 0===e?e=0:e>t.length&&Fs(),void 0===n?n=t.length-e:n>t.length-e&&Fs(),this.segments=t,this.offset=e,this.F=n}function Mi(t){this.timestamp=t}function Ci(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Ni(Ai.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Ni(Ai.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ni(Ai.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Ni(Ai.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function qi(t,e){this.P=t,this.V=e}function xi(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=wi.h}function ji(t){var e=this;this.I=null,this.currentUser=wi.UNAUTHENTICATED,this.R=!1,this.m=0,this.u=null,this.forceRefresh=!1,this.I=function(){e.m++,e.currentUser=e.A(),e.R=!0,e.u&&e.u(e.currentUser)},this.m=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.I):(this.I(null),t.get().then(function(t){e.auth=t,e.I&&e.auth.addAuthTokenListener(e.I)},function(){}))}function Fi(){this.u=null}function Bi(t,e){var n=this;return(n=Ti.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Li.H=new Li([]);var Gi,zi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Hi=(n(Wi,Gi=Pi),Wi.prototype.$=function(t,e,n){return new Wi(t,e,n)},Wi.K=function(t){return zi.test(t)},Wi.prototype.j=function(){return this.W().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Wi.K(t)||(t="`"+t+"`"),t}).join(".")},Wi.prototype.toString=function(){return this.j()},Wi.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},Wi.X=function(){return new Wi(["__name__"])},Wi.J=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Ni(Ai.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ni(Ai.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new Ni(Ai.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Wi(e)},Wi);function Wi(){return null!==Gi&&Gi.apply(this,arguments)||this}Hi.H=new Hi([]);var Qi=(Yi.Z=function(t){return new Yi(Li.G(t).L(5))},Yi.prototype.tt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Yi.prototype.isEqual=function(t){return null!==t&&0===Li.N(this.path,t.path)},Yi.prototype.toString=function(){return this.path.toString()},Yi.N=function(t,e){return Li.N(t.path,e.path)},Yi.et=function(t){return t.length%2==0},Yi.st=function(t){return new Yi(new Li(t.slice()))},Yi);function Yi(t){this.path=t}function Xi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ki(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function $i(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}Qi.EMPTY=new Qi(new Li([]));var Ji=(Zi.fromBase64String=function(t){return new Zi(Us.nt().atob(t))},Zi.fromUint8Array=function(t){return new Zi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Zi.prototype.toBase64=function(){return Us.nt().btoa(this.it)},Zi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.it)},Zi.prototype.rt=function(){return 2*this.it.length},Zi.prototype.S=function(t){return Hs(this.it,t.it)},Zi.prototype.isEqual=function(t){return this.it===t.it},Zi);function Zi(t){this.it=t}function tr(t){return null==t}function er(t){return-0===t&&1/t==-1/0}function nr(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ir(t){var e=fr(t.mapValue.fields.__local_write_time__.timestampValue);return new Oi(e.seconds,e.nanos)}Ji.ht=new Ji("");var rr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function or(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?nr(t)?4:10:Fs()}function sr(i,r){var t,e,n,o=or(i);if(o!==or(r))return!1;switch(o){case 0:return!0;case 1:return i.booleanValue===r.booleanValue;case 4:return ir(i).isEqual(ir(r));case 3:return function(t){if("string"==typeof i.timestampValue&&"string"==typeof t.timestampValue&&i.timestampValue.length===t.timestampValue.length)return i.timestampValue===t.timestampValue;var e=fr(i.timestampValue),n=fr(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(r);case 5:return i.stringValue===r.stringValue;case 6:return n=r,pr(i.bytesValue).isEqual(pr(n.bytesValue));case 7:return i.referenceValue===r.referenceValue;case 8:return e=r,lr((t=i).geoPointValue.latitude)===lr(e.geoPointValue.latitude)&&lr(t.geoPointValue.longitude)===lr(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return lr(t.integerValue)===lr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=lr(t.doubleValue),i=lr(e.doubleValue);return n===i?er(n)===er(i):isNaN(n)&&isNaN(i)}return!1}(i,r);case 9:return Ws(i.arrayValue.values||[],r.arrayValue.values||[],sr);case 10:return function(){var t=i.mapValue.fields||{},e=r.mapValue.fields||{};if(Xi(t)!==Xi(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!sr(t[n],e[n])))return!1;return!0}();default:return Fs()}}function ur(t,e){return void 0!==(t.values||[]).find(function(t){return sr(t,e)})}function ar(t,e){var n,i,r,o,s,u,a,h,c,f,l=or(t),p=or(e);if(l!==p)return Hs(l,p);switch(l){case 0:return 0;case 1:return Hs(t.booleanValue,e.booleanValue);case 2:return h=e,c=lr(t.integerValue||t.doubleValue),f=lr(h.integerValue||h.doubleValue),c<f?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return hr(t.timestampValue,e.timestampValue);case 4:return hr(ir(t),ir(e));case 5:return Hs(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=pr(o),a=pr(s),u.S(a);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=Hs(n[r],i[r]);if(0!==o)return o}return Hs(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=Hs(lr(n.latitude),lr(i.latitude)))?r:Hs(lr(n.longitude),lr(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=ar(n[r],i[r]);if(o)return o}return Hs(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var u=Hs(i[s],o[s]);if(0!==u)return u;var a=ar(n[i[s]],r[o[s]]);if(0!==a)return a}return Hs(i.length,o.length)}(t.mapValue,e.mapValue);default:throw Fs()}}function hr(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Hs(t,e);var n=fr(t),i=fr(e),r=Hs(n.seconds,i.seconds);return 0!==r?r:Hs(n.nanos,i.nanos)}function cr(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=fr(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?pr(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,Qi.Z(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++){e?e=!1:t+=",",t+=s(i[n])}return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):Fs();var t,e,n}(t)}function fr(t){if(Bs(!!t),"string"!=typeof t)return{seconds:lr(t.seconds),nanos:lr(t.nanos)};var e,n=0,i=rr.exec(t);Bs(!!i),i[1]&&(e=((e=i[1])+"000000000").substr(0,9),n=Number(e));var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:n}}function lr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function pr(t){return"string"==typeof t?Ji.fromBase64String(t):Ji.fromUint8Array(t)}function dr(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.j()}}function yr(t){return t&&"integerValue"in t}function vr(t){return!!t&&"arrayValue"in t}function gr(t){return t&&"nullValue"in t}function mr(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function wr(t){return t&&"mapValue"in t}var br=(Er.prototype.ot=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},Er.prototype.at=function(t,e){return e},Er.prototype.ut=function(t){return null},Er.prototype.isEqual=function(t){return t instanceof Er},Er);function Er(){}br.instance=new br;var Ir=(Dr.prototype.ot=function(t,e){return this.apply(t)},Dr.prototype.at=function(t,e){return this.apply(t)},Dr.prototype.apply=function(t){for(var n=Sr(t),e=0,i=this.elements;e<i.length;e++)!function(e){n.some(function(t){return sr(t,e)})||n.push(e)}(i[e]);return{arrayValue:{values:n}}},Dr.prototype.ut=function(t){return null},Dr.prototype.isEqual=function(t){return t instanceof Dr&&Ws(this.elements,t.elements,sr)},Dr),Tr=(_r.prototype.ot=function(t,e){return this.apply(t)},_r.prototype.at=function(t,e){return this.apply(t)},_r.prototype.apply=function(t){for(var n=Sr(t),e=0,i=this.elements;e<i.length;e++)!function(e){n=n.filter(function(t){return!sr(t,e)})}(i[e]);return{arrayValue:{values:n}}},_r.prototype.ut=function(t){return null},_r.prototype.isEqual=function(t){return t instanceof _r&&Ws(this.elements,t.elements,sr)},_r),Ar=(Nr.prototype.ot=function(t,e){var n=this.ut(t),i=this.asNumber(n)+this.asNumber(this.ct);return yr(n)&&yr(this.ct)?this.serializer.lt(i):this.serializer._t(i)},Nr.prototype.at=function(t,e){return e},Nr.prototype.ut=function(t){return yr(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},Nr.prototype.isEqual=function(t){return t instanceof Nr&&sr(this.ct,t.ct)},Nr.prototype.asNumber=function(t){return lr(t.integerValue||t.doubleValue)},Nr);function Nr(t,e){this.serializer=t,this.ct=e}function _r(t){this.elements=t}function Dr(t){this.elements=t}function Sr(t){return vr(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Rr(t,e){this.version=t,this.transformResults=e}var Or,kr,Pr,Lr,Ur,Vr=(no.prototype.ft=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].B(t))return!0;return!1},no.prototype.isEqual=function(t){return Ws(this.fields,t.fields,function(t,e){return t.isEqual(e)})},no),Mr=(eo.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},eo),Cr=(to.dt=function(){return new to},to.exists=function(t){return new to(void 0,t)},to.updateTime=function(t){return new to(t)},Object.defineProperty(to.prototype,"wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),to.prototype.Tt=function(t){return void 0!==this.updateTime?t instanceof go&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof go},to.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},to),qr=(Zr.prototype.Et=function(t){},Zr.It=function(t){return t instanceof go?t.version:ki.min()},Zr),xr=(n(Jr,Ur=qr),Jr.prototype.at=function(t,e){this.Et(t);var n=e.version;return new go(this.key,n,this.value,{hasCommittedMutations:!0})},Jr.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.Tt(t))return t;var i=qr.It(t);return new go(this.key,i,this.value,{At:!0})},Jr.prototype.Pt=function(t){return null},Jr.prototype.isEqual=function(t){return t instanceof Jr&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Rt.isEqual(t.Rt)},Jr),jr=(n($r,Lr=qr),$r.prototype.at=function(t,e){if(this.Et(t),!this.Rt.Tt(t))return new wo(this.key,e.version);var n=this.pt(t);return new go(this.key,e.version,n,{hasCommittedMutations:!0})},$r.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.Tt(t))return t;var i=qr.It(t),r=this.pt(t);return new go(this.key,i,r,{At:!0})},$r.prototype.Pt=function(t){return null},$r.prototype.isEqual=function(t){return t instanceof $r&&this.key.isEqual(t.key)&&this.Vt.isEqual(t.Vt)&&this.Rt.isEqual(t.Rt)},$r.prototype.pt=function(t){var e=t instanceof go?t.data():zr.empty();return this.yt(e)},$r.prototype.yt=function(t){var n=this,i=new Hr(t);return this.Vt.fields.forEach(function(t){var e;t.M()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.gt()},$r),Fr=(n(Kr,Pr=qr),Kr.prototype.at=function(t,e){if(this.Et(t),Bs(null!=e.transformResults),!this.Rt.Tt(t))return new wo(this.key,e.version);var n=this.bt(t),i=this.vt(t,e.transformResults),r=e.version,o=this.St(n.data(),i);return new go(this.key,r,o,{hasCommittedMutations:!0})},Kr.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.Tt(t))return t;var i=this.bt(t),r=this.Ct(n,t,e),o=this.St(i.data(),r);return new go(this.key,i.version,o,{At:!0})},Kr.prototype.Pt=function(t){for(var e=null,n=0,i=this.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof go?t.field(r.field):void 0,s=r.transform.ut(o||null);null!=s&&(e=null==e?(new Hr).set(r.field,s):e.set(r.field,s))}return e?e.gt():null},Kr.prototype.isEqual=function(t){return t instanceof Kr&&this.key.isEqual(t.key)&&Ws(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Rt.isEqual(t.Rt)},Kr.prototype.bt=function(t){return t},Kr.prototype.vt=function(t,e){var n=[];Bs(this.fieldTransforms.length===e.length);for(var i=0;i<e.length;i++){var r=this.fieldTransforms[i],o=r.transform,s=null;t instanceof go&&(s=t.field(r.field)),n.push(o.at(s,e[i]))}return n},Kr.prototype.Ct=function(t,e,n){for(var i=[],r=0,o=this.fieldTransforms;r<o.length;r++){var s=o[r],u=s.transform,a=null;e instanceof go&&(a=e.field(s.field)),null===a&&n instanceof go&&(a=n.field(s.field)),i.push(u.ot(a,t))}return i},Kr.prototype.St=function(t,e){for(var n=new Hr(t),i=0;i<this.fieldTransforms.length;i++){var r=this.fieldTransforms[i].field;n.set(r,e[i])}return n.gt()},Kr),Br=(n(Xr,kr=qr),Xr.prototype.at=function(t,e){return this.Et(t),new mo(this.key,e.version,{hasCommittedMutations:!0})},Xr.prototype.ot=function(t,e,n){return this.Et(t),this.Rt.Tt(t)?new mo(this.key,ki.min()):t},Xr.prototype.Pt=function(t){return null},Xr.prototype.isEqual=function(t){return t instanceof Xr&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Xr),Gr=(n(Yr,Or=qr),Yr.prototype.at=function(t,e){Fs()},Yr.prototype.ot=function(t,e,n){Fs()},Yr.prototype.Pt=function(t){Fs()},Yr.prototype.isEqual=function(t){return t instanceof Yr&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Yr),zr=(Qr.empty=function(){return new Qr({mapValue:{}})},Qr.prototype.field=function(t){if(t.M())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!wr(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.q()])||null},Qr.prototype.isEqual=function(t){return sr(this.proto,t.proto)},Qr),Hr=(Wr.prototype.set=function(t,e){return this.Nt(t,e),this},Wr.prototype.delete=function(t){return this.Nt(t,null),this},Wr.prototype.Nt=function(t,e){for(var n=this.Ft,i=0;i<t.length-1;++i)var r=t.get(i),o=n.get(r),n=(o instanceof Map||(o=o&&10===or(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),o);n.set(t.q(),e)},Wr.prototype.gt=function(){var t=this.$t(Hi.H,this.Ft);return null!=t?new zr(t):this.Dt},Wr.prototype.$t=function(i,t){var r=this,o=!1,e=this.Dt.field(i),s=wr(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=r.$t(i.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Wr);function Wr(t){void 0===t&&(t=zr.empty()),this.Dt=t,this.Ft=new Map}function Qr(t){this.proto=t}function Yr(t,e){var n=this;return(n=Or.call(this)||this).key=t,n.Rt=e,n.type=4,n}function Xr(t,e){var n=this;return(n=kr.call(this)||this).key=t,n.Rt=e,n.type=3,n}function Kr(t,e){var n=this;return(n=Pr.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Rt=Cr.exists(!0),n}function $r(t,e,n,i){var r=this;return(r=Lr.call(this)||this).key=t,r.data=e,r.Vt=n,r.Rt=i,r.type=1,r}function Jr(t,e,n){var i=this;return(i=Ur.call(this)||this).key=t,i.value=e,i.Rt=n,i.type=0,i}function Zr(){}function to(t,e){this.updateTime=t,this.exists=e}function eo(t,e){this.field=t,this.transform=e}function no(t){(this.fields=t).sort(Hi.N)}function io(t,e){this.key=t,this.version=e}function ro(t){this.count=t}var oo,so,uo,ao,ho,co,fo,lo,po,yo,vo,go=(n(zo,vo=io),zo.prototype.field=function(t){return this.Lt.field(t)},zo.prototype.data=function(){return this.Lt},zo.prototype.Ot=function(){return this.Lt.proto},zo.prototype.isEqual=function(t){return t instanceof zo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.At===t.At&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Lt.isEqual(t.Lt)},zo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Lt.toString()+", {hasLocalMutations: "+this.At+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(zo.prototype,"hasPendingWrites",{get:function(){return this.At||this.hasCommittedMutations},enumerable:!0,configurable:!0}),zo),mo=(n(Go,yo=io),Go.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Go.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),Go.prototype.isEqual=function(t){return t instanceof Go&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Go),wo=(n(Bo,po=io),Bo.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Bo.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),Bo.prototype.isEqual=function(t){return t instanceof Bo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Bo),bo=(Fo.prototype.canonicalId=function(){var t;return null===this.kt&&(t=this.path.j(),null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),tr(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.kt=t),this.kt},Fo.prototype.toString=function(){var t=this.path.j();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),tr(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},Fo.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},Fo.prototype.qt=function(){return Qi.et(this.path)&&null===this.collectionGroup&&0===this.filters.length},Fo),Eo=(jo.Wt=function(t){return new jo(t)},Object.defineProperty(jo.prototype,"orderBy",{get:function(){if(null===this.Bt){this.Bt=[];var t=this.jt(),e=this.Gt();if(null!==t&&null===e)t.Y()||this.Bt.push(new Ro(t)),this.Bt.push(new Ro(Hi.X(),"asc"));else{for(var n,i=!1,r=0,o=this.Mt;r<o.length;r++){var s=o[r];this.Bt.push(s),s.field.Y()&&(i=!0)}i||(n=0<this.Mt.length?this.Mt[this.Mt.length-1].dir:"asc",this.Bt.push(new Ro(Hi.X(),n)))}}return this.Bt},enumerable:!0,configurable:!0}),jo.prototype.Ht=function(t){var e=this.filters.concat([t]);return new jo(this.path,this.collectionGroup,this.Mt.slice(),e,this.limit,this.xt,this.startAt,this.endAt)},jo.prototype.Kt=function(t){var e=this.Mt.concat([t]);return new jo(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.xt,this.startAt,this.endAt)},jo.prototype.zt=function(t){return new jo(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},jo.prototype.Yt=function(t){return new jo(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},jo.prototype.Xt=function(t){return new jo(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),this.limit,this.xt,t,this.endAt)},jo.prototype.Jt=function(t){return new jo(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),this.limit,this.xt,this.startAt,t)},jo.prototype.Zt=function(t){return new jo(t,null,this.Mt.slice(),this.filters.slice(),this.limit,this.xt,this.startAt,this.endAt)},jo.prototype.te=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Mt.length||1===this.Mt.length&&this.Mt[0].field.Y())},jo.prototype.canonicalId=function(){return this.ee().canonicalId()+"|lt:"+this.xt},jo.prototype.toString=function(){return"Query(target="+this.ee().toString()+"; limitType="+this.xt+")"},jo.prototype.isEqual=function(t){return this.ee().isEqual(t.ee())&&this.xt===t.xt},jo.prototype.se=function(t,e){for(var n=!1,i=0,r=this.orderBy;i<r.length;i++){var o=r[i],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},jo.prototype.matches=function(t){return this.ie(t)&&this.ne(t)&&this.re(t)&&this.he(t)},jo.prototype.oe=function(){return!tr(this.limit)&&"F"===this.xt},jo.prototype.ae=function(){return!tr(this.limit)&&"L"===this.xt},jo.prototype.Gt=function(){return 0<this.Mt.length?this.Mt[0].field:null},jo.prototype.jt=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Io&&n.ue())return n.field}return null},jo.prototype.ce=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(i instanceof Io&&0<=t.indexOf(i.op))return i.op}return null},jo.prototype.qt=function(){return this.ee().qt()},jo.prototype.le=function(){return null!==this.collectionGroup},jo.prototype.ee=function(){if(!this.Ut)if("F"===this.xt)this.Ut=new bo(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var i=n[e],r="desc"===i.dir?"asc":"desc";t.push(new Ro(i.field,r))}var o=this.endAt?new So(this.endAt.position,!this.endAt.before):null,s=this.startAt?new So(this.startAt.position,!this.startAt.before):null;this.Ut=new bo(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Ut},jo.prototype.ie=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.tt(this.collectionGroup)&&this.path.B(e):Qi.et(this.path)?this.path.isEqual(e):this.path.U(e)},jo.prototype.ne=function(t){for(var e=0,n=this.Mt;e<n.length;e++){var i=n[e];if(!i.field.Y()&&null===t.field(i.field))return!1}return!0},jo.prototype.re=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},jo.prototype.he=function(t){return!(this.startAt&&!this.startAt._e(this.orderBy,t)||this.endAt&&this.endAt._e(this.orderBy,t))},jo.prototype.Qt=function(t){},jo),Io=(n(xo,lo=function(){}),xo.create=function(t,e,n){if(t.Y())return"in"===e?new Ao(t,n):new To(t,e,n);if(gr(n)){if("=="!==e)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new xo(t,e,n)}if(mr(n)){if("=="!==e)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new xo(t,e,n)}return"array-contains"===e?new No(t,n):"in"===e?new _o(t,n):"array-contains-any"===e?new Do(t,n):new xo(t,e,n)},xo.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&or(this.value)===or(e)&&this.fe(ar(e,this.value))},xo.prototype.fe=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Fs()}},xo.prototype.ue=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},xo.prototype.canonicalId=function(){return this.field.j()+this.op.toString()+cr(this.value)},xo.prototype.isEqual=function(t){return t instanceof xo&&this.op===t.op&&this.field.isEqual(t.field)&&sr(this.value,t.value)},xo.prototype.toString=function(){return this.field.j()+" "+this.op+" "+cr(this.value)},xo),To=(n(qo,fo=Io),qo.prototype.matches=function(t){var e=Qi.N(t.key,this.key);return this.fe(e)},qo),Ao=(n(Co,co=Io),Co.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Co),No=(n(Mo,ho=Io),Mo.prototype.matches=function(t){var e=t.field(this.field);return vr(e)&&ur(e.arrayValue,this.value)},Mo),_o=(n(Vo,ao=Io),Vo.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ur(this.value.arrayValue,e)},Vo),Do=(n(Uo,uo=Io),Uo.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!vr(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return ur(e.value.arrayValue,t)})},Uo),So=(Lo.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(cr).join(",")},Lo.prototype._e=function(t,e){for(var n=0,i=0;i<this.position.length;i++){var r=t[i],o=this.position[i],n=r.field.Y()?Qi.N(Qi.Z(o.referenceValue),e.key):ar(o,e.field(r.field));if("desc"===r.dir&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},Lo.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!sr(this.position[e],t.position[e]))return!1;return!0},Lo),Ro=(Po.prototype.compare=function(t,e){var n,i,r,o,s=this.de?Qi.N(t.key,e.key):(n=this.field,i=e,r=t.field(n),o=i.field(n),null!==r&&null!==o?ar(r,o):Fs());switch(this.dir){case"asc":return s;case"desc":return-1*s;default:return Fs()}},Po.prototype.canonicalId=function(){return this.field.j()+this.dir.toString()},Po.prototype.toString=function(){return this.field.j()+" ("+this.dir+")"},Po.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},Po),Oo=(ko.prototype.Ee=function(t){return new ko(this.target,this.targetId,this.we,t,this.Te,this.lastLimboFreeSnapshotVersion,this.resumeToken)},ko.prototype.Ie=function(t,e){return new ko(this.target,this.targetId,this.we,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},ko.prototype.Re=function(t){return new ko(this.target,this.targetId,this.we,this.sequenceNumber,this.Te,t,this.resumeToken)},ko);function ko(t,e,n,i,r,o,s){void 0===r&&(r=ki.min()),void 0===o&&(o=ki.min()),void 0===s&&(s=Ji.ht),this.target=t,this.targetId=e,this.we=n,this.sequenceNumber=i,this.Te=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Po(t,e){this.field=t,void 0===e&&(e="asc"),this.dir=e,this.de=t.Y()}function Lo(t,e){this.position=t,this.before=e}function Uo(t,e){return uo.call(this,t,"array-contains-any",e)||this}function Vo(t,e){return ao.call(this,t,"in",e)||this}function Mo(t,e){return ho.call(this,t,"array-contains",e)||this}function Co(t,e){var n=this;return(n=co.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return Qi.Z(t.referenceValue)}),n}function qo(t,e,n){var i=this;return(i=fo.call(this,t,e,n)||this).key=Qi.Z(n.referenceValue),i}function xo(t,e,n){var i=this;return(i=lo.call(this)||this).field=t,i.op=e,i.value=n,i}function jo(t,e,n,i,r,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Mt=n,this.filters=i,this.limit=r,this.xt=o,this.startAt=s,this.endAt=u,this.Bt=null,this.Ut=null,this.startAt&&this.Qt(this.startAt),this.endAt&&this.Qt(this.endAt)}function Fo(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.kt=null}function Bo(){return null!==po&&po.apply(this,arguments)||this}function Go(t,e,n){var i=this;return(i=yo.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function zo(t,e,n,i){var r=this;return(r=vo.call(this,t,e)||this).Lt=n,r.At=!!i.At,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function Ho(t){switch(t){case Ai.OK:return Fs(),0;case Ai.CANCELLED:case Ai.UNKNOWN:case Ai.DEADLINE_EXCEEDED:case Ai.RESOURCE_EXHAUSTED:case Ai.INTERNAL:case Ai.UNAVAILABLE:case Ai.UNAUTHENTICATED:return;case Ai.INVALID_ARGUMENT:case Ai.NOT_FOUND:case Ai.ALREADY_EXISTS:case Ai.PERMISSION_DENIED:case Ai.FAILED_PRECONDITION:case Ai.ABORTED:case Ai.OUT_OF_RANGE:case Ai.UNIMPLEMENTED:case Ai.DATA_LOSS:return 1;default:return Fs(),0}}function Wo(t){if(void 0===t)return xs("GRPC error has no .code"),Ai.UNKNOWN;switch(t){case oo.OK:return Ai.OK;case oo.CANCELLED:return Ai.CANCELLED;case oo.UNKNOWN:return Ai.UNKNOWN;case oo.DEADLINE_EXCEEDED:return Ai.DEADLINE_EXCEEDED;case oo.RESOURCE_EXHAUSTED:return Ai.RESOURCE_EXHAUSTED;case oo.INTERNAL:return Ai.INTERNAL;case oo.UNAVAILABLE:return Ai.UNAVAILABLE;case oo.UNAUTHENTICATED:return Ai.UNAUTHENTICATED;case oo.INVALID_ARGUMENT:return Ai.INVALID_ARGUMENT;case oo.NOT_FOUND:return Ai.NOT_FOUND;case oo.ALREADY_EXISTS:return Ai.ALREADY_EXISTS;case oo.PERMISSION_DENIED:return Ai.PERMISSION_DENIED;case oo.FAILED_PRECONDITION:return Ai.FAILED_PRECONDITION;case oo.ABORTED:return Ai.ABORTED;case oo.OUT_OF_RANGE:return Ai.OUT_OF_RANGE;case oo.UNIMPLEMENTED:return Ai.UNIMPLEMENTED;case oo.DATA_LOSS:return Ai.DATA_LOSS;default:return Fs()}}(so=oo=oo||{})[so.OK=0]="OK",so[so.CANCELLED=1]="CANCELLED",so[so.UNKNOWN=2]="UNKNOWN",so[so.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",so[so.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",so[so.NOT_FOUND=5]="NOT_FOUND",so[so.ALREADY_EXISTS=6]="ALREADY_EXISTS",so[so.PERMISSION_DENIED=7]="PERMISSION_DENIED",so[so.UNAUTHENTICATED=16]="UNAUTHENTICATED",so[so.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",so[so.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",so[so.ABORTED=10]="ABORTED",so[so.OUT_OF_RANGE=11]="OUT_OF_RANGE",so[so.UNIMPLEMENTED=12]="UNIMPLEMENTED",so[so.INTERNAL=13]="INTERNAL",so[so.UNAVAILABLE=14]="UNAVAILABLE",so[so.DATA_LOSS=15]="DATA_LOSS";var Qo=(Jo.prototype.me=function(t,e){return new Jo(this.N,this.root.me(t,e,this.N).Ae(null,null,Xo.Pe,null,null))},Jo.prototype.remove=function(t){return new Jo(this.N,this.root.remove(t,this.N).Ae(null,null,Xo.Pe,null,null))},Jo.prototype.get=function(t){for(var e=this.root;!e.M();){var n=this.N(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Jo.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.M();){var i=this.N(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},Jo.prototype.M=function(){return this.root.M()},Object.defineProperty(Jo.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),Jo.prototype.Ve=function(){return this.root.Ve()},Jo.prototype.pe=function(){return this.root.pe()},Jo.prototype.ye=function(t){return this.root.ye(t)},Jo.prototype.forEach=function(n){this.ye(function(t,e){return n(t,e),!1})},Jo.prototype.toString=function(){var n=[];return this.ye(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Jo.prototype.ge=function(t){return this.root.ge(t)},Jo.prototype.be=function(){return new Yo(this.root,null,this.N,!1)},Jo.prototype.ve=function(t){return new Yo(this.root,t,this.N,!1)},Jo.prototype.Se=function(){return new Yo(this.root,null,this.N,!0)},Jo.prototype.Ce=function(t){return new Yo(this.root,t,this.N,!0)},Jo),Yo=($o.prototype.Ne=function(){var t=this.Fe.pop(),e={key:t.key,value:t.value};if(this.De)for(t=t.left;!t.M();)this.Fe.push(t),t=t.right;else for(t=t.right;!t.M();)this.Fe.push(t),t=t.left;return e},$o.prototype.$e=function(){return 0<this.Fe.length},$o.prototype.Le=function(){if(0===this.Fe.length)return null;var t=this.Fe[this.Fe.length-1];return{key:t.key,value:t.value}},$o),Xo=(Ko.prototype.Ae=function(t,e,n,i,r){return new Ko(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},Ko.prototype.M=function(){return!1},Ko.prototype.ye=function(t){return this.left.ye(t)||t(this.key,this.value)||this.right.ye(t)},Ko.prototype.ge=function(t){return this.right.ge(t)||t(this.key,this.value)||this.left.ge(t)},Ko.prototype.min=function(){return this.left.M()?this:this.left.min()},Ko.prototype.Ve=function(){return this.min().key},Ko.prototype.pe=function(){return this.right.M()?this.key:this.right.pe()},Ko.prototype.me=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.Ae(null,null,null,i.left.me(t,e,n),null):0===r?i.Ae(null,e,null,null,null):i.Ae(null,null,null,null,i.right.me(t,e,n))).Oe()},Ko.prototype.ke=function(){if(this.left.M())return Ko.EMPTY;var t=this;return t.left.qe()||t.left.left.qe()||(t=t.Me()),(t=t.Ae(null,null,null,t.left.ke(),null)).Oe()},Ko.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left.M()||i.left.qe()||i.left.left.qe()||(i=i.Me()),i=i.Ae(null,null,null,i.left.remove(t,e),null);else{if(i.left.qe()&&(i=i.xe()),i.right.M()||i.right.qe()||i.right.left.qe()||(i=i.Be()),0===e(t,i.key)){if(i.right.M())return Ko.EMPTY;n=i.right.min(),i=i.Ae(n.key,n.value,null,null,i.right.ke())}i=i.Ae(null,null,null,null,i.right.remove(t,e))}return i.Oe()},Ko.prototype.qe=function(){return this.color},Ko.prototype.Oe=function(){var t=this;return t.right.qe()&&!t.left.qe()&&(t=t.Ue()),t.left.qe()&&t.left.left.qe()&&(t=t.xe()),t.left.qe()&&t.right.qe()&&(t=t.Qe()),t},Ko.prototype.Me=function(){var t=this.Qe();return t.right.left.qe()&&(t=(t=(t=t.Ae(null,null,null,null,t.right.xe())).Ue()).Qe()),t},Ko.prototype.Be=function(){var t=this.Qe();return t.left.left.qe()&&(t=(t=t.xe()).Qe()),t},Ko.prototype.Ue=function(){var t=this.Ae(null,null,Ko.RED,null,this.right.left);return this.right.Ae(null,null,this.color,t,null)},Ko.prototype.xe=function(){var t=this.Ae(null,null,Ko.RED,this.left.right,null);return this.left.Ae(null,null,this.color,null,t)},Ko.prototype.Qe=function(){var t=this.left.Ae(null,null,!this.left.color,null,null),e=this.right.Ae(null,null,!this.right.color,null,null);return this.Ae(null,null,!this.color,t,e)},Ko.prototype.We=function(){var t=this.je();return Math.pow(2,t)<=this.size+1},Ko.prototype.je=function(){if(this.qe()&&this.left.qe())throw Fs();if(this.right.qe())throw Fs();var t=this.left.je();if(t!==this.right.je())throw Fs();return t+(this.qe()?0:1)},Ko);function Ko(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:Ko.RED,this.left=null!=i?i:Ko.EMPTY,this.right=null!=r?r:Ko.EMPTY,this.size=this.left.size+1+this.right.size}function $o(t,e,n,i){this.De=i,this.Fe=[];for(var r=1;!t.M();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.De?t.left:t.right;else{if(0===r){this.Fe.push(t);break}this.Fe.push(t),t=this.De?t.right:t.left}}function Jo(t,e){this.N=t,this.root=e||Xo.EMPTY}function Zo(){this.size=0}Xo.EMPTY=null,Xo.RED=!0,Xo.Pe=!1,Xo.EMPTY=(Object.defineProperty(Zo.prototype,"key",{get:function(){throw Fs()},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"value",{get:function(){throw Fs()},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"color",{get:function(){throw Fs()},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"left",{get:function(){throw Fs()},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"right",{get:function(){throw Fs()},enumerable:!0,configurable:!0}),Zo.prototype.Ae=function(t,e,n,i,r){return this},Zo.prototype.me=function(t,e,n){return new Xo(t,e)},Zo.prototype.remove=function(t,e){return this},Zo.prototype.M=function(){return!0},Zo.prototype.ye=function(t){return!1},Zo.prototype.ge=function(t){return!1},Zo.prototype.Ve=function(){return null},Zo.prototype.pe=function(){return null},Zo.prototype.qe=function(){return!1},Zo.prototype.We=function(){return!0},Zo.prototype.je=function(){return 0},new Zo);var ts=(rs.prototype.has=function(t){return null!==this.data.get(t)},rs.prototype.first=function(){return this.data.Ve()},rs.prototype.last=function(){return this.data.pe()},Object.defineProperty(rs.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),rs.prototype.indexOf=function(t){return this.data.indexOf(t)},rs.prototype.forEach=function(n){this.data.ye(function(t,e){return n(t),!1})},rs.prototype.Ge=function(t,e){for(var n=this.data.ve(t[0]);n.$e();){var i=n.Ne();if(0<=this.N(i.key,t[1]))return;e(i.key)}},rs.prototype.He=function(t,e){for(var n=void 0!==e?this.data.ve(e):this.data.be();n.$e();)if(!t(n.Ne().key))return},rs.prototype.Ke=function(t){var e=this.data.ve(t);return e.$e()?e.Ne().key:null},rs.prototype.be=function(){return new es(this.data.be())},rs.prototype.ve=function(t){return new es(this.data.ve(t))},rs.prototype.add=function(t){return this.Ae(this.data.remove(t).me(t,!0))},rs.prototype.delete=function(t){return this.has(t)?this.Ae(this.data.remove(t)):this},rs.prototype.M=function(){return this.data.M()},rs.prototype.ze=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},rs.prototype.isEqual=function(t){if(!(t instanceof rs))return!1;if(this.size!==t.size)return!1;for(var e=this.data.be(),n=t.data.be();e.$e();){var i=e.Ne().key,r=n.Ne().key;if(0!==this.N(i,r))return!1}return!0},rs.prototype.W=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},rs.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},rs.prototype.Ae=function(t){var e=new rs(this.N);return e.data=t,e},rs),es=(is.prototype.Ne=function(){return this.Ye.Ne().key},is.prototype.$e=function(){return this.Ye.$e()},is),ns=new Qo(Qi.N);function is(t){this.Ye=t}function rs(t){this.N=t,this.data=new Qo(this.N)}var os=new Qo(Qi.N);var ss=new Qo(Qi.N),us=new ts(Qi.N);function as(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=us,i=0,r=t;i<r.length;i++)var o=r[i],n=n.add(o);return n}var hs=new ts(Hs);function cs(t,e,n,i){this.Is=t,this.removedTargetIds=e,this.key=n,this.Rs=i}function fs(t,e){this.targetId=t,this.ms=e}function ls(t,e,n,i){void 0===n&&(n=Ji.ht),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var ps=(_s.Ze=function(t){return new _s(t.N)},_s.prototype.has=function(t){return null!=this.Xe.get(t)},_s.prototype.get=function(t){return this.Xe.get(t)},_s.prototype.first=function(){return this.Je.Ve()},_s.prototype.last=function(){return this.Je.pe()},_s.prototype.M=function(){return this.Je.M()},_s.prototype.indexOf=function(t){var e=this.Xe.get(t);return e?this.Je.indexOf(e):-1},Object.defineProperty(_s.prototype,"size",{get:function(){return this.Je.size},enumerable:!0,configurable:!0}),_s.prototype.forEach=function(n){this.Je.ye(function(t,e){return n(t),!1})},_s.prototype.add=function(t){var e=this.delete(t.key);return e.Ae(e.Xe.me(t.key,t),e.Je.me(t,null))},_s.prototype.delete=function(t){var e=this.get(t);return e?this.Ae(this.Xe.remove(t),this.Je.remove(e)):this},_s.prototype.isEqual=function(t){if(!(t instanceof _s))return!1;if(this.size!==t.size)return!1;for(var e=this.Je.be(),n=t.Je.be();e.$e();){var i=e.Ne().key,r=n.Ne().key;if(!i.isEqual(r))return!1}return!0},_s.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},_s.prototype.Ae=function(t,e){var n=new _s;return n.N=this.N,n.Xe=t,n.Je=e,n},_s),ds=(Ns.prototype.track=function(t){var e=t.doc.key,n=this.ts.get(e);!n||0!==t.type&&3===n.type?this.ts=this.ts.me(e,t):3===t.type&&1!==n.type?this.ts=this.ts.me(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ts=this.ts.me(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ts=this.ts.me(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ts=this.ts.remove(e):1===t.type&&2===n.type?this.ts=this.ts.me(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ts=this.ts.me(e,{type:2,doc:t.doc}):Fs()},Ns.prototype.es=function(){var n=[];return this.ts.ye(function(t,e){n.push(e)}),n},Ns),ys=(As.os=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new As(t,e,ps.Ze(e),r,n,i,!0,!1)},Object.defineProperty(As.prototype,"hasPendingWrites",{get:function(){return!this.ns.M()},enumerable:!0,configurable:!0}),As.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.rs===t.rs&&this.ns.isEqual(t.ns)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.ss.isEqual(t.ss)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},As),vs=(Ts._s=function(t,e){var n=new Map;return n.set(t,gs.fs(t,e)),new Ts(ki.min(),n,hs,ns,as())},Ts),gs=(Is.fs=function(t,e){return new Is(Ji.ht,e,as(),as(),as())},Is),ms=(Object.defineProperty(Es.prototype,"ds",{get:function(){return this.ps},enumerable:!0,configurable:!0}),Object.defineProperty(Es.prototype,"resumeToken",{get:function(){return this.Vs},enumerable:!0,configurable:!0}),Object.defineProperty(Es.prototype,"gs",{get:function(){return 0!==this.As},enumerable:!0,configurable:!0}),Object.defineProperty(Es.prototype,"bs",{get:function(){return this.ys},enumerable:!0,configurable:!0}),Es.prototype.vs=function(t){0<t.rt()&&(this.ys=!0,this.Vs=t)},Es.prototype.Ss=function(){var n=as(),i=as(),r=as();return this.Ps.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:Fs()}}),new gs(this.Vs,this.ps,n,i,r)},Es.prototype.Cs=function(){this.ys=!1,this.Ps=Ss()},Es.prototype.Ds=function(t,e){this.ys=!0,this.Ps=this.Ps.me(t,e)},Es.prototype.Fs=function(t){this.ys=!0,this.Ps=this.Ps.remove(t)},Es.prototype.Ns=function(){this.As+=1},Es.prototype.$s=function(){--this.As},Es.prototype.Ls=function(){this.ys=!0,this.ps=!0},Es),ws=(bs.prototype.Bs=function(t){for(var e=0,n=t.Is;e<n.length;e++){var i=n[e];t.Rs instanceof go?this.Us(i,t.Rs):t.Rs instanceof mo&&this.Qs(i,t.key,t.Rs)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.Qs(s,t.key,t.Rs)}},bs.prototype.Ws=function(n){var i=this;this.js(n,function(t){var e=i.Gs(t);switch(n.state){case 0:i.Hs(t)&&e.vs(n.resumeToken);break;case 1:e.$s(),e.gs||e.Cs(),e.vs(n.resumeToken);break;case 2:e.$s(),e.gs||i.removeTarget(t);break;case 3:i.Hs(t)&&(e.Ls(),e.vs(n.resumeToken));break;case 4:i.Hs(t)&&(i.Ks(t),e.vs(n.resumeToken));break;default:Fs()}})},bs.prototype.js=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ks.forEach(function(t,e){i.Hs(e)&&n(e)})},bs.prototype.zs=function(t){var e,n,i=t.targetId,r=t.ms.count,o=this.Ys(i);o&&((e=o.target).qt()?0===r?(n=new Qi(e.path),this.Qs(i,n,new mo(n,ki.min()))):Bs(1===r):this.Xs(i)!==r&&(this.Ks(i),this.xs=this.xs.add(i)))},bs.prototype.Js=function(r){var o=this,s=new Map;this.ks.forEach(function(t,e){var n,i=o.Ys(e);i&&(t.ds&&i.target.qt()&&(n=new Qi(i.target.path),null!==o.qs.get(n)||o.Zs(e,n)||o.Qs(e,n,new mo(n,r))),t.bs&&(s.set(e,t.Ss()),t.Cs()))});var i=as();this.Ms.forEach(function(t,e){var n=!0;e.He(function(t){var e=o.Ys(t);return!e||2===e.we||(n=!1)}),n&&(i=i.add(t))});var t=new vs(r,s,this.xs,this.qs,i);return this.qs=ns,this.Ms=Ds(),this.xs=new ts(Hs),t},bs.prototype.Us=function(t,e){var n;this.Hs(t)&&(n=this.Zs(t,e.key)?2:0,this.Gs(t).Ds(e.key,n),this.qs=this.qs.me(e.key,e),this.Ms=this.Ms.me(e.key,this.ti(e.key).add(t)))},bs.prototype.Qs=function(t,e,n){var i;this.Hs(t)&&(i=this.Gs(t),this.Zs(t,e)?i.Ds(e,1):i.Fs(e),this.Ms=this.Ms.me(e,this.ti(e).delete(t)),n&&(this.qs=this.qs.me(e,n)))},bs.prototype.removeTarget=function(t){this.ks.delete(t)},bs.prototype.Xs=function(t){var e=this.Gs(t).Ss();return this.Os.ei(t).size+e.ws.size-e.Es.size},bs.prototype.Ns=function(t){this.Gs(t).Ns()},bs.prototype.Gs=function(t){var e=this.ks.get(t);return e||(e=new ms,this.ks.set(t,e)),e},bs.prototype.ti=function(t){var e=this.Ms.get(t);return e||(e=new ts(Hs),this.Ms=this.Ms.me(t,e)),e},bs.prototype.Hs=function(t){var e=null!==this.Ys(t);return e||qs("WatchChangeAggregator","Detected inactive target",t),e},bs.prototype.Ys=function(t){var e=this.ks.get(t);return e&&e.gs?null:this.Os.si(t)},bs.prototype.Ks=function(e){var n=this;this.ks.set(e,new ms),this.Os.ei(e).forEach(function(t){n.Qs(e,t,null)})},bs.prototype.Zs=function(t,e){return this.Os.ei(t).has(e)},bs);function bs(t){this.Os=t,this.ks=new Map,this.qs=ns,this.Ms=Ds(),this.xs=new ts(Hs)}function Es(){this.As=0,this.Ps=Ss(),this.Vs=Ji.ht,this.ps=!1,this.ys=!0}function Is(t,e,n,i,r){this.resumeToken=t,this.ds=e,this.ws=n,this.Ts=i,this.Es=r}function Ts(t,e,n,i,r){this.Te=t,this.as=e,this.us=n,this.cs=i,this.ls=r}function As(t,e,n,i,r,o,s,u){this.query=t,this.docs=e,this.ss=n,this.docChanges=i,this.ns=r,this.fromCache=o,this.rs=s,this.hs=u}function Ns(){this.ts=new Qo(Qi.N)}function _s(n){this.N=n?function(t,e){return n(t,e)||Qi.N(t.key,e.key)}:function(t,e){return Qi.N(t.key,e.key)},this.Xe=os,this.Je=new Qo(this.N)}function Ds(){return new Qo(Qi.N)}function Ss(){return new Qo(Qi.N)}var Rs={asc:"ASCENDING",desc:"DESCENDING"},Os={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ks=(Ps.prototype.ni=function(t){var e=void 0===t.code?Ai.UNKNOWN:Wo(t.code);return new Ni(e,t.message||"")},Ps.prototype.ri=function(t){return this.options.hi||tr(t)?t:{value:t}},Ps.prototype.oi=function(t){var e;return tr(e="object"==typeof t?t.value:t)?null:e},Ps.prototype.lt=function(t){return{integerValue:""+t}},Ps.prototype._t=function(t){if(this.options.hi){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:er(t)?"-0":t}},Ps.prototype.ai=function(t){return"number"==typeof(e=t)&&Number.isInteger(e)&&!er(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER?this.lt(t):this._t(t);var e},Ps.prototype.D=function(t){return this.options.hi?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},Ps.prototype.v=function(t){var e=fr(t);return new Oi(e.seconds,e.nanos)},Ps.prototype.ui=function(t){return this.options.hi?t.toBase64():t.toUint8Array()},Ps.prototype.ci=function(t){return this.options.hi?(Bs(void 0===t||"string"==typeof t),Ji.fromBase64String(t||"")):(Bs(void 0===t||t instanceof Uint8Array),Ji.fromUint8Array(t||new Uint8Array))},Ps.prototype.toVersion=function(t){return this.D(t.D())},Ps.prototype.fromVersion=function(t){return Bs(!!t),ki.v(this.v(t))},Ps.prototype.li=function(t,e){return this._i(e||this.ii).child("documents").child(t).j()},Ps.prototype.fi=function(t){var e=Li.G(t);return Bs(Ls(e)),e},Ps.prototype.di=function(t){return this.li(t.path)},Ps.prototype.Z=function(t){var e=this.fi(t);return Bs(e.get(1)===this.ii.projectId),Bs(!e.get(3)&&!this.ii.database||e.get(3)===this.ii.database),new Qi(this.wi(e))},Ps.prototype.Ti=function(t){return this.li(t)},Ps.prototype.Ei=function(t){var e=this.fi(t);return 4===e.length?Li.H:this.wi(e)},Object.defineProperty(Ps.prototype,"Ii",{get:function(){return new Li(["projects",this.ii.projectId,"databases",this.ii.database]).j()},enumerable:!0,configurable:!0}),Ps.prototype._i=function(t){return new Li(["projects",t.projectId,"databases",t.database])},Ps.prototype.wi=function(t){return Bs(4<t.length&&"documents"===t.get(4)),t.L(5)},Ps.prototype.Ri=function(t,e){return{name:this.di(t),fields:e.proto.mapValue.fields}},Ps.prototype.mi=function(t){return{name:this.di(t.key),fields:t.Ot().mapValue.fields,updateTime:this.D(t.version.D())}},Ps.prototype.Ai=function(t,e){var n=this.Z(t.name),i=this.fromVersion(t.updateTime),r=new zr({mapValue:{fields:t.fields}});return new go(n,i,r,{hasCommittedMutations:!!e})},Ps.prototype.Pi=function(t){Bs(!!t.found),t.found.name,t.found.updateTime;var e=this.Z(t.found.name),n=this.fromVersion(t.found.updateTime),i=new zr({mapValue:{fields:t.found.fields}});return new go(e,n,i,{})},Ps.prototype.Vi=function(t){Bs(!!t.missing),Bs(!!t.readTime);var e=this.Z(t.missing),n=this.fromVersion(t.readTime);return new mo(e,n)},Ps.prototype.pi=function(t){return"found"in t?this.Pi(t):"missing"in t?this.Vi(t):Fs()},Ps.prototype.yi=function(t){if("targetChange"in t){t.targetChange;var e=this.gi(t.targetChange.targetChangeType||"NO_CHANGE"),n=t.targetChange.targetIds||[],i=this.ci(t.targetChange.resumeToken),r=t.targetChange.cause,o=r&&this.ni(r),s=new ls(e,n,i,o||null)}else if("documentChange"in t){t.documentChange;var u=t.documentChange;u.document,u.document.name,u.document.updateTime;var a=this.Z(u.document.name),h=this.fromVersion(u.document.updateTime),c=new zr({mapValue:{fields:u.document.fields}}),f=new go(a,h,c,{}),l=u.targetIds||[],p=u.removedTargetIds||[];s=new cs(l,p,f.key,f)}else if("documentDelete"in t){t.documentDelete;var d=t.documentDelete;d.document;var y=this.Z(d.document),v=d.readTime?this.fromVersion(d.readTime):ki.min(),g=new mo(y,v),m=d.removedTargetIds||[];s=new cs([],m,g.key,g)}else if("documentRemove"in t){t.documentRemove;var w=t.documentRemove;w.document;var b=this.Z(w.document),E=w.removedTargetIds||[];s=new cs([],E,b,null)}else{if(!("filter"in t))return Fs();t.filter;var I=t.filter;I.targetId;var T=I.count||0,A=new ro(T),N=I.targetId;s=new fs(N,A)}return s},Ps.prototype.gi=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Fs()},Ps.prototype.bi=function(t){if(!("targetChange"in t))return ki.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?ki.min():this.fromVersion(e.readTime)},Ps.prototype.vi=function(t){var e,n=this;if(t instanceof xr)e={update:this.Ri(t.key,t.value)};else if(t instanceof Br)e={delete:this.di(t.key)};else if(t instanceof jr)e={update:this.Ri(t.key,t.data),updateMask:this.Si(t.Vt)};else if(t instanceof Fr)e={transform:{document:this.di(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Ci(t)})}};else{if(!(t instanceof Gr))return Fs();e={verify:this.di(t.key)}}return t.Rt.wt||(e.currentDocument=this.Di(t.Rt)),e},Ps.prototype.Fi=function(t){var e=this,n=t.currentDocument?this.Ni(t.currentDocument):Cr.dt();if(t.update){t.update.name;var i=this.Z(t.update.name),r=new zr({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.$i(t.updateMask);return new jr(i,r,o,n)}return new xr(i,r,n)}if(t.delete){var s=this.Z(t.delete);return new Br(s,n)}if(t.transform){var u=this.Z(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.Li(t)});return Bs(!0===n.exists),new Fr(u,a)}if(t.verify){var h=this.Z(t.verify);return new Gr(h,n)}return Fs()},Ps.prototype.Di=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Fs()},Ps.prototype.Ni=function(t){return void 0!==t.updateTime?Cr.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?Cr.exists(t.exists):Cr.dt()},Ps.prototype.Oi=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(ki.min())&&(n=this.fromVersion(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new Rr(n,i)},Ps.prototype.ki=function(t,e){var n=this;return t&&0<t.length?(Bs(void 0!==e),t.map(function(t){return n.Oi(t,e)})):[]},Ps.prototype.Ci=function(t){var e=t.transform;if(e instanceof br)return{fieldPath:t.field.j(),setToServerValue:"REQUEST_TIME"};if(e instanceof Ir)return{fieldPath:t.field.j(),appendMissingElements:{values:e.elements}};if(e instanceof Tr)return{fieldPath:t.field.j(),removeAllFromArray:{values:e.elements}};if(e instanceof Ar)return{fieldPath:t.field.j(),increment:e.ct};throw Fs()},Ps.prototype.Li=function(t){var e,n,i=null;"setToServerValue"in t?(Bs("REQUEST_TIME"===t.setToServerValue),i=br.instance):"appendMissingElements"in t?(e=t.appendMissingElements.values||[],i=new Ir(e)):"removeAllFromArray"in t?(n=t.removeAllFromArray.values||[],i=new Tr(n)):"increment"in t?i=new Ar(this,t.increment):Fs();var r=Hi.J(t.fieldPath);return new Mr(r,i)},Ps.prototype.qi=function(t){return{documents:[this.Ti(t.path)]}},Ps.prototype.Mi=function(t){Bs(1===t.documents.length);var e=t.documents[0];return Eo.Wt(this.Ei(e)).ee()},Ps.prototype.xi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Ti(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Ti(n.O()),e.structuredQuery.from=[{collectionId:n.q()}]);var i=this.Bi(t.filters);i&&(e.structuredQuery.where=i);var r=this.Ui(t.orderBy);r&&(e.structuredQuery.orderBy=r);var o=this.ri(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Qi(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Qi(t.endAt)),e},Ps.prototype.Wi=function(t){var e,n=this.Ei(t.parent),i=t.structuredQuery,r=i.from?i.from.length:0,o=null;0<r&&(Bs(1===r),(e=i.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];i.where&&(s=this.ji(i.where));var u=[];i.orderBy&&(u=this.Gi(i.orderBy));var a=null;i.limit&&(a=this.oi(i.limit));var h=null;i.startAt&&(h=this.Hi(i.startAt));var c=null;return i.endAt&&(c=this.Hi(i.endAt)),new Eo(n,o,u,s,a,"F",h,c).ee()},Ps.prototype.Ki=function(t){var e=this.zi(t.we);return null==e?null:{"goog-listen-tags":e}},Ps.prototype.zi=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Fs()}},Ps.prototype.ee=function(t){var e,n=t.target;return(e=n.qt()?{documents:this.qi(n)}:{query:this.xi(n)}).targetId=t.targetId,0<t.resumeToken.rt()&&(e.resumeToken=this.ui(t.resumeToken)),e},Ps.prototype.Bi=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Io?e.Yi(t):Fs()});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},Ps.prototype.ji=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.Xi(t)]:void 0!==t.fieldFilter?[this.Ji(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.ji(t)}).reduce(function(t,e){return t.concat(e)}):Fs():[]},Ps.prototype.Ui=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.Zi(t)})},Ps.prototype.Gi=function(t){var e=this;return t.map(function(t){return e.tn(t)})},Ps.prototype.Qi=function(t){return{before:t.before,values:t.position}},Ps.prototype.Hi=function(t){var e=!!t.before,n=t.values||[];return new So(n,e)},Ps.prototype.en=function(t){return Rs[t]},Ps.prototype.sn=function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}},Ps.prototype.nn=function(t){return Os[t]},Ps.prototype.rn=function(t){switch(t){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Fs()}},Ps.prototype.hn=function(t){return{fieldPath:t.j()}},Ps.prototype.on=function(t){return Hi.J(t.fieldPath)},Ps.prototype.Zi=function(t){return{field:this.hn(t.field),direction:this.en(t.dir)}},Ps.prototype.tn=function(t){return new Ro(this.on(t.field),this.sn(t.direction))},Ps.prototype.Ji=function(t){return Io.create(this.on(t.fieldFilter.field),this.rn(t.fieldFilter.op),t.fieldFilter.value)},Ps.prototype.Yi=function(t){if("=="===t.op){if(mr(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NAN"}};if(gr(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.hn(t.field),op:this.nn(t.op),value:t.value}}},Ps.prototype.Xi=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.on(t.unaryFilter.field);return Io.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=this.on(t.unaryFilter.field);return Io.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Fs()}},Ps.prototype.Si=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.j())}),{fieldPaths:e}},Ps.prototype.$i=function(t){var e=t.fieldPaths||[];return new Vr(e.map(function(t){return Hi.J(t)}))},Ps);function Ps(t,e){this.ii=t,this.options=e}function Ls(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var Us=(Ms.an=function(t){Ms.platform&&Fs(),Ms.platform=t},Ms.nt=function(){return Ms.platform||Fs(),Ms.platform},Ms),Vs=new h("@firebase/firestore");function Ms(){}function Cs(){return Vs.logLevel}function qs(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Vs.logLevel<=p.DEBUG&&(e=n.map(js),Vs.debug.apply(Vs,y(["Firestore ("+mi+"): "+t],e)))}function xs(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Vs.logLevel<=p.ERROR&&(e=n.map(js),Vs.error.apply(Vs,y(["Firestore ("+mi+"): "+t],e)))}function js(t){if("string"==typeof t)return t;var e=Us.nt();try{return e.un(t)}catch(e){return t}}function Fs(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+mi+") INTERNAL ASSERTION FAILED: "+t;throw xs(e),new Error(e)}function Bs(t){t||Fs()}var Gs=(zs.cn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var i=Us.nt().ln(40),r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length));return n},zs);function zs(){}function Hs(t,e){return t<e?-1:e<t?1:0}function Ws(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function Qs(t,e,n,i,r){this.ii=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var Ys=(Object.defineProperty(hu.prototype,"_n",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),hu.prototype.isEqual=function(t){return t instanceof hu&&t.projectId===this.projectId&&t.database===this.database},hu.prototype.S=function(t){return Hs(this.projectId,t.projectId)||Hs(this.database,t.database)},hu),Xs=(au.prototype.get=function(t){var e=this.fn(t),n=this.dn[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],u=o[1];if(s.isEqual(t))return u}},au.prototype.has=function(t){return void 0!==this.get(t)},au.prototype.set=function(t,e){var n=this.fn(t),i=this.dn[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(i[r][0].isEqual(t))return void(i[r]=[t,e]);i.push([t,e])}else this.dn[n]=[[t,e]]},au.prototype.delete=function(t){var e=this.fn(t),n=this.dn[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(n[i][0].isEqual(t))return 1===n.length?delete this.dn[e]:n.splice(i,1),!0;return!1},au.prototype.forEach=function(u){Ki(this.dn,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];u(o,s)}})},au.prototype.M=function(){return $i(this.dn)},au),Ks=(uu.prototype.at=function(t,e,n){for(var i=n.Tn,r=0;r<this.mutations.length;r++){var o,s=this.mutations[r];s.key.isEqual(t)&&(o=i[r],e=s.at(e,o))}return e},uu.prototype.ot=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=r.ot(e,e,this.wn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.ot(e,o,this.wn))}return e},uu.prototype.En=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.ot(t.key,n.get(t.key));e&&(r=r.me(t.key,e))}),r},uu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},as())},uu.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ws(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&Ws(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},uu),$s=(su.from=function(t,e,n){Bs(t.mutations.length===n.length);for(var i=ss,r=t.mutations,o=0;o<r.length;o++)i=i.me(r[o].key,n[o].version);return new su(t,e,n,i)},su),Js=(ou.prototype.catch=function(t){return this.next(void 0,t)},ou.prototype.next=function(i,r){var o=this;return this.Vn&&Fs(),this.Vn=!0,this.Pn?this.error?this.pn(r,this.error):this.yn(i,this.result):new ou(function(e,n){o.mn=function(t){o.yn(i,t).next(e,n)},o.An=function(t){o.pn(r,t).next(e,n)}})},ou.prototype.gn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ou.prototype.bn=function(t){try{var e=t();return e instanceof ou?e:ou.resolve(e)}catch(t){return ou.reject(t)}},ou.prototype.yn=function(t,e){return t?this.bn(function(){return t(e)}):ou.resolve(e)},ou.prototype.pn=function(t,e){return t?this.bn(function(){return t(e)}):ou.reject(e)},ou.resolve=function(n){return new ou(function(t,e){t(n)})},ou.reject=function(n){return new ou(function(t,e){e(n)})},ou.vn=function(t){return new ou(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},ou.Sn=function(t){for(var n=ou.resolve(!1),e=0,i=t;e<i.length;e++)!function(e){n=n.next(function(t){return t?ou.resolve(t):e()})}(i[e]);return n},ou.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.vn(r)},ou),Zs=(ru.prototype.Nn=function(e,n){var i=this;return this.Dn.$n(e,n).next(function(t){return i.Ln(e,n,t)})},ru.prototype.Ln=function(t,i,r){return this.Cn.On(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].ot(i,t);return t})},ru.prototype.kn=function(t,e,r){var o=ns;return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].ot(t,e);o=o.me(t,e)}),o},ru.prototype.qn=function(e,t){var n=this;return this.Cn.getEntries(e,t).next(function(t){return n.Mn(e,t)})},ru.prototype.Mn=function(i,r){var o=this;return this.Dn.xn(i,r).next(function(t){var e=o.kn(i,r,t),n=ns;return e.forEach(function(t,e){e=e||new mo(t,ki.min()),n=n.me(t,e)}),n})},ru.prototype.Bn=function(t,e,n){return e.qt()?this.Un(t,e.path):e.le()?this.Qn(t,e,n):this.Wn(t,e,n)},ru.prototype.Un=function(t,e){return this.Nn(t,new Qi(e)).next(function(t){var e=os;return t instanceof go&&(e=e.me(t.key,t)),e})},ru.prototype.Qn=function(n,i,r){var o=this,s=i.collectionGroup,u=os;return this.Fn.jn(n,s).next(function(t){return Js.forEach(t,function(t){var e=i.Zt(t.child(s));return o.Wn(n,e,r).next(function(t){t.forEach(function(t,e){u=u.me(t,e)})})}).next(function(){return u})})},ru.prototype.Wn=function(e,n,t){var c,f,i=this;return this.Cn.Bn(e,n,t).next(function(t){return c=t,i.Dn.Gn(e,n)}).next(function(t){return f=t,i.Hn(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],u=s.key,a=c.get(u),h=s.ot(a,a,i.wn);c=h instanceof go?c.me(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},ru.prototype.Hn=function(t,e,n){for(var i=as(),r=0,o=e;r<o.length;r++)for(var s=0,u=o[r].mutations;s<u.length;s++){var a=u[s];a instanceof jr&&null===n.get(a.key)&&(i=i.add(a.key))}var h=n;return this.Cn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof go&&(h=h.me(t,e))}),h})},ru),tu=(iu.Yn=function(t,e){for(var n=as(),i=as(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new iu(t,e.fromCache,n,i)},iu),eu=(nu.prototype.Jn=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},nu.prototype.next=function(){var t=++this.previousValue;return this.Zn&&this.Zn(t),t},nu);function nu(t,e){var n=this;this.previousValue=t,e&&(e.Xn=function(t){return n.Jn(t)},this.Zn=function(t){return e.tr(t)})}function iu(t,e,n,i){this.targetId=t,this.fromCache=e,this.Kn=n,this.zn=i}function ru(t,e,n){this.Cn=t,this.Dn=e,this.Fn=n}function ou(t){var e=this;this.mn=null,this.An=null,this.result=void 0,this.error=void 0,this.Pn=!1,this.Vn=!1,t(function(t){e.Pn=!0,e.result=t,e.mn&&e.mn(t)},function(t){e.Pn=!0,e.error=t,e.An&&e.An(t)})}function su(t,e,n,i){this.batch=t,this.In=e,this.Tn=n,this.Rn=i}function uu(t,e,n,i){this.batchId=t,this.wn=e,this.baseMutations=n,this.mutations=i}function au(t){this.fn=t,this.dn={}}function hu(t,e){this.projectId=t,this.database=e||"(default)"}eu.er=-1;function cu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var fu=(mu.prototype.reset=function(){this.or=0},mu.prototype.cr=function(){this.or=this.hr},mu.prototype.lr=function(t){var e=this;this.cancel();var n=Math.floor(this.or+this._r()),i=Math.max(0,Date.now()-this.ur),r=Math.max(0,n-i);0<r&&qs("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.or+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this.ar=this.sr.dr(this.ir,r,function(){return e.ur=Date.now(),t()}),this.or*=this.rr,this.or<this.nr&&(this.or=this.nr),this.or>this.hr&&(this.or=this.hr)},mu.prototype.wr=function(){null!==this.ar&&(this.ar.Tr(),this.ar=null)},mu.prototype.cancel=function(){null!==this.ar&&(this.ar.cancel(),this.ar=null)},mu.prototype._r=function(){return(Math.random()-.5)*this.or},mu),lu=(gu.prototype.Ir=function(t,e){return this.Er.add(e),Js.resolve()},gu.prototype.jn=function(t,e){return Js.resolve(this.Er.getEntries(e))},gu),pu=(vu.prototype.add=function(t){var e=t.q(),n=t.O(),i=this.index[e]||new ts(Li.N),r=!i.has(n);return this.index[e]=i.add(n),r},vu.prototype.has=function(t){var e=t.q(),n=t.O(),i=this.index[e];return i&&i.has(n)},vu.prototype.getEntries=function(t){return(this.index[t]||new ts(Li.N)).W()},vu),du=(yu.prototype.next=function(){return this.Rr+=2,this.Rr},yu.mr=function(){return new yu(0)},yu.Ar=function(){return new yu(-1)},yu);function yu(t){this.Rr=t}function vu(){this.index={}}function gu(){this.Er=new pu}function mu(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.sr=t,this.ir=e,this.nr=n,this.rr=i,this.hr=r,this.or=0,this.ar=null,this.ur=Date.now(),this.reset()}function wu(t){return"IndexedDbTransactionError"===t.name}var bu=(Tu.gr=function(t,e,n,i,r){var o=new Tu(t,e,Date.now()+n,i,r);return o.start(n),o},Tu.prototype.start=function(t){var e=this;this.br=setTimeout(function(){return e.vr()},t)},Tu.prototype.Tr=function(){return this.vr()},Tu.prototype.cancel=function(t){null!==this.br&&(this.clearTimeout(),this.yr.reject(new Ni(Ai.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Tu.prototype.vr=function(){var e=this;this.Pr.Sr(function(){return null!==e.br?(e.clearTimeout(),e.op().then(function(t){return e.yr.resolve(t)})):Promise.resolve()})},Tu.prototype.clearTimeout=function(){null!==this.br&&(this.pr(this),clearTimeout(this.br),this.br=null)},Tu),Eu=(Object.defineProperty(Iu.prototype,"Mr",{get:function(){return this.Fr},enumerable:!0,configurable:!0}),Iu.prototype.Sr=function(t){this.enqueue(t)},Iu.prototype.xr=function(t){this.Br(),this.Ur(t)},Iu.prototype.Qr=function(t){return this.Br(),this.Ur(t)},Iu.prototype.Wr=function(n){return l(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return this.Br(),this.Fr?[3,2]:(this.Fr=!0,(e=Us.nt().window)&&e.removeEventListener("visibilitychange",this.qr),[4,this.Qr(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Iu.prototype.enqueue=function(t){return this.Br(),this.Fr?new Promise(function(t){}):this.Ur(t)},Iu.prototype.jr=function(r){var t=this;this.Br(),this.Fr||(this.Dr=this.Dr.then(function(){var n=new cu,i=function(){return l(t,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,r()];case 1:return t.sent(),n.resolve(),this.kr.reset(),[3,3];case 2:if(!wu(e=t.sent()))throw n.resolve(),e;return qs("AsyncQueue","Operation failed with retryable error: "+e),this.kr.lr(i),[3,3];case 3:return[2]}})})};return t.Sr(i),n.promise}))},Iu.prototype.Ur=function(t){var i=this,e=this.Cr.then(function(){return i.Lr=!0,t().catch(function(t){throw i.$r=t,i.Lr=!1,xs("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return i.Lr=!1,t})});return this.Cr=e},Iu.prototype.dr=function(t,e,n){var i=this;this.Br(),-1<this.Or.indexOf(t)&&(e=0);var r=bu.gr(this,t,e,n,function(t){return i.Gr(t)});return this.Nr.push(r),r},Iu.prototype.Br=function(){this.$r&&Fs()},Iu.prototype.Hr=function(){},Iu.prototype.Kr=function(){return l(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return[4,e=this.Cr];case 1:t.sent(),t.label=2;case 2:if(e!==this.Cr)return[3,0];t.label=3;case 3:return[2]}})})},Iu.prototype.zr=function(t){for(var e=0,n=this.Nr;e<n.length;e++)if(n[e].ir===t)return!0;return!1},Iu.prototype.Yr=function(i){var r=this;return this.Kr().then(function(){r.Nr.sort(function(t,e){return t.Vr-e.Vr});for(var t=0,e=r.Nr;t<e.length;t++){var n=e[t];if(n.Tr(),"all"!==i&&n.ir===i)break}return r.Kr()})},Iu.prototype.Xr=function(t){this.Or.push(t)},Iu.prototype.Gr=function(t){var e=this.Nr.indexOf(t);this.Nr.splice(e,1)},Iu);function Iu(){var t=this;this.Cr=Promise.resolve(),this.Dr=Promise.resolve(),this.Fr=!1,this.Nr=[],this.$r=null,this.Lr=!1,this.Or=[],this.kr=new fu(this,"async_queue_retry"),this.qr=function(){return t.kr.wr()};var e=Us.nt().window;e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.qr)}function Tu(t,e,n,i,r){this.Pr=t,this.ir=e,this.Vr=n,this.op=i,this.pr=r,this.yr=new cu,this.then=this.yr.promise.then.bind(this.yr.promise),this.yr.promise.catch(function(t){})}function Au(t,e){if(xs("AsyncQueue",e+": "+t),wu(t))return new Ni(Ai.UNAVAILABLE,e+": "+t);throw t}var Nu=(_u.eh=function(t){return new _u(t,_u.sh,_u.ih)},_u);function _u(t,e,n){this.Jr=t,this.Zr=e,this.th=n}Nu.nh=-1,Nu.rh=1048576,Nu.hh=41943040,Nu.sh=10,Nu.ih=1e3,Nu.oh=new Nu(Nu.hh,Nu.sh,Nu.ih),Nu.DISABLED=new Nu(Nu.nh,0,0);var Du=(Su.prototype.start=function(){return Promise.resolve()},Su.prototype.Ah=function(r){return l(this,void 0,void 0,function(){var e,m,n,i=this;return d(this,function(t){switch(t.label){case 0:return e=this.Dn,m=this.Ih,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return i.Dn.Ph(v).next(function(t){return g=t,e=i.persistence.fh(r),m=new Zs(i.dh,e,i.persistence.Rh()),e.Ph(v)}).next(function(t){for(var e=[],n=[],i=as(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],i=i.add(h.key)}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.qn(v,i).next(function(t){return{Vh:t,ph:e,yh:n}})})})];case 1:return n=t.sent(),[2,(this.Dn=e,this.Ih=m,this.ah.mh(this.Ih),n)]}})})},Su.prototype.gh=function(u){var a,h=this,c=Oi.now(),t=u.reduce(function(t,e){return t.add(e.key)},as());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.Ih.qn(s,t).next(function(t){a=t;for(var e=[],n=0,i=u;n<i.length;n++){var r=i[n],o=r.Pt(a.get(r.key));null!=o&&e.push(new jr(r.key,o,function u(t){var a=[];return Ki(t.fields||{},function(t,e){var n=new Hi([t]);if(wr(e)){var i=u(e.mapValue).fields;if(0===i.length)a.push(n);else for(var r=0,o=i;r<o.length;r++){var s=o[r];a.push(n.child(s))}}else a.push(n)}),new Vr(a)}(o.proto.mapValue),Cr.exists(!0)))}return h.Dn.bh(s,c,e,u)})}).then(function(t){var e=t.En(a);return{batchId:t.batchId,vh:e}})},Su.prototype.Sh=function(i){var r=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=i.batch.keys(),n=r.dh.Ch({Dh:!0});return r.Fh(t,i,n).next(function(){return n.apply(t)}).next(function(){return r.Dn.Nh(t)}).next(function(){return r.Ih.qn(t,e)})})},Su.prototype.$h=function(t){var i=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Dn.Lh(e,t).next(function(t){return Bs(null!==t),n=t.keys(),i.Dn.Oh(e,t)}).next(function(){return i.Dn.Nh(e)}).next(function(){return i.Ih.qn(e,n)})})},Su.prototype.kh=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Dn.kh(t)})},Su.prototype.qh=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Th.qh(t)})},Su.prototype.Mh=function(a){var h=this,c=a.Te,f=this.uh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var r=h.dh.Ch({Dh:!0});f=h.uh;var s=[];a.as.forEach(function(t,e){var n,i,r=f.get(e);r&&(s.push(h.Th.xh(o,t.Es,e).next(function(){return h.Th.Bh(o,t.ws,e)})),0<(n=t.resumeToken).rt()&&(i=r.Ie(n,c).Ee(o.Uh),f=f.me(e,i),Su.Qh(r,i,t)&&s.push(h.Th.Wh(o,i))))});var t,u=ns,n=as();return a.cs.forEach(function(t,e){n=n.add(t)}),s.push(r.getEntries(o,n).next(function(i){a.cs.forEach(function(t,e){var n=i.get(t);e instanceof mo&&e.version.isEqual(ki.min())?(r.jh(t,c),u=u.me(t,e)):null==n||0<e.version.S(n.version)||0===e.version.S(n.version)&&n.hasPendingWrites?(r.Gh(e,c),u=u.me(t,e)):qs("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.ls.has(t)&&s.push(h.persistence.Kh.Hh(o,t))})})),c.isEqual(ki.min())||(t=h.Th.qh(o).next(function(t){return h.Th.zh(o,o.Uh,c)}),s.push(t)),Js.vn(s).next(function(){return r.apply(o)}).next(function(){return h.Ih.Mn(o,u)})}).then(function(t){return h.uh=f,t})},Su.Qh=function(t,e,n){return Bs(0<e.resumeToken.rt()),0===t.resumeToken.rt()||e.Te.C()-t.Te.C()>=this.Yh||0<n.ws.size+n.Ts.size+n.Es.size},Su.prototype.Xh=function(c){return l(this,void 0,void 0,function(){var e,n,i,r,o,s,u,a,h=this;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Js.forEach(c,function(e){return Js.forEach(e.Kn,function(t){return h.persistence.Kh.Jh(n,e.targetId,t)}).next(function(){return Js.forEach(e.zn,function(t){return h.persistence.Kh.Zh(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!wu(e=t.sent()))throw e;return qs("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,i=c;n<i.length;n++)r=i[n],o=r.targetId,r.fromCache||(s=this.uh.get(o),u=s.Te,a=s.Re(u),this.uh=this.uh.me(o,a));return[2]}})})},Su.prototype.to=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Dn.eo(t,e)})},Su.prototype.so=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Ih.Nn(t,e)})},Su.prototype.io=function(i){var r=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.Th.no(e,i).next(function(t){return t?(n=t,Js.resolve(n)):r.Th.ro(e).next(function(t){return n=new Oo(i,t,0,e.Uh),r.Th.ho(e,n).next(function(){return n})})})}).then(function(t){var e=r.uh.get(t.targetId);return(null===e||0<t.Te.S(e.Te))&&(r.uh=r.uh.me(t.targetId,t),r.lh.set(i,t.targetId)),t})},Su.prototype.no=function(t,e){var n=this.lh.get(e);return void 0!==n?Js.resolve(this.uh.get(n)):this.Th.no(t,e)},Su.prototype.oo=function(t,e){var n=this,i=this.uh.get(t),r=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",r,function(t){return e?Js.resolve():n.persistence.Kh.removeTarget(t,i)}).then(function(){n.uh=n.uh.remove(t),n.lh.delete(i.target)})},Su.prototype.ao=function(t,n){var i=this,r=ki.min(),o=as();return this.persistence.runTransaction("Execute query","readonly",function(e){return i.no(e,t.ee()).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,i.Th.uo(e,t.targetId).next(function(t){o=t})}).next(function(){return i.ah.Bn(e,t,n?r:ki.min(),n?o:as())}).next(function(t){return{documents:t,co:o}})})},Su.prototype.Fh=function(t,r,o){var e=this,s=r.batch,n=s.keys(),u=Js.resolve();return n.forEach(function(i){u=u.next(function(){return o.On(t,i)}).next(function(t){var e=t,n=r.Rn.get(i);Bs(null!==n),(!e||e.version.S(n)<0)&&(e=s.at(i,e,r))&&o.Gh(e,r.In)})}),u.next(function(){return e.Dn.Oh(t,s)})},Su.prototype.lo=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e._o(t,n.uh)})},Su);function Su(t,e,n){this.persistence=t,this.ah=e,this.uh=new Qo(Hs),this.lh=new Xs(function(t){return t.canonicalId()}),this._h=ki.min(),this.Dn=t.fh(n),this.dh=t.wh(),this.Th=t.Eh(),this.Ih=new Zs(this.dh,this.Dn,this.persistence.Rh()),this.ah.mh(this.Ih)}function Ru(e){return l(this,void 0,void 0,function(){return d(this,function(t){if(e.code!==Ai.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return qs("LocalStore","Unexpectedly lost primary lease"),[2]})})}Du.Yh=3e8;var Ou=(Lu.prototype.M=function(){return this.fo.M()},Lu.prototype.Jh=function(t,e){var n=new ku(t,e);this.fo=this.fo.add(n),this.wo=this.wo.add(n)},Lu.prototype.Eo=function(t,e){var n=this;t.forEach(function(t){return n.Jh(t,e)})},Lu.prototype.Zh=function(t,e){this.Io(new ku(t,e))},Lu.prototype.Ro=function(t,e){var n=this;t.forEach(function(t){return n.Zh(t,e)})},Lu.prototype.mo=function(t){var e=this,n=Qi.EMPTY,i=new ku(n,t),r=new ku(n,t+1),o=[];return this.wo.Ge([i,r],function(t){e.Io(t),o.push(t.key)}),o},Lu.prototype.Ao=function(){var e=this;this.fo.forEach(function(t){return e.Io(t)})},Lu.prototype.Io=function(t){this.fo=this.fo.delete(t),this.wo=this.wo.delete(t)},Lu.prototype.Po=function(t){var e=Qi.EMPTY,n=new ku(e,t),i=new ku(e,t+1),r=as();return this.wo.Ge([n,i],function(t){r=r.add(t.key)}),r},Lu.prototype.Vo=function(t){var e=new ku(t,0),n=this.fo.Ke(e);return null!==n&&t.isEqual(n.key)},Lu),ku=(Pu.do=function(t,e){return Qi.N(t.key,e.key)||Hs(t.po,e.po)},Pu.To=function(t,e){return Hs(t.po,e.po)||Qi.N(t.key,e.key)},Pu);function Pu(t,e){this.key=t,this.po=e}function Lu(){this.fo=new ts(ku.do),this.wo=new ts(ku.To)}function Uu(t,e){if(0!==e.length)throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Ju(e.length,"argument")+".")}function Vu(t,e,n){if(e.length!==n)throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() requires "+Ju(n,"argument")+", but was called with "+Ju(e.length,"argument")+".")}function Mu(t,e,n){if(e.length<n)throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Ju(n,"argument")+", but was called with "+Ju(e.length,"argument")+".")}function Cu(t,e,n,i){if(e.length<n||e.length>i)throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+Ju(e.length,"argument")+".")}function qu(t,e,n,i){zu(t,e,$u(n)+" argument",i)}function xu(t,e,n,i){void 0!==i&&qu(t,e,n,i)}function ju(t,e,n,i){zu(t,e,n+" option",i)}function Fu(t,e,n,i){void 0!==i&&ju(t,e,n,i)}function Bu(t,e,n,i,a){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=a;r<o.length;r++){var s=o[r];if(s===n)return;i.push(Wu(s))}var u=Wu(n);throw new Ni(Ai.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function Gu(t,e,n,i){if(!e.some(function(t){return t===i}))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid value "+Wu(i)+" provided to function "+t+"() for its "+$u(n)+" argument. Acceptable values: "+e.join(", "));return i}function zu(t,e,n,i){if(!("object"===e?Hu(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=Wu(i);throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function Hu(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Wu(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Fs();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Qu(t,e,n){if(void 0===n)throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+$u(e)+" argument, but it was undefined.")}function Yu(n,t,i){Ki(t,function(t,e){if(i.indexOf(t)<0)throw new Ni(Ai.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function Xu(t,e,n,i){var r=Wu(i);return new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() requires its "+$u(n)+" argument to be a "+e+", but it was: "+r)}function Ku(t,e,n){if(n<=0)throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() requires its "+$u(e)+" argument to be a positive number, but it was: "+n+".")}function $u(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Ju(t,e){return t+" "+e+(1===t?"":"s")}function Zu(){if("undefined"==typeof Uint8Array)throw new Ni(Ai.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function ta(){if(!Us.nt().yo)throw new Ni(Ai.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function ea(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Ni(Ai.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(qu("FieldPath","string",e,t[e]),0===t[e].length)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.vo=new Hi(t)}var na,ia=(sa.fromBase64String=function(t){Vu("Blob.fromBase64String",arguments,1),qu("Blob.fromBase64String","string",1,t),ta();try{return new sa(Ji.fromBase64String(t))}catch(t){throw new Ni(Ai.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},sa.fromUint8Array=function(t){if(Vu("Blob.fromUint8Array",arguments,1),Zu(),!(t instanceof Uint8Array))throw Xu("Blob.fromUint8Array","Uint8Array",1,t);return new sa(Ji.fromUint8Array(t))},sa.prototype.toBase64=function(){return Vu("Blob.toBase64",arguments,0),ta(),this.bo.toBase64()},sa.prototype.toUint8Array=function(){return Vu("Blob.toUint8Array",arguments,0),Zu(),this.bo.toUint8Array()},sa.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},sa.prototype.isEqual=function(t){return this.bo.isEqual(t.bo)},sa),ra=(n(oa,na=ea),oa.documentId=function(){return oa.So},oa.prototype.isEqual=function(t){if(!(t instanceof oa))throw Xu("isEqual","FieldPath",1,t);return this.vo.isEqual(t.vo)},oa);function oa(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return na.call(this,t)||this}function sa(t){ta(),this.bo=t}ra.So=new ra(Hi.X().j());var ua,aa,ha,ca,fa,la,pa,da=new RegExp("[~\\*/\\[\\]]"),ya=function(){this.Co=this},va=(n(Ca,pa=ya),Ca.prototype.Fo=function(t){if(2!==t.No)throw 1===t.No?t.$o(this.Do+"() can only appear at the top level of your update data"):t.$o(this.Do+"() cannot be used with set() unless you pass {merge:true}");return t.Vt.push(t.path),null},Ca.prototype.isEqual=function(t){return t instanceof Ca},Ca),ga=(n(Ma,la=ya),Ma.prototype.Fo=function(t){return new Mr(t.path,br.instance)},Ma.prototype.isEqual=function(t){return t instanceof Ma},Ma),ma=(n(Va,fa=ya),Va.prototype.Fo=function(t){var e=new xa({No:3,methodName:this.Do,Oo:!0},t.ii,t.serializer,t.ignoreUndefinedProperties),n=this.Lo.map(function(t){return Ga(t,e)}),i=new Ir(n);return new Mr(t.path,i)},Va.prototype.isEqual=function(t){return this===t},Va),wa=(n(Ua,ca=ya),Ua.prototype.Fo=function(t){var e=new xa({No:3,methodName:this.Do,Oo:!0},t.ii,t.serializer,t.ignoreUndefinedProperties),n=this.Lo.map(function(t){return Ga(t,e)}),i=new Tr(n);return new Mr(t.path,i)},Ua.prototype.isEqual=function(t){return this===t},Ua),ba=(n(La,ha=ya),La.prototype.Fo=function(t){var e=new xa({No:3,methodName:this.Do},t.ii,t.serializer,t.ignoreUndefinedProperties),n=Ga(this.ko,e),i=new Ar(t.serializer,n);return new Mr(t.path,i)},La.prototype.isEqual=function(t){return this===t},La),Ea=(n(Pa,aa=ya),Pa.delete=function(){return Uu("FieldValue.delete",arguments),new Ia(new va("FieldValue.delete"))},Pa.serverTimestamp=function(){return Uu("FieldValue.serverTimestamp",arguments),new Ia(new ga("FieldValue.serverTimestamp"))},Pa.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Mu("FieldValue.arrayUnion",arguments,1),new Ia(new ma("FieldValue.arrayUnion",t))},Pa.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Mu("FieldValue.arrayRemove",arguments,1),new Ia(new wa("FieldValue.arrayRemove",t))},Pa.increment=function(t){return qu("FieldValue.increment","number",1,t),Vu("FieldValue.increment",arguments,1),new Ia(new ba("FieldValue.increment",t))},Pa),Ia=(n(ka,ua=Ea),ka.prototype.Fo=function(t){return this.Co.Fo(t)},ka.prototype.isEqual=function(t){return t instanceof ka&&this.Co.isEqual(t.Co)},ka),Ta=(Object.defineProperty(Oa.prototype,"latitude",{get:function(){return this.qo},enumerable:!0,configurable:!0}),Object.defineProperty(Oa.prototype,"longitude",{get:function(){return this.Mo},enumerable:!0,configurable:!0}),Oa.prototype.isEqual=function(t){return this.qo===t.qo&&this.Mo===t.Mo},Oa.prototype.g=function(t){return Hs(this.qo,t.qo)||Hs(this.Mo,t.Mo)},Oa),Aa=/^__.*__$/,Na=function(t,e,n){this.xo=t,this.Bo=e,this.Uo=n},_a=(Ra.prototype.Qo=function(t,e){var n=[];return null!==this.Vt?n.push(new jr(t,this.data,this.Vt,e)):n.push(new xr(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Fr(t,this.fieldTransforms)),n},Ra),Da=(Sa.prototype.Qo=function(t,e){var n=[new jr(t,this.data,this.Vt,e)];return 0<this.fieldTransforms.length&&n.push(new Fr(t,this.fieldTransforms)),n},Sa);function Sa(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function Ra(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function Oa(t,e){if(Vu("GeoPoint",arguments,2),qu("GeoPoint","number",1,t),qu("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Ni(Ai.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Ni(Ai.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.qo=t,this.Mo=e}function ka(t){var e=this;return(e=ua.call(this)||this).Co=t,e.Do=t.Do,e}function Pa(){return null!==aa&&aa.apply(this,arguments)||this}function La(t,e){var n=this;return(n=ha.call(this)||this).Do=t,n.ko=e,n}function Ua(t,e){var n=this;return(n=ca.call(this)||this).Do=t,n.Lo=e,n}function Va(t,e){var n=this;return(n=fa.call(this)||this).Do=t,n.Lo=e,n}function Ma(t){var e=this;return(e=la.call(this)||this).Do=t,e}function Ca(t){var e=this;return(e=pa.call(this)||this).Do=t,e}function qa(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Fs()}}var xa=(Object.defineProperty(Ba.prototype,"path",{get:function(){return this.settings.path},enumerable:!0,configurable:!0}),Object.defineProperty(Ba.prototype,"No",{get:function(){return this.settings.No},enumerable:!0,configurable:!0}),Ba.prototype.jo=function(t){return new Ba(Object.assign(Object.assign({},this.settings),t),this.ii,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Vt)},Ba.prototype.Go=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.jo({path:n,Oo:!1});return i.Ho(t),i},Ba.prototype.Ko=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.jo({path:n,Oo:!1});return i.Wo(),i},Ba.prototype.zo=function(t){return this.jo({path:void 0,Oo:!0})},Ba.prototype.$o=function(t){var e=!this.path||this.path.M()?"":" (found in field "+this.path.toString()+")";return new Ni(Ai.INVALID_ARGUMENT,"Function "+this.settings.methodName+"() called with invalid data. "+t+e)},Ba.prototype.contains=function(e){return void 0!==this.Vt.find(function(t){return e.B(t)})||void 0!==this.fieldTransforms.find(function(t){return e.B(t.field)})},Ba.prototype.Wo=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Ho(this.path.get(t))},Ba.prototype.Ho=function(t){if(0===t.length)throw this.$o("Document fields must not be empty");if(qa(this.No)&&Aa.test(t))throw this.$o('Document fields cannot begin and end with "__"')},Ba),ja=(Fa.prototype.Xo=function(t,e,n){void 0===n&&(n={});var i=this.Jo(n.merge||n.mergeFields?2:0,t);Wa("Data must be an object, but it was:",i,e);var r,o,s=za(e,i);if(n.merge)r=new Vr(i.Vt),o=i.fieldTransforms;else if(n.mergeFields){for(var u=[],a=0,h=n.mergeFields;a<h.length;a++){var c=h[a],f=void 0;if(c instanceof ea)f=c.vo;else{if("string"!=typeof c)throw Fs();f=Ya(t,c)}if(!i.contains(f))throw new Ni(Ai.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Xa(u,f)||u.push(f)}r=new Vr(u),o=i.fieldTransforms.filter(function(t){return r.ft(t.field)})}else r=null,o=i.fieldTransforms;return new _a(new zr(s),r,o)},Fa.prototype.Zo=function(o,t){var s=this.Jo(1,o);Wa("Data must be an object, but it was:",s,t);var u=[],a=new Hr;Ki(t,function(t,e){var n,i=Ya(o,t),r=s.Ko(i);e instanceof ya&&e.Co instanceof va?u.push(i):null!=(n=Ga(e,r))&&(u.push(i),a.set(i,n))});var e=new Vr(u);return new Da(a.gt(),e,s.fieldTransforms)},Fa.prototype.ta=function(t,e,n,i){var r=this.Jo(1,t),o=[Qa(t,e)],s=[n];if(i.length%2!=0)throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<i.length;u+=2)o.push(Qa(t,i[u])),s.push(i[u+1]);for(var a,h,c,f,l=[],p=new Hr,d=o.length-1;0<=d;--d)Xa(l,o[d])||(a=o[d],h=s[d],c=r.Ko(a),h instanceof ya&&h.Co instanceof va?l.push(a):null!=(f=Ga(h,c))&&(l.push(a),p.set(a,f)));var y=new Vr(l);return new Da(p.gt(),y,r.fieldTransforms)},Fa.prototype.Jo=function(t,e){return new xa({No:t,methodName:e,path:Hi.H,Oo:!1},this.ii,this.serializer,this.ignoreUndefinedProperties)},Fa.prototype.ea=function(t,e,n){return void 0===n&&(n=!1),Ga(e,this.Jo(n?4:3,t))},Fa);function Fa(t,e,n){this.ii=t,this.ignoreUndefinedProperties=e,this.serializer=n||Us.nt().Yo(t)}function Ba(t,e,n,i,r,o){this.settings=t,this.ii=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Wo(),this.fieldTransforms=r||[],this.Vt=o||[]}function Ga(s,t){if(Ha(s))return Wa("Unsupported field value:",t,s),za(s,t);if(s instanceof ya)return function(t,e){if(!qa(e.No))throw e.$o(t.Do+"() can only be used with update() and set()");if(!e.path)throw e.$o(t.Do+"() is not currently supported inside arrays");var n=t.Fo(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Vt.push(t.path),s instanceof Array){if(t.settings.Oo&&4!==t.No)throw t.$o("Nested arrays are not supported");return function(t){for(var e=[],n=0,i=0,r=s;i<r.length;i++){var o=Ga(r[i],t.zo(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return e.serializer.ai(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Oi.fromDate(t);return{timestampValue:e.serializer.D(n)}}if(t instanceof Oi){var i=new Oi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:e.serializer.D(i)}}if(t instanceof Ta)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ia)return{bytesValue:e.serializer.ui(t)};if(t instanceof Na){var r=e.ii,o=t.xo;if(!o.isEqual(r))throw e.$o("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+r.projectId+"/"+r.database);return{referenceValue:e.serializer.li(t.Bo.path,t.xo)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.$o("Unsupported field value: "+Wu(t))}(s,t)}function za(t,i){var r={};return $i(t)?i.path&&0<i.path.length&&i.Vt.push(i.path):Ki(t,function(t,e){var n=Ga(e,i.Go(t));null!=n&&(r[t]=n)}),{mapValue:{fields:r}}}function Ha(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Oi||t instanceof Ta||t instanceof ia||t instanceof Na||t instanceof ya)}function Wa(t,e,n){if(!Ha(n)||!Hu(n)){var i=Wu(n);throw"an object"===i?e.$o(t+" a custom object"):e.$o(t+" "+i)}}function Qa(t,e){if(e instanceof ea)return e.vo;if("string"==typeof e)return Ya(t,e);throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Ya(t,e){try{return function(e){if(0<=e.search(da))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ra.bind.apply(ra,y([void 0],e.split("."))))}catch(t){throw new Ni(Ai.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).vo}catch(e){var n=e instanceof Error?e.message:e.toString();throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function Xa(t,e){return t.some(function(t){return t.isEqual(e)})}function Ka(t){this.key=t}function $a(t){this.key=t}function Ja(t,e,n){this.query=t,this.targetId=e,this.view=n}function Za(t){this.key=t,this.Cc=!1}function th(){this.al=void 0,this.ul=[]}var eh,nh,ih,rh,oh=(qh.prototype.oa=function(){return 1===this.state||2===this.state||4===this.state},qh.prototype.aa=function(){return 2===this.state},qh.prototype.start=function(){3!==this.state?this.auth():this.ua()},qh.prototype.stop=function(){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.oa()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},qh.prototype.ca=function(){this.state=0,this.kr.reset()},qh.prototype.la=function(){var t=this;this.aa()&&null===this.ha&&(this.ha=this.sr.dr(this.sa,6e4,function(){return t._a()}))},qh.prototype.fa=function(t){this.da(),this.stream.send(t)},qh.prototype._a=function(){return l(this,void 0,void 0,function(){return d(this,function(t){return this.aa()?[2,this.close(0)]:[2]})})},qh.prototype.da=function(){this.ha&&(this.ha.cancel(),this.ha=null)},qh.prototype.close=function(e,n){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.da(),this.kr.cancel(),this.ra++,3!==e?this.kr.reset():n&&n.code===Ai.RESOURCE_EXHAUSTED?(xs(n.toString()),xs("Using maximum backoff delay to prevent overloading the backend."),this.kr.cr()):n&&n.code===Ai.UNAUTHENTICATED&&this.na.l(),null!==this.stream&&(this.wa(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ta(n)];case 1:return t.sent(),[2]}})})},qh.prototype.wa=function(){},qh.prototype.auth=function(){var n=this;this.state=1;var t=this.Ea(this.ra),e=this.ra;this.na.getToken().then(function(t){n.ra===e&&n.Ia(t)},function(e){t(function(){var t=new Ni(Ai.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Ra(t)})})},qh.prototype.Ia=function(t){var e=this,n=this.Ea(this.ra);this.stream=this.ma(t),this.stream.Aa(function(){n(function(){return e.state=2,e.listener.Aa()})}),this.stream.Ta(function(t){n(function(){return e.Ra(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},qh.prototype.ua=function(){var t=this;this.state=4,this.kr.lr(function(){return l(t,void 0,void 0,function(){return d(this,function(t){return this.state=0,this.start(),[2]})})})},qh.prototype.Ra=function(t){return qs("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},qh.prototype.Ea=function(e){var n=this;return function(t){n.sr.Sr(function(){return n.ra===e?t():(qs("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},qh),sh=(n(Ch,ih=oh),Ch.prototype.ma=function(t){return this.ia.Pa("Listen",t)},Ch.prototype.onMessage=function(t){this.kr.reset();var e=this.serializer.yi(t),n=this.serializer.bi(t);return this.listener.Va(e,n)},Ch.prototype.pa=function(t){var e={};e.database=this.serializer.Ii,e.addTarget=this.serializer.ee(t);var n=this.serializer.Ki(t);n&&(e.labels=n),this.fa(e)},Ch.prototype.ya=function(t){var e={};e.database=this.serializer.Ii,e.removeTarget=t,this.fa(e)},Ch),uh=(n(Mh,nh=oh),Object.defineProperty(Mh.prototype,"ba",{get:function(){return this.ga},enumerable:!0,configurable:!0}),Mh.prototype.start=function(){this.ga=!1,this.lastStreamToken=Ji.ht,nh.prototype.start.call(this)},Mh.prototype.wa=function(){this.ga&&this.va([])},Mh.prototype.ma=function(t){return this.ia.Pa("Write",t)},Mh.prototype.onMessage=function(t){if(Bs(!!t.streamToken),this.lastStreamToken=this.serializer.ci(t.streamToken),this.ga){this.kr.reset();var e=this.serializer.ki(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.Sa(n,e)}return Bs(!t.writeResults||0===t.writeResults.length),this.ga=!0,this.listener.Ca()},Mh.prototype.Da=function(){var t={};t.database=this.serializer.Ii,this.fa(t)},Mh.prototype.va=function(t){var e=this,n={streamToken:this.serializer.ui(this.lastStreamToken),writes:t.map(function(t){return e.serializer.vi(t)})};this.fa(n)},Mh),ah=(n(Vh,eh=function(){this.Fa=void 0}),Vh.prototype.$a=function(){if(this.Na)throw new Ni(Ai.FAILED_PRECONDITION,"The client has already been terminated.")},Vh.prototype.La=function(e,n){var i=this;return this.$a(),this.credentials.getToken().then(function(t){return i.ia.La(e,n,t)}).catch(function(t){throw t.code===Ai.UNAUTHENTICATED&&i.credentials.l(),t})},Vh.prototype.Oa=function(e,n){var i=this;return this.$a(),this.credentials.getToken().then(function(t){return i.ia.Oa(e,n,t)}).catch(function(t){throw t.code===Ai.UNAUTHENTICATED&&i.credentials.l(),t})},Vh),hh=(Uh.prototype.Ua=function(i){return l(this,void 0,void 0,function(){var e,n=this;return d(this,function(t){switch(t.label){case 0:if(this.Qa(),0<this.mutations.length)throw new Ni(Ai.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return l(this,void 0,void 0,function(){var n,e,i,r,o;return d(this,function(t){switch(t.label){case 0:return e={database:(n=s).serializer.Ii,documents:u.map(function(t){return n.serializer.di(t)})},[4,n.Oa("BatchGetDocuments",e)];case 1:return i=t.sent(),r=new Map,i.forEach(function(t){var e=n.serializer.pi(t);r.set(e.key.toString(),e)}),o=[],[2,(u.forEach(function(t){var e=r.get(t.toString());Bs(!!e),o.push(e)}),o)]}})})}(this.ka,i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof mo||t instanceof go?n.Wa(t):Fs()}),e)]}})})},Uh.prototype.set=function(t,e){this.write(e.Qo(t,this.Rt(t))),this.Ba.add(t)},Uh.prototype.update=function(t,e){try{this.write(e.Qo(t,this.ja(t)))}catch(t){this.xa=t}this.Ba.add(t)},Uh.prototype.delete=function(t){this.write([new Br(t,this.Rt(t))]),this.Ba.add(t)},Uh.prototype.commit=function(){return l(this,void 0,void 0,function(){var e,i=this;return d(this,function(t){switch(t.label){case 0:if(this.Qa(),this.xa)throw this.xa;return e=this.qa,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new Qi(Li.G(e));i.mutations.push(new Gr(n,i.Rt(n)))}),[4,function(i,r){return l(this,void 0,void 0,function(){var e,n;return d(this,function(t){switch(t.label){case 0:return n={database:(e=i).serializer.Ii,writes:r.map(function(t){return e.serializer.vi(t)})},[4,e.La("Commit",n)];case 1:return t.sent(),[2]}})})}(this.ka,this.mutations)];case 1:return t.sent(),this.Ma=!0,[2]}})})},Uh.prototype.Wa=function(t){var e;if(t instanceof go)e=t.version;else{if(!(t instanceof mo))throw Fs();e=ki.min()}var n=this.qa.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ni(Ai.ABORTED,"Document version changed between two reads.")}else this.qa.set(t.key.toString(),e)},Uh.prototype.Rt=function(t){var e=this.qa.get(t.toString());return!this.Ba.has(t)&&e?Cr.updateTime(e):Cr.dt()},Uh.prototype.ja=function(t){var e=this.qa.get(t.toString());if(this.Ba.has(t)||!e)return Cr.exists(!0);if(e.isEqual(ki.min()))throw new Ni(Ai.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Cr.updateTime(e)},Uh.prototype.write=function(t){this.Qa(),this.mutations=this.mutations.concat(t)},Uh.prototype.Qa=function(){},Uh),ch=(Lh.prototype.Ya=function(){var t=this;0===this.Ha&&(this.Xa("Unknown"),this.Ka=this.Pr.dr("online_state_timeout",1e4,function(){return t.Ka=null,t.Ja("Backend didn't respond within 10 seconds."),t.Xa("Offline"),Promise.resolve()}))},Lh.prototype.Za=function(t){"Online"===this.state?this.Xa("Unknown"):(this.Ha++,1<=this.Ha&&(this.tu(),this.Ja("Connection failed 1 times. Most recent error: "+t.toString()),this.Xa("Offline")))},Lh.prototype.set=function(t){this.tu(),this.Ha=0,"Online"===t&&(this.za=!1),this.Xa(t)},Lh.prototype.Xa=function(t){t!==this.state&&(this.state=t,this.Ga(t))},Lh.prototype.Ja=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.za?(xs(e),this.za=!1):qs("OnlineStateTracker",e)},Lh.prototype.tu=function(){null!==this.Ka&&(this.Ka.cancel(),this.Ka=null)},Lh),fh=(Ph.prototype.start=function(){return this.enableNetwork()},Ph.prototype.enableNetwork=function(){return this.networkEnabled=!0,this.Ru()},Ph.prototype.Ru=function(){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.au()?(this.mu()?this.Au():this.cu.set("Unknown"),[4,this.Pu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ph.prototype.disableNetwork=function(){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Vu()];case 1:return t.sent(),this.cu.set("Offline"),[2]}})})},Ph.prototype.Vu=function(){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return[4,this.wu.stop()];case 1:return t.sent(),[4,this.lu.stop()];case 2:return t.sent(),0<this.su.length&&(qs("RemoteStore","Stopping write stream with "+this.su.length+" pending writes"),this.su=[]),this.pu(),[2]}})})},Ph.prototype.yu=function(){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return qs("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.Vu()];case 1:return t.sent(),this.hu.yu(),this.cu.set("Unknown"),[2]}})})},Ph.prototype.listen=function(t){this.iu.has(t.targetId)||(this.iu.set(t.targetId,t),this.mu()?this.Au():this.lu.aa()&&this.gu(t))},Ph.prototype.bu=function(t){this.iu.delete(t),this.lu.aa()&&this.vu(t),0===this.iu.size&&(this.lu.aa()?this.lu.la():this.au()&&this.cu.set("Unknown"))},Ph.prototype.si=function(t){return this.iu.get(t)||null},Ph.prototype.ei=function(t){return this.Su.ei(t)},Ph.prototype.gu=function(t){this.nu.Ns(t.targetId),this.lu.pa(t)},Ph.prototype.vu=function(t){this.nu.Ns(t),this.lu.ya(t)},Ph.prototype.Au=function(){this.nu=new ws(this),this.lu.start(),this.cu.Ya()},Ph.prototype.mu=function(){return this.au()&&!this.lu.oa()&&0<this.iu.size},Ph.prototype.au=function(){return!this.ru&&this.isPrimary&&this.networkEnabled},Ph.prototype.pu=function(){this.nu=null},Ph.prototype._u=function(){return l(this,void 0,void 0,function(){var n=this;return d(this,function(t){return this.iu.forEach(function(t,e){n.gu(t)}),[2]})})},Ph.prototype.fu=function(e){return l(this,void 0,void 0,function(){return d(this,function(t){return this.pu(),this.mu()?(this.cu.Za(e),this.Au()):this.cu.set("Unknown"),[2]})})},Ph.prototype.du=function(r,o){return l(this,void 0,void 0,function(){var e,n,i;return d(this,function(t){switch(t.label){case 0:if(this.cu.set("Online"),!(r instanceof ls&&2===r.state&&r.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Cu(r)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),qs("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),e),[4,this.Du(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(r instanceof cs?this.nu.Bs(r):r instanceof fs?this.nu.zs(r):this.nu.Ws(r),o.isEqual(ki.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.eu.qh()];case 8:return n=t.sent(),0<=o.S(n)?[4,this.Fu(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return qs("RemoteStore","Failed to raise snapshot:",i=t.sent()),[4,this.Du(i)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Ph.prototype.Du=function(n,i){return l(this,void 0,void 0,function(){var e=this;return d(this,function(t){switch(t.label){case 0:if(!wu(n))throw n;return this.ru=!0,[4,this.Vu()];case 1:return t.sent(),this.cu.set("Offline"),i=i||function(){return e.eu.qh()},this.Pr.jr(function(){return l(e,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return qs("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),this.ru=!1,[4,this.Ru()];case 2:return t.sent(),[2]}})})}),[2]}})})},Ph.prototype.Nu=function(e){var n=this;return e().catch(function(t){return n.Du(t,e)})},Ph.prototype.Fu=function(i){var r=this,t=this.nu.Js(i);return t.as.forEach(function(t,e){var n;0<t.resumeToken.rt()&&(n=r.iu.get(e))&&r.iu.set(e,n.Ie(t.resumeToken,i))}),t.us.forEach(function(t){var e,n=r.iu.get(t);n&&(r.iu.set(t,n.Ie(Ji.ht,n.Te)),r.vu(t),e=new Oo(n.target,t,1,n.sequenceNumber),r.gu(e))}),this.Su.Mh(t)},Ph.prototype.Cu=function(o){return l(this,void 0,void 0,function(){var e,n,i,r;return d(this,function(t){switch(t.label){case 0:e=o.cause,n=0,i=o.targetIds,t.label=1;case 1:return n<i.length?(r=i[n],this.iu.has(r)?[4,this.Su.$u(r,e)]:[3,3]):[3,5];case 2:t.sent(),this.iu.delete(r),this.nu.removeTarget(r),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Ph.prototype.Pu=function(){return l(this,void 0,void 0,function(){var e,n,i;return d(this,function(t){switch(t.label){case 0:e=0<this.su.length?this.su[this.su.length-1].batchId:-1,t.label=1;case 1:if(!this.Lu())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.eu.to(e)];case 3:return null===(n=t.sent())?(0===this.su.length&&this.wu.la(),[3,7]):(e=n.batchId,this.Ou(n),[3,6]);case 4:return i=t.sent(),[4,this.Du(i)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.ku()&&this.qu(),[2]}})})},Ph.prototype.Lu=function(){return this.au()&&this.su.length<10},Ph.prototype.Mu=function(){return this.su.length},Ph.prototype.Ou=function(t){this.su.push(t),this.wu.aa()&&this.wu.ba&&this.wu.va(t.mutations)},Ph.prototype.ku=function(){return this.au()&&!this.wu.oa()&&0<this.su.length},Ph.prototype.qu=function(){this.wu.start()},Ph.prototype.Tu=function(){return l(this,void 0,void 0,function(){return d(this,function(t){return this.wu.Da(),[2]})})},Ph.prototype.Iu=function(){return l(this,void 0,void 0,function(){var e,n,i;return d(this,function(t){for(e=0,n=this.su;e<n.length;e++)i=n[e],this.wu.va(i.mutations);return[2]})})},Ph.prototype.Sa=function(r,o){return l(this,void 0,void 0,function(){var e,n,i=this;return d(this,function(t){switch(t.label){case 0:return e=this.su.shift(),n=$s.from(e,r,o),[4,this.Nu(function(){return i.Su.xu(n)})];case 1:return t.sent(),[4,this.Pu()];case 2:return t.sent(),[2]}})})},Ph.prototype.Eu=function(e){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return e&&this.wu.ba?[4,this.Bu(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.ku()&&this.qu(),[2]}})})},Ph.prototype.Bu=function(r){return l(this,void 0,void 0,function(){var e,n,i=this;return d(this,function(t){switch(t.label){case 0:return Ho(n=r.code)&&n!==Ai.ABORTED?(e=this.su.shift(),this.wu.ca(),[4,this.Nu(function(){return i.Su.Uu(e.batchId,r)})]):[3,3];case 1:return t.sent(),[4,this.Pu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Ph.prototype.Qu=function(){return new hh(this.ka)},Ph.prototype.uu=function(){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Vu()];case 1:return t.sent(),this.cu.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},Ph.prototype.Wu=function(){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.au()?(qs("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.uu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ph.prototype.ju=function(e){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:[4,this.Vu()];case 3:t.sent(),this.cu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Ph),lh=(kh.prototype.Gu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},kh.prototype.Hu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},kh.prototype.Ku=function(){var t={activeTargetIds:this.activeTargetIds.W(),updateTimeMs:Date.now()};return JSON.stringify(t)},kh),ph=(Oh.prototype.Xu=function(t){},Oh.prototype.Ju=function(t,e,n){},Oh.prototype.Zu=function(t){return this.zu.Gu(t),this.Yu[t]||"not-current"},Oh.prototype.tc=function(t,e,n){this.Yu[t]=e},Oh.prototype.ec=function(t){this.zu.Hu(t)},Oh.prototype.sc=function(t){return this.zu.activeTargetIds.has(t)},Oh.prototype.ic=function(t){delete this.Yu[t]},Oh.prototype.nc=function(){return this.zu.activeTargetIds},Oh.prototype.rc=function(t){return this.zu.activeTargetIds.has(t)},Oh.prototype.start=function(){return this.zu=new lh,Promise.resolve()},Oh.prototype.Ah=function(t,e,n){},Oh.prototype.hc=function(t){},Oh.prototype.yu=function(){},Oh.prototype.tr=function(t){},Oh),dh=(Object.defineProperty(Rh.prototype,"lc",{get:function(){return this.oc},enumerable:!0,configurable:!0}),Rh.prototype._c=function(t,e){var u=this,a=e?e.fc:new ds,h=e?e.cc:this.cc,c=e?e.ns:this.ns,f=h,l=!1,p=this.query.oe()&&h.size===this.query.limit?h.last():null,d=this.query.ae()&&h.size===this.query.limit?h.first():null;if(t.ye(function(t,e){var n=h.get(t),i=(i=e instanceof go?e:null)&&(u.query.matches(i)?i:null),r=!!n&&u.ns.has(n.key),o=!!i&&(i.At||u.ns.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(a.track({type:3,doc:i}),s=!0):u.dc(n,i)||(a.track({type:2,doc:i}),s=!0,(p&&0<u.query.se(i,p)||d&&u.query.se(i,d)<0)&&(l=!0)):!n&&i?(a.track({type:0,doc:i}),s=!0):n&&!i&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=i?(f=f.add(i),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.oe()||this.query.ae())for(;f.size>this.query.limit;){var n=this.query.oe()?f.last():f.first(),f=f.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{cc:f,fc:a,wc:l,ns:c}},Rh.prototype.dc=function(t,e){return t.At&&e.hasCommittedMutations&&!e.At},Rh.prototype.Tc=function(t,e,n){var o=this,i=this.cc;this.cc=t.cc,this.ns=t.ns;var r=t.fc.es();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.query.se(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Fs()}}var i,r}),this.Ec(n);var s=e?this.Ic():[],u=0===this.uc.size&&this.ds?1:0,a=u!==this.ac;return this.ac=u,0!==r.length||a?{snapshot:new ys(this.query,t.cc,i,r,t.ns,0==u,a,!1),Rc:s}:{Rc:s}},Rh.prototype.mc=function(t){return this.ds&&"Offline"===t?(this.ds=!1,this.Tc({cc:this.cc,fc:new ds,ns:this.ns,wc:!1},!1)):{Rc:[]}},Rh.prototype.Ac=function(t){return!this.oc.has(t)&&!!this.cc.has(t)&&!this.cc.get(t).At},Rh.prototype.Ec=function(t){var e=this;t&&(t.ws.forEach(function(t){return e.oc=e.oc.add(t)}),t.Ts.forEach(function(t){}),t.Es.forEach(function(t){return e.oc=e.oc.delete(t)}),this.ds=t.ds)},Rh.prototype.Ic=function(){var e=this;if(!this.ds)return[];var n=this.uc;this.uc=as(),this.cc.forEach(function(t){e.Ac(t.key)&&(e.uc=e.uc.add(t.key))});var i=[];return n.forEach(function(t){e.uc.has(t)||i.push(new $a(t))}),this.uc.forEach(function(t){n.has(t)||i.push(new Ka(t))}),i},Rh.prototype.Pc=function(t){this.oc=t.co,this.uc=as();var e=this._c(t.documents);return this.Tc(e,!0)},Rh.prototype.Vc=function(){return ys.os(this.query,this.cc,this.ns,0===this.ac)},Rh),yh=(Sh.prototype.yc=function(){this.gc()},Sh.prototype.gc=function(){var t=this;this.kr.lr(function(){return l(t,void 0,void 0,function(){var e,n,i=this;return d(this,function(t){return e=new hh(this.ka),(n=this.bc(e))&&n.then(function(t){i.Pr.Sr(function(){return e.commit().then(function(){i.yr.resolve(t)}).catch(function(t){i.vc(t)})})}).catch(function(t){i.vc(t)}),[2]})})})},Sh.prototype.bc=function(t){try{var e=this.updateFunction(t);return!tr(e)&&e.catch&&e.then?e:(this.yr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.yr.reject(t),null}},Sh.prototype.vc=function(t){var e=this;0<this.pc&&this.Sc(t)?(--this.pc,this.Pr.Sr(function(){return e.gc(),Promise.resolve()})):this.yr.reject(t)},Sh.prototype.Sc=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ho(e)},Sh),vh=(Object.defineProperty(Dh.prototype,"Wc",{get:function(){return!0},enumerable:!0,configurable:!0}),Dh.prototype.subscribe=function(t){this.$c=t},Dh.prototype.listen=function(s){return l(this,void 0,void 0,function(){var e,n,i,r,o;return d(this,function(t){switch(t.label){case 0:return this.jc("listen()"),(i=this.Lc.get(s))?(e=i.targetId,this.Fc.Zu(e),n=i.view.Vc(),[3,4]):[3,1];case 1:return[4,this.eu.io(s.ee())];case 2:return r=t.sent(),o=this.Fc.Zu(r.targetId),e=r.targetId,[4,this.Gc(s,e,"current"===o)];case 3:n=t.sent(),this.Wc&&this.Dc.listen(r),t.label=4;case 4:return[2,n]}})})},Dh.prototype.Gc=function(u,a,h){return l(this,void 0,void 0,function(){var e,n,i,r,o,s;return d(this,function(t){switch(t.label){case 0:return[4,this.eu.ao(u,!0)];case 1:return e=t.sent(),n=new dh(u,e.co),i=n._c(e.documents),r=gs.fs(a,h&&"Offline"!==this.onlineState),o=n.Tc(i,this.Wc,r),this.Hc(a,o.Rc),s=new Ja(u,a,n),[2,(this.Lc.set(u,s),this.Oc.has(a)?this.Oc.get(a).push(u):this.Oc.set(a,[u]),o.snapshot)]}})})},Dh.prototype.bu=function(r){return l(this,void 0,void 0,function(){var e,n,i=this;return d(this,function(t){switch(t.label){case 0:return this.jc("unlisten()"),e=this.Lc.get(r),1<(n=this.Oc.get(e.targetId)).length?[2,(this.Oc.set(e.targetId,n.filter(function(t){return!t.isEqual(r)})),void this.Lc.delete(r))]:this.Wc?(this.Fc.ec(e.targetId),this.Fc.rc(e.targetId)?[3,2]:[4,this.eu.oo(e.targetId,!1).then(function(){i.Fc.ic(e.targetId),i.Dc.bu(e.targetId),i.Kc(e.targetId)}).catch(Ru)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.Kc(e.targetId),[4,this.eu.oo(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Dh.prototype.write=function(r,o){return l(this,void 0,void 0,function(){var e,n,i;return d(this,function(t){switch(t.label){case 0:this.jc("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.eu.gh(r)];case 2:return e=t.sent(),this.Fc.Xu(e.batchId),this.zc(e.batchId,o),[4,this.Yc(e.vh)];case 3:return t.sent(),[4,this.Dc.Pu()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),i=Au(n,"Failed to persist write"),o.reject(i),[3,6];case 6:return[2]}})})},Dh.prototype.runTransaction=function(t,e,n){new yh(t,this.ka,e,n).yc()},Dh.prototype.Mh=function(n){return l(this,void 0,void 0,function(){var e,i=this;return d(this,function(t){switch(t.label){case 0:this.jc("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.eu.Mh(n)];case 2:return e=t.sent(),n.as.forEach(function(t,e){var n=i.Mc.get(e);n&&(Bs(t.ws.size+t.Ts.size+t.Es.size<=1),0<t.ws.size?n.Cc=!0:0<t.Ts.size?Bs(n.Cc):0<t.Es.size&&(Bs(n.Cc),n.Cc=!1))}),[4,this.Yc(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Ru(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Dh.prototype.mc=function(i,t){this.jc("applyOnlineStateChange()");var r=[];this.Lc.forEach(function(t,e){var n=e.view.mc(i);n.snapshot&&r.push(n.snapshot)}),this.$c.Xc(i),this.$c.Va(r),this.onlineState=i},Dh.prototype.$u=function(u,a){return l(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return d(this,function(t){switch(t.label){case 0:return this.jc("rejectListens()"),this.Fc.tc(u,"rejected",a),e=this.Mc.get(u),(n=e&&e.key)?(i=(i=new Qo(Qi.N)).me(n,new mo(n,ki.min())),r=as().add(n),o=new vs(ki.min(),new Map,new ts(Hs),i,r),[4,this.Mh(o)]):[3,2];case 1:return t.sent(),this.qc=this.qc.remove(n),this.Mc.delete(u),this.Jc(),[3,4];case 2:return[4,this.eu.oo(u,!1).then(function(){return s.Kc(u,a)}).catch(Ru)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},Dh.prototype.xu=function(i){return l(this,void 0,void 0,function(){var e,n;return d(this,function(t){switch(t.label){case 0:this.jc("applySuccessfulWrite()"),e=i.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.eu.Sh(i)];case 2:return n=t.sent(),this.Zc(e,null),this.tl(e),this.Fc.Ju(e,"acknowledged"),[4,this.Yc(n)];case 3:return t.sent(),[3,6];case 4:return[4,Ru(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Dh.prototype.Uu=function(n,i){return l(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:this.jc("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.eu.$h(n)];case 2:return e=t.sent(),this.Zc(n,i),this.tl(n),this.Fc.Ju(n,"rejected",i),[4,this.Yc(e)];case 3:return t.sent(),[3,6];case 4:return[4,Ru(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Dh.prototype.el=function(o){return l(this,void 0,void 0,function(){var e,n,i,r;return d(this,function(t){switch(t.label){case 0:this.Dc.au()||qs("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.eu.kh()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.Uc.get(e)||[]).push(o),this.Uc.set(e,n),[3,4]);case 3:return i=t.sent(),r=Au(i,"Initialization of waitForPendingWrites() operation failed"),o.reject(r),[3,4];case 4:return[2]}})})},Dh.prototype.tl=function(t){(this.Uc.get(t)||[]).forEach(function(t){t.resolve()}),this.Uc.delete(t)},Dh.prototype.sl=function(e){this.Uc.forEach(function(t){t.forEach(function(t){t.reject(new Ni(Ai.CANCELLED,e))})}),this.Uc.clear()},Dh.prototype.zc=function(t,e){var n=this.Bc[this.currentUser.s()];n=(n=n||new Qo(Hs)).me(t,e),this.Bc[this.currentUser.s()]=n},Dh.prototype.Zc=function(t,e){var n,i=this.Bc[this.currentUser.s()];i&&((n=i.get(t))&&(e?n.reject(e):n.resolve(),i=i.remove(t)),this.Bc[this.currentUser.s()]=i)},Dh.prototype.Kc=function(t,e){var n=this;void 0===e&&(e=null),this.Fc.ec(t);for(var i=0,r=this.Oc.get(t);i<r.length;i++){var o=r[i];this.Lc.delete(o),e&&this.$c.il(o,e)}this.Oc.delete(t),this.Wc&&this.xc.mo(t).forEach(function(t){n.xc.Vo(t)||n.nl(t)})},Dh.prototype.nl=function(t){var e=this.qc.get(t);null!==e&&(this.Dc.bu(e),this.qc=this.qc.remove(t),this.Mc.delete(e),this.Jc())},Dh.prototype.Hc=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof Ka?(this.xc.Jh(r.key,t),this.rl(r)):r instanceof $a?(qs("SyncEngine","Document no longer in limbo: "+r.key),this.xc.Zh(r.key,t),this.xc.Vo(r.key)||this.nl(r.key)):Fs()}},Dh.prototype.rl=function(t){var e=t.key;this.qc.get(e)||(qs("SyncEngine","New document in limbo: "+e),this.kc.push(e),this.Jc())},Dh.prototype.Jc=function(){for(;0<this.kc.length&&this.qc.size<this.Nc;){var t=this.kc.shift(),e=this.Qc.next();this.Mc.set(e,new Za(t)),this.qc=this.qc.me(t,e),this.Dc.listen(new Oo(Eo.Wt(t.path).ee(),e,2,eu.er))}},Dh.prototype.hl=function(){return this.qc},Dh.prototype.ol=function(){return this.kc},Dh.prototype.Yc=function(i,a){return l(this,void 0,void 0,function(){var o,s,e,u=this;return d(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Lc.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view._c(i);return n.wc?u.eu.ao(r.query,!1).then(function(t){var e=t.documents;return r.view._c(e,n)}):n}).then(function(t){var e,n=a&&a.as.get(r.targetId),i=r.view.Tc(t,u.Wc,n);u.Hc(r.targetId,i.Rc),i.snapshot&&(u.Wc&&u.Fc.tc(r.targetId,i.snapshot.fromCache?"not-current":"current"),o.push(i.snapshot),e=tu.Yn(r.targetId,i.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.$c.Va(o),[4,this.eu.Xh(s)];case 2:return t.sent(),[2]}})})},Dh.prototype.jc=function(t){},Dh.prototype.Wu=function(n){return l(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:[4,this.eu.Ah(n)];case 1:return e=t.sent(),this.currentUser=n,this.sl("'waitForPendingWrites' promise is rejected due to a user change."),this.Fc.Ah(n,e.ph,e.yh),[4,this.Yc(e.Vh)];case 2:t.sent(),t.label=3;case 3:return[4,this.Dc.Wu()];case 4:return t.sent(),[2]}})})},Dh.prototype.enableNetwork=function(){return this.Dc.enableNetwork()},Dh.prototype.disableNetwork=function(){return this.Dc.disableNetwork()},Dh.prototype.ei=function(t){var e=this.Mc.get(t);if(e&&e.Cc)return as().add(e.key);var n=as(),i=this.Oc.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++)var s=o[r],u=this.Lc.get(s),n=n.ze(u.view.lc);return n},Dh),gh=(_h.prototype.listen=function(u){return l(this,void 0,void 0,function(){var e,n,i,r,o,s;return d(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(i=this.cl.get(e))||(n=!0,i=new th),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),r=i,[4,this.Su.listen(e)];case 2:return r.al=t.sent(),[3,4];case 3:return o=t.sent(),s=Au(o,"Initialization of query '"+u.query+"' failed"),[2,void u.onError(s)];case 4:return this.cl.set(e,i),i.ul.push(u),u.mc(this.onlineState),i.al&&u._l(i.al)&&this.fl(),[2]}})})},_h.prototype.bu=function(o){return l(this,void 0,void 0,function(){var e,n,i,r;return d(this,function(t){return e=o.query,n=!1,(i=this.cl.get(e))&&0<=(r=i.ul.indexOf(o))&&(i.ul.splice(r,1),n=0===i.ul.length),n?[2,(this.cl.delete(e),this.Su.bu(e))]:[2]})})},_h.prototype.Va=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.cl.get(o);if(s){for(var u=0,a=s.ul;u<a.length;u++)a[u]._l(r)&&(e=!0);s.al=r}}e&&this.fl()},_h.prototype.il=function(t,e){var n=this.cl.get(t);if(n)for(var i=0,r=n.ul;i<r.length;i++)r[i].onError(e);this.cl.delete(t)},_h.prototype.Xc=function(r){this.onlineState=r;var o=!1;this.cl.forEach(function(t,e){for(var n=0,i=e.ul;n<i.length;n++)i[n].mc(r)&&(o=!0)}),o&&this.fl()},_h.prototype.dl=function(t){this.ll.add(t),t.next()},_h.prototype.wl=function(t){this.ll.delete(t)},_h.prototype.fl=function(){this.ll.forEach(function(t){t.next()})},_h),mh=(Nh.prototype._l=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new ys(t.query,t.docs,t.ss,e,t.ns,t.fromCache,t.rs,!0)}var o=!1;return this.El?this.Rl(t)&&(this.Tl.next(t),o=!0):this.ml(t,this.onlineState)&&(this.Al(t),o=!0),this.Il=t,o},Nh.prototype.onError=function(t){this.Tl.error(t)},Nh.prototype.mc=function(t){this.onlineState=t;var e=!1;return this.Il&&!this.El&&this.ml(this.Il,t)&&(this.Al(this.Il),e=!0),e},Nh.prototype.ml=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Pl&&n||t.docs.M()&&"Offline"!==e)},Nh.prototype.Rl=function(t){if(0<t.docChanges.length)return!0;var e=this.Il&&this.Il.hasPendingWrites!==t.hasPendingWrites;return!(!t.rs&&!e)&&!0===this.options.includeMetadataChanges},Nh.prototype.Al=function(t){t=ys.os(t.query,t.docs,t.ns,t.fromCache),this.El=!0,this.Tl.next(t)},Nh),wh=(Ah.prototype.mh=function(t){this.Vl=t},Ah.prototype.Bn=function(e,i,r,o){var s=this;return i.te()||r.isEqual(ki.min())?this.pl(e,i):this.Vl.qn(e,o).next(function(t){var n=s.yl(i,t);return(i.oe()||i.ae())&&s.wc(i.xt,n,o,r)?s.pl(e,i):(Cs()<=p.DEBUG&&qs("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),i.toString()),s.Vl.Bn(e,i,r).next(function(e){return n.forEach(function(t){e=e.me(t.key,t)}),e}))})},Ah.prototype.yl=function(n,t){var i=new ts(function(t,e){return n.se(t,e)});return t.forEach(function(t,e){e instanceof go&&n.matches(e)&&(i=i.add(e))}),i},Ah.prototype.wc=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.S(i))},Ah.prototype.pl=function(t,e){return Cs()<=p.DEBUG&&qs("IndexFreeQueryEngine","Using full collection scan to execute query:",e.toString()),this.Vl.Bn(t,e,ki.min())},Ah),bh=(Th.prototype.vl=function(t){return Js.resolve(0===this.Dn.length)},Th.prototype.bh=function(t,e,n,i){var r=this.gl;this.gl++,0<this.Dn.length&&this.Dn[this.Dn.length-1];var o=new Ks(r,e,n,i);this.Dn.push(o);for(var s=0,u=i;s<u.length;s++){var a=u[s];this.bl=this.bl.add(new ku(a.key,r)),this.Fn.Ir(t,a.key.path.O())}return Js.resolve(o)},Th.prototype.Lh=function(t,e){return Js.resolve(this.Sl(e))},Th.prototype.eo=function(t,e){var n=e+1,i=this.Cl(n),r=i<0?0:i;return Js.resolve(this.Dn.length>r?this.Dn[r]:null)},Th.prototype.kh=function(){return Js.resolve(0===this.Dn.length?-1:this.gl-1)},Th.prototype.Ph=function(t){return Js.resolve(this.Dn.slice())},Th.prototype.$n=function(t,e){var n=this,i=new ku(e,0),r=new ku(e,Number.POSITIVE_INFINITY),o=[];return this.bl.Ge([i,r],function(t){var e=n.Sl(t.po);o.push(e)}),Js.resolve(o)},Th.prototype.xn=function(t,e){var i=this,r=new ts(Hs);return e.forEach(function(t){var e=new ku(t,0),n=new ku(t,Number.POSITIVE_INFINITY);i.bl.Ge([e,n],function(t){r=r.add(t.po)})}),Js.resolve(this.Dl(r))},Th.prototype.Gn=function(t,e){var n=e.path,i=n.length+1,r=n;Qi.et(r)||(r=r.child(""));var o=new ku(new Qi(r),0),s=new ts(Hs);return this.bl.He(function(t){var e=t.key.path;return!!n.B(e)&&(e.length===i&&(s=s.add(t.po)),!0)},o),Js.resolve(this.Dl(s))},Th.prototype.Dl=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.Sl(t);null!==e&&i.push(e)}),i},Th.prototype.Oh=function(n,i){var r=this;Bs(0===this.Fl(i.batchId,"removed")),this.Dn.shift();var o=this.bl;return Js.forEach(i.mutations,function(t){var e=new ku(t.key,i.batchId);return o=o.delete(e),r.Kh.Nl(n,t.key)}).next(function(){r.bl=o})},Th.prototype.$l=function(t){},Th.prototype.Vo=function(t,e){var n=new ku(e,0),i=this.bl.Ke(n);return Js.resolve(e.isEqual(i&&i.key))},Th.prototype.Nh=function(t){return this.Dn.length,Js.resolve()},Th.prototype.Fl=function(t,e){return this.Cl(t)},Th.prototype.Cl=function(t){return 0===this.Dn.length?0:t-this.Dn[0].batchId},Th.prototype.Sl=function(t){var e=this.Cl(t);return e<0||e>=this.Dn.length?null:this.Dn[e]},Th),Eh=(Ih.prototype.Gh=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.Ll(e);return this.docs=this.docs.me(i,{Ol:e,size:s,readTime:n}),this.size+=s-o,this.Fn.Ir(t,i.path.O())},Ih.prototype.jh=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Ih.prototype.On=function(t,e){var n=this.docs.get(e);return Js.resolve(n?n.Ol:null)},Ih.prototype.getEntries=function(t,e){var n=this,i=ns;return e.forEach(function(t){var e=n.docs.get(t);i=i.me(t,e?e.Ol:null)}),Js.resolve(i)},Ih.prototype.Bn=function(t,e,n){for(var i=os,r=new Qi(e.path.child("")),o=this.docs.ve(r);o.$e();){var s=o.Ne(),u=s.key,a=s.value,h=a.Ol,c=a.readTime;if(!e.path.B(u.path))break;c.S(n)<=0||h instanceof go&&e.matches(h)&&(i=i.me(h.key,h))}return Js.resolve(i)},Ih.prototype.kl=function(t,e){return Js.forEach(this.docs,function(t){return e(t)})},Ih.prototype.Ch=function(t){return new Ih.ql(this)},Ih.prototype.Ml=function(t){return Js.resolve(this.size)},Ih);function Ih(t,e){this.Fn=t,this.Ll=e,this.docs=new Qo(Qi.N),this.size=0}function Th(t,e){this.Fn=t,this.Kh=e,this.Dn=[],this.gl=1,this.bl=new ts(ku.do)}function Ah(){}function Nh(t,e,n){this.query=t,this.Tl=e,this.El=!1,this.Il=null,this.onlineState="Unknown",this.options=n||{}}function _h(t){this.Su=t,this.cl=new Xs(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.ll=new Set,this.Su.subscribe(this)}function Dh(t,e,n,i,r,o){this.eu=t,this.Dc=e,this.ka=n,this.Fc=i,this.currentUser=r,this.Nc=o,this.$c=null,this.Lc=new Xs(function(t){return t.canonicalId()}),this.Oc=new Map,this.kc=[],this.qc=new Qo(Qi.N),this.Mc=new Map,this.xc=new Ou,this.Bc={},this.Uc=new Map,this.Qc=du.Ar(),this.onlineState="Unknown"}function Sh(t,e,n,i){this.Pr=t,this.ka=e,this.updateFunction=n,this.yr=i,this.pc=5,this.kr=new fu(this.Pr,"transaction_retry")}function Rh(t,e){this.query=t,this.oc=e,this.ac=null,this.ds=!1,this.uc=as(),this.ns=as(),this.cc=new ps(t.se.bind(t))}function Oh(){this.zu=new lh,this.Yu={},this.Su=null,this.Ga=null,this.Xn=null}function kh(){this.activeTargetIds=hs}function Ph(t,e,n,i,r){var o,s,u,a,h,c,f=this;this.eu=t,this.ka=e,this.Pr=n,this.su=[],this.iu=new Map,this.nu=null,this.networkEnabled=!1,this.isPrimary=!1,this.ru=!1,this.hu=r,this.hu.ou(function(t){n.Sr(function(){return l(f,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.au()?(qs("RemoteStore","Restarting streams for network reachability change."),[4,this.uu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.cu=new ch(n,i),this.lu=(a=this.ka,h=n,c={Aa:this._u.bind(this),Ta:this.fu.bind(this),Va:this.du.bind(this)},new sh(h,a.ia,a.credentials,a.serializer,c)),this.wu=(o=this.ka,s=n,u={Aa:this.Tu.bind(this),Ta:this.Eu.bind(this),Ca:this.Iu.bind(this),Sa:this.Sa.bind(this)},new uh(s,o.ia,o.credentials,o.serializer,u))}function Lh(t,e){this.Pr=t,this.Ga=e,this.state="Unknown",this.Ha=0,this.Ka=null,this.za=!0}function Uh(t){this.ka=t,this.qa=new Map,this.mutations=[],this.Ma=!1,this.xa=null,this.Ba=new Set}function Vh(t,e,n){var i=this;return(i=eh.call(this)||this).ia=t,i.credentials=e,i.serializer=n,i.Na=!1,i}function Mh(t,e,n,i,r){var o=this;return(o=nh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.ga=!1,o.lastStreamToken=Ji.ht,o}function Ch(t,e,n,i,r){var o=this;return(o=ih.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function qh(t,e,n,i,r,o){this.sr=t,this.sa=n,this.ia=i,this.na=r,this.listener=o,this.state=0,this.ra=0,this.ha=null,this.stream=null,this.kr=new fu(t,e)}function xh(t){var e=this;return(e=rh.call(this)||this).jl=t,e}function jh(){this.vh=new Xs(function(t){return t.toString()}),this.xl=!1}Eh.ql=(Object.defineProperty(jh.prototype,"readTime",{get:function(){return this.Bl},set:function(t){this.Bl=t},enumerable:!0,configurable:!0}),jh.prototype.Gh=function(t,e){this.Ul(),this.readTime=e,this.vh.set(t.key,t)},jh.prototype.jh=function(t,e){this.Ul(),e&&(this.readTime=e),this.vh.set(t,null)},jh.prototype.On=function(t,e){this.Ul();var n=this.vh.get(e);return void 0!==n?Js.resolve(n):this.Ql(t,e)},jh.prototype.getEntries=function(t,e){return this.Wl(t,e)},jh.prototype.apply=function(t){return this.Ul(),this.xl=!0,this.Tc(t)},jh.prototype.Ul=function(){},n(xh,rh=jh),xh.prototype.Tc=function(n){var i=this,r=[];return this.vh.forEach(function(t,e){e?r.push(i.jl.Gh(n,e,i.readTime)):i.jl.jh(t)}),Js.vn(r)},xh.prototype.Ql=function(t,e){return this.jl.On(t,e)},xh.prototype.Wl=function(t,e){return this.jl.getEntries(t,e)},xh);var Fh,Bh=(ic.prototype.js=function(t,n){return this.Gl.forEach(function(t,e){return n(e)}),Js.resolve()},ic.prototype.qh=function(t){return Js.resolve(this.lastRemoteSnapshotVersion)},ic.prototype.Yl=function(t){return Js.resolve(this.Hl)},ic.prototype.ro=function(t){return this.highestTargetId=this.zl.next(),Js.resolve(this.highestTargetId)},ic.prototype.zh=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hl&&(this.Hl=e),Js.resolve()},ic.prototype.Xl=function(t){this.Gl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.zl=new du(e),this.highestTargetId=e),t.sequenceNumber>this.Hl&&(this.Hl=t.sequenceNumber)},ic.prototype.ho=function(t,e){return this.Xl(e),this.targetCount+=1,Js.resolve()},ic.prototype.Wh=function(t,e){return this.Xl(e),Js.resolve()},ic.prototype.Jl=function(t,e){return this.Gl.delete(e.target),this.Kl.mo(e.targetId),--this.targetCount,Js.resolve()},ic.prototype.Zl=function(n,i,r){var o=this,s=0,u=[];return this.Gl.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.Gl.delete(t),u.push(o.t_(n,e.targetId)),s++)}),Js.vn(u).next(function(){return s})},ic.prototype.e_=function(t){return Js.resolve(this.targetCount)},ic.prototype.no=function(t,e){var n=this.Gl.get(e)||null;return Js.resolve(n)},ic.prototype.Bh=function(t,e,n){return this.Kl.Eo(e,n),Js.resolve()},ic.prototype.xh=function(e,t,n){this.Kl.Ro(t,n);var i=this.persistence.Kh,r=[];return i&&t.forEach(function(t){r.push(i.Nl(e,t))}),Js.vn(r)},ic.prototype.t_=function(t,e){return this.Kl.mo(e),Js.resolve()},ic.prototype.uo=function(t,e){var n=this.Kl.Po(e);return Js.resolve(n)},ic.prototype.Vo=function(t,e){return Js.resolve(this.Kl.Vo(e))},ic),Gh=(nc.prototype.start=function(){return Promise.resolve()},nc.prototype.yu=function(){return this.n_=!1,Promise.resolve()},Object.defineProperty(nc.prototype,"h_",{get:function(){return this.n_},enumerable:!0,configurable:!0}),nc.prototype.o_=function(){},nc.prototype.Rh=function(){return this.Fn},nc.prototype.fh=function(t){var e=this.s_[t.s()];return e||(e=new bh(this.Fn,this.Kh),this.s_[t.s()]=e),e},nc.prototype.Eh=function(){return this.Th},nc.prototype.wh=function(){return this.Cn},nc.prototype.runTransaction=function(t,e,n){var i=this;qs("MemoryPersistence","Starting transaction:",t);var r=new zh(this.i_.next());return this.Kh.a_(),n(r).next(function(t){return i.Kh.u_(r).next(function(){return t})}).gn().then(function(t){return r.c_(),t})},nc.prototype.l_=function(e,n){return Js.Sn(Object.values(this.s_).map(function(t){return function(){return t.Vo(e,n)}}))},nc),zh=(ec.prototype.f_=function(t){this.__.push(t)},ec.prototype.c_=function(){this.__.forEach(function(t){return t()})},n(tc,Fh=ec),tc),Hh=(Zh.T_=function(t){return new Zh(t)},Object.defineProperty(Zh.prototype,"E_",{get:function(){if(this.w_)return this.w_;throw Fs()},enumerable:!0,configurable:!0}),Zh.prototype.Jh=function(t,e,n){return this.d_.Jh(n,e),this.E_.delete(n),Js.resolve()},Zh.prototype.Zh=function(t,e,n){return this.d_.Zh(n,e),this.E_.add(n),Js.resolve()},Zh.prototype.Nl=function(t,e){return this.E_.add(e),Js.resolve()},Zh.prototype.removeTarget=function(t,e){var n=this;this.d_.mo(e.targetId).forEach(function(t){return n.E_.add(t)});var i=this.persistence.Eh();return i.uo(t,e.targetId).next(function(t){t.forEach(function(t){return n.E_.add(t)})}).next(function(){return i.Jl(t,e)})},Zh.prototype.a_=function(){this.w_=new Set},Zh.prototype.u_=function(t){var n=this,i=this.persistence.wh().Ch();return Js.forEach(this.E_,function(e){return n.I_(t,e).next(function(t){t||i.jh(e)})}).next(function(){return n.w_=null,i.apply(t)})},Zh.prototype.Hh=function(t,e){var n=this;return this.I_(t,e).next(function(t){t?n.E_.delete(e):n.E_.add(e)})},Zh.prototype.r_=function(t){return 0},Zh.prototype.I_=function(t,e){var n=this;return Js.Sn([function(){return Js.resolve(n.d_.Vo(e))},function(){return n.persistence.Eh().Vo(t,e)},function(){return n.persistence.l_(t,e)}])},Zh),Wh="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Qh=(Jh.prototype.initialize=function(n){return l(this,void 0,void 0,function(){var e=this;return d(this,function(t){switch(t.label){case 0:return this.Fc=this.R_(n),this.persistence=this.m_(n),[4,this.persistence.start()];case 1:return t.sent(),this.A_=this.P_(n),this.eu=this.V_(n),this.Dc=this.p_(n),this.Su=this.y_(n),this.g_=this.b_(n),this.Fc.Ga=function(t){return e.Su.mc(t,1)},this.Dc.Su=this.Su,[4,this.eu.start()];case 2:return t.sent(),[4,this.Fc.start()];case 3:return t.sent(),[4,this.Dc.start()];case 4:return t.sent(),[4,this.Dc.ju(this.Su.Wc)];case 5:return t.sent(),[2]}})})},Jh.prototype.b_=function(t){return new gh(this.Su)},Jh.prototype.P_=function(t){return null},Jh.prototype.V_=function(t){return new Du(this.persistence,new wh,t.v_)},Jh.prototype.m_=function(t){if(t.C_.S_)throw new Ni(Ai.FAILED_PRECONDITION,Wh);return new Gh(Hh.T_)},Jh.prototype.p_=function(t){var e=this;return new fh(this.eu,t.ka,t.Pr,function(t){return e.Su.mc(t,0)},t.platform.D_())},Jh.prototype.R_=function(t){return new ph},Jh.prototype.y_=function(t){return new vh(this.eu,this.Dc,t.ka,this.Fc,t.v_,t.Nc)},Jh.prototype.clearPersistence=function(t){throw new Ni(Ai.FAILED_PRECONDITION,Wh)},Jh),Yh=($h.prototype.start=function(e,n){var i=this;this.$a();var r=new cu,o=new cu,s=!1;return this.credentials._(function(t){return s?void i.Pr.jr(function(){return i.Wu(t)}):(s=!0,qs("FirestoreClient","Initializing. user=",t.uid),i.N_(e,n,t,o).then(r.resolve,r.reject))}),this.Pr.Sr(function(){return r.promise}),o.promise},$h.prototype.enableNetwork=function(){var t=this;return this.$a(),this.Pr.enqueue(function(){return t.Su.enableNetwork()})},$h.prototype.N_=function(u,a,h,c){return l(this,void 0,void 0,function(){var n,i,r,o,s=this;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.platform.L_(this.F_)];case 1:return n=t.sent(),i=this.platform.Yo(this.F_.ii),e=this.credentials,r=new ah(n,e,i),[4,u.initialize({Pr:this.Pr,F_:this.F_,platform:this.platform,ka:r,clientId:this.clientId,v_:h,Nc:100,C_:a})];case 2:return t.sent(),this.persistence=u.persistence,this.Fc=u.Fc,this.eu=u.eu,this.Dc=u.Dc,this.Su=u.Su,this.A_=u.A_,this.O_=u.g_,this.persistence.o_(function(){return l(s,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),c.resolve(),[3,4];case 3:if(o=t.sent(),c.reject(o),!this.k_(o))throw o;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+o),this.N_(new Qh,{S_:!1},h,c))];case 4:return[2]}var e})})},$h.prototype.k_=function(t){return"FirebaseError"===t.name?t.code===Ai.FAILED_PRECONDITION||t.code===Ai.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},$h.prototype.$a=function(){if(this.Pr.Mr)throw new Ni(Ai.FAILED_PRECONDITION,"The client has already been terminated.")},$h.prototype.Wu=function(t){return this.Pr.Hr(),qs("FirestoreClient","Credential Changed. Current user: "+t.uid),this.Su.Wu(t)},$h.prototype.disableNetwork=function(){var t=this;return this.$a(),this.Pr.enqueue(function(){return t.Su.disableNetwork()})},$h.prototype.terminate=function(){var t=this;return this.Pr.Wr(function(){return l(t,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.A_&&this.A_.stop(),[4,this.Dc.yu()];case 1:return t.sent(),[4,this.Fc.yu()];case 2:return t.sent(),[4,this.persistence.yu()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},$h.prototype.waitForPendingWrites=function(){var t=this;this.$a();var e=new cu;return this.Pr.Sr(function(){return t.Su.el(e)}),e.promise},$h.prototype.listen=function(t,e,n){var i=this;this.$a();var r=new mh(t,e,n);return this.Pr.Sr(function(){return i.O_.listen(r)}),r},$h.prototype.bu=function(t){var e=this;this.q_||this.Pr.Sr(function(){return e.O_.bu(t)})},$h.prototype.M_=function(o){return l(this,void 0,void 0,function(){var r,e=this;return d(this,function(t){switch(t.label){case 0:return this.$a(),r=new cu,[4,this.Pr.enqueue(function(){return l(e,void 0,void 0,function(){var e,n,i;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.eu.so(o)];case 1:return(e=t.sent())instanceof go?r.resolve(e):e instanceof mo?r.resolve(null):r.reject(new Ni(Ai.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),i=Au(n,"Failed to get document '"+o+" from cache"),r.reject(i),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),r.promise)]}})})},$h.prototype.x_=function(a){return l(this,void 0,void 0,function(){var u,e=this;return d(this,function(t){switch(t.label){case 0:return this.$a(),u=new cu,[4,this.Pr.enqueue(function(){return l(e,void 0,void 0,function(){var e,n,i,r,o,s;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.eu.ao(a,!0)];case 1:return e=t.sent(),n=new dh(a,e.co),i=n._c(e.documents),r=n.Tc(i,!1),u.resolve(r.snapshot),[3,3];case 2:return o=t.sent(),s=Au(o,"Failed to execute query '"+a+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})},$h.prototype.write=function(t){var e=this;this.$a();var n=new cu;return this.Pr.Sr(function(){return e.Su.write(t,n)}),n.promise},$h.prototype.ii=function(){return this.F_.ii},$h.prototype.dl=function(t){var e=this;this.$a(),this.Pr.Sr(function(){return e.O_.dl(t),Promise.resolve()})},$h.prototype.wl=function(t){var e=this;this.q_||this.Pr.Sr(function(){return e.O_.wl(t),Promise.resolve()})},Object.defineProperty($h.prototype,"q_",{get:function(){return this.Pr.Mr},enumerable:!0,configurable:!0}),$h.prototype.transaction=function(t){var e=this;this.$a();var n=new cu;return this.Pr.Sr(function(){return e.Su.runTransaction(e.Pr,t,n),Promise.resolve()}),n.promise},$h),Xh=(Kh.prototype.next=function(t){this.B_(this.observer.next,t)},Kh.prototype.error=function(t){this.B_(this.observer.error,t)},Kh.prototype.U_=function(){this.muted=!0},Kh.prototype.B_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Kh);function Kh(t){this.observer=t,this.muted=!1}function $h(t,e,n,i){this.platform=t,this.F_=e,this.credentials=n,this.Pr=i,this.clientId=Gs.cn()}function Jh(){}function Zh(t){this.persistence=t,this.d_=new Ou,this.w_=null}function tc(t){var e=this;return(e=Fh.call(this)||this).Uh=t,e}function ec(){this.__=[]}function nc(t){var e=this;this.s_={},this.i_=new eu(0),this.n_=!1,this.n_=!0,this.Kh=t(this),this.Th=new Bh(this),this.Fn=new lu,this.Cn=new Eh(this.Fn,function(t){return e.Kh.r_(t)})}function ic(t){this.persistence=t,this.Gl=new Xs(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=ki.min(),this.highestTargetId=0,this.Hl=0,this.Kl=new Ou,this.targetCount=0,this.zl=du.mr()}function rc(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var oc,sc,uc,ac,hc=(Uc.prototype.j_=function(t){switch(or(t)){case 0:return null;case 1:return t.booleanValue;case 2:return lr(t.integerValue||t.doubleValue);case 3:return this.G_(t.timestampValue);case 4:return this.H_(t);case 5:return t.stringValue;case 6:return new ia(pr(t.bytesValue));case 7:return this.K_(t.referenceValue);case 8:return this.z_(t.geoPointValue);case 9:return this.Y_(t.arrayValue);case 10:return this.X_(t.mapValue);default:throw Fs()}},Uc.prototype.X_=function(t){var n=this,i={};return Ki(t.fields||{},function(t,e){i[t]=n.j_(e)}),i},Uc.prototype.z_=function(t){return new Ta(lr(t.latitude),lr(t.longitude))},Uc.prototype.Y_=function(t){var e=this;return(t.values||[]).map(function(t){return e.j_(t)})},Uc.prototype.H_=function(t){switch(this.Q_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return nr(n)?t(n):n}(t);return null==e?null:this.j_(e);case"estimate":return this.G_(ir(t));default:return null}},Uc.prototype.G_=function(t){var e=fr(t),n=new Oi(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Uc.prototype.K_=function(t){var e=Li.G(t);Bs(Ls(e));var n=new Ys(e.get(1),e.get(3)),i=new Qi(e.L(5));return n.isEqual(this.ii)||xs("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.ii.projectId+"/"+this.ii.database+") instead."),this.W_(i)},Uc),cc=Nu.nh,fc=(Lc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Lc),lc=(Object.defineProperty(Pc.prototype,"af",{get:function(){return this.uf||(this.uf=new ja(this.xo,this.hf.ignoreUndefinedProperties)),this.uf},enumerable:!0,configurable:!0}),Pc.prototype.settings=function(t){Vu("Firestore.settings",arguments,1),qu("Firestore.settings","object",1,t);var e=new fc(t);if(this.ef&&!this.hf.isEqual(e))throw new Ni(Ai.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.hf=e).credentials&&(this.nf=function(t){if(!t)return new _i;switch(t.type){case"gapi":var e=t.cf;return Bs(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ri(e,t.V||"0");case"provider":return t.cf;default:throw new Ni(Ai.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Pc.prototype.enableNetwork=function(){return this.tf(),this.ef.enableNetwork()},Pc.prototype.disableNetwork=function(){return this.tf(),this.ef.disableNetwork()},Pc.prototype.enablePersistence=function(t){var e,n;if(this.ef)throw new Ni(Ai.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&xs("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,i&&r))throw new Ni(Ai.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.lf(this.rf,{S_:!0,cacheSizeBytes:this.hf.cacheSizeBytes,synchronizeTabs:i,_f:r})},Pc.prototype.clearPersistence=function(){return l(this,void 0,void 0,function(){var i,e=this;return d(this,function(t){if(void 0!==this.ef&&!this.ef.q_)throw new Ni(Ai.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return i=new cu,[2,(this.Z_.xr(function(){return l(e,void 0,void 0,function(){var e,n;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.ff(),[4,this.rf.clearPersistence(e)];case 1:return t.sent(),i.resolve(),[3,3];case 2:return n=t.sent(),i.reject(n),[3,3];case 3:return[2]}})})}),i.promise)]})})},Pc.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Pc.prototype,"df",{get:function(){return this.tf(),this.ef.q_},enumerable:!0,configurable:!0}),Pc.prototype.waitForPendingWrites=function(){return this.tf(),this.ef.waitForPendingWrites()},Pc.prototype.onSnapshotsInSync=function(t){if(this.tf(),rc(t))return this.wf(t);qu("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.wf(e)},Pc.prototype.wf=function(t){var e=this,n=new Xh({next:function(){t.next&&t.next()},error:function(t){throw Fs()}});return this.ef.dl(n),function(){n.U_(),e.ef.wl(n)}},Pc.prototype.tf=function(){return this.ef||this.lf(new Qh,{S_:!1}),this.ef},Pc.prototype.ff=function(){return new Qs(this.xo,this.if,this.hf.host,this.hf.ssl,this.hf.forceLongPolling)},Pc.prototype.lf=function(t,e){var n=this.ff();return this.ef=new Yh(Us.nt(),n,this.nf,this.Z_),this.ef.start(t,e)},Pc.sf=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Ni(Ai.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Ni(Ai.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ys(n)},Object.defineProperty(Pc.prototype,"app",{get:function(){if(!this.J_)throw new Ni(Ai.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.J_},enumerable:!0,configurable:!0}),Pc.prototype.collection=function(t){return Vu("Firestore.collection",arguments,1),qu("Firestore.collection","non-empty string",1,t),this.tf(),new Ec(Li.G(t),this,null)},Pc.prototype.doc=function(t){return Vu("Firestore.doc",arguments,1),qu("Firestore.doc","non-empty string",1,t),this.tf(),yc.Tf(Li.G(t),this,null)},Pc.prototype.collectionGroup=function(t){if(Vu("Firestore.collectionGroup",arguments,1),qu("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.tf(),new wc(new Eo(Li.H,t),this,null)},Pc.prototype.runTransaction=function(e){var n=this;return Vu("Firestore.runTransaction",arguments,1),qu("Firestore.runTransaction","function",1,e),this.tf().transaction(function(t){return e(new pc(n,t))})},Pc.prototype.batch=function(){return this.tf(),new dc(this)},Object.defineProperty(Pc,"logLevel",{get:function(){switch(Cs()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!0,configurable:!0}),Pc.setLogLevel=function(t){Vu("Firestore.setLogLevel",arguments,1),Gu("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Vs.setLogLevel(t)},Pc.prototype.Ef=function(){return this.hf.timestampsInSnapshots},Pc),pc=(kc.prototype.get=function(t){var n=this;Vu("Transaction.get",arguments,1);var i=qc("Transaction.get",t,this.If);return this.Rf.Ua([i.Bo]).then(function(t){if(!t||1!==t.length)return Fs();var e=t[0];if(e instanceof mo)return new gc(n.If,i.Bo,null,!1,!1,i.Uo);if(e instanceof go)return new gc(n.If,i.Bo,e,!1,!1,i.Uo);throw Fs()})},kc.prototype.set=function(t,e,n){Cu("Transaction.set",arguments,2,3);var i=qc("Transaction.set",t,this.If);n=Vc("Transaction.set",n);var r=xc(i.Uo,e,"Transaction.set"),o=r[0],s=r[1],u=this.If.af.Xo(s,o,n);return this.Rf.set(i.Bo,u),this},kc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof ra?(Mu("Transaction.update",arguments,3),i=qc("Transaction.update",t,this.If),this.If.af.ta("Transaction.update",e,n,o)):(Vu("Transaction.update",arguments,2),i=qc("Transaction.update",t,this.If),this.If.af.Zo("Transaction.update",e)),this.Rf.update(i.Bo,r),this},kc.prototype.delete=function(t){Vu("Transaction.delete",arguments,1);var e=qc("Transaction.delete",t,this.If);return this.Rf.delete(e.Bo),this},kc),dc=(Oc.prototype.set=function(t,e,n){Cu("WriteBatch.set",arguments,2,3),this.Pf();var i=qc("WriteBatch.set",t,this.If);n=Vc("WriteBatch.set",n);var r=xc(i.Uo,e,"WriteBatch.set"),o=r[0],s=r[1],u=this.If.af.Xo(s,o,n);return this.mf=this.mf.concat(u.Qo(i.Bo,Cr.dt())),this},Oc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Pf(),r="string"==typeof e||e instanceof ra?(Mu("WriteBatch.update",arguments,3),i=qc("WriteBatch.update",t,this.If),this.If.af.ta("WriteBatch.update",e,n,o)):(Vu("WriteBatch.update",arguments,2),i=qc("WriteBatch.update",t,this.If),this.If.af.Zo("WriteBatch.update",e)),this.mf=this.mf.concat(r.Qo(i.Bo,Cr.exists(!0))),this},Oc.prototype.delete=function(t){Vu("WriteBatch.delete",arguments,1),this.Pf();var e=qc("WriteBatch.delete",t,this.If);return this.mf=this.mf.concat(new Br(e.Bo,Cr.dt())),this},Oc.prototype.commit=function(){return this.Pf(),this.Af=!0,0<this.mf.length?this.If.tf().write(this.mf):Promise.resolve()},Oc.prototype.Pf=function(){if(this.Af)throw new Ni(Ai.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Oc),yc=(n(Rc,ac=Na),Rc.Tf=function(t,e,n){if(t.length%2!=0)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.j()+" has "+t.length);return new Rc(new Qi(t),e,n)},Object.defineProperty(Rc.prototype,"id",{get:function(){return this.Bo.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(Rc.prototype,"parent",{get:function(){return new Ec(this.Bo.path.O(),this.firestore,this.Uo)},enumerable:!0,configurable:!0}),Object.defineProperty(Rc.prototype,"path",{get:function(){return this.Bo.path.j()},enumerable:!0,configurable:!0}),Rc.prototype.collection=function(t){if(Vu("DocumentReference.collection",arguments,1),qu("DocumentReference.collection","non-empty string",1,t),!t)throw new Ni(Ai.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Li.G(t);return new Ec(this.Bo.path.child(e),this.firestore,null)},Rc.prototype.isEqual=function(t){if(!(t instanceof Rc))throw Xu("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Bo.isEqual(t.Bo)&&this.Uo===t.Uo},Rc.prototype.set=function(t,e){Cu("DocumentReference.set",arguments,1,2),e=Vc("DocumentReference.set",e);var n=xc(this.Uo,t,"DocumentReference.set"),i=n[0],r=n[1],o=this.firestore.af.Xo(r,i,e);return this.ef.write(o.Qo(this.Bo,Cr.dt()))},Rc.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof ra?(Mu("DocumentReference.update",arguments,2),this.firestore.af.ta("DocumentReference.update",t,e,i)):(Vu("DocumentReference.update",arguments,1),this.firestore.af.Zo("DocumentReference.update",t)),this.ef.write(n.Qo(this.Bo,Cr.exists(!0)))},Rc.prototype.delete=function(){return Vu("DocumentReference.delete",arguments,0),this.ef.write([new Br(this.Bo,Cr.dt())])},Rc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Cu("DocumentReference.onSnapshot",arguments,1,4);var n={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||rc(t[i])||(Yu("DocumentReference.onSnapshot",n=t[i],["includeMetadataChanges"]),Fu("DocumentReference.onSnapshot","boolean","includeMetadataChanges",n.includeMetadataChanges),i++);var r={includeMetadataChanges:n.includeMetadataChanges},o=rc(t[i])?t[i]:(qu("DocumentReference.onSnapshot","function",i,t[i]),xu("DocumentReference.onSnapshot","function",i+1,t[i+1]),xu("DocumentReference.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]});return this.Vf(r,o)},Rc.prototype.Vf=function(t,n){var i=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var r=new Xh({next:function(t){var e;n.next&&(e=t.docs.get(i.Bo),n.next(new gc(i.firestore,i.Bo,e,t.fromCache,t.hasPendingWrites,i.Uo)))},error:e}),o=this.ef.listen(Eo.Wt(this.Bo.path),r,t);return function(){r.U_(),i.ef.bu(o)}},Rc.prototype.get=function(n){var i=this;return Cu("DocumentReference.get",arguments,0,1),Cc("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.tf().M_(i.Bo).then(function(t){e(new gc(i.firestore,i.Bo,t,!0,t instanceof go&&t.At,i.Uo))},t):i.pf(e,t,n)})},Rc.prototype.pf=function(e,n,i){var r=this.Vf({includeMetadataChanges:!0,Pl:!0},{next:function(t){r(),!t.exists&&t.metadata.fromCache?n(new Ni(Ai.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&i&&"server"===i.source?n(new Ni(Ai.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},Rc.prototype.withConverter=function(t){return new Rc(this.Bo,this.firestore,t)},Rc),vc=(Sc.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Sc),gc=(Dc.prototype.data=function(t){var e=this;if(Cu("DocumentSnapshot.data",arguments,0,1),t=Mc("DocumentSnapshot.data",t),this.yf){if(this.Uo){var n=new mc(this.If,this.Bo,this.yf,this.gf,this.bf,null);return this.Uo.fromFirestore(n,t)}return new hc(this.If.xo,this.If.Ef(),t.serverTimestamps||"none",function(t){return new yc(t,e.If,null)}).j_(this.yf.Ot())}},Dc.prototype.get=function(t,e){var n=this;if(Cu("DocumentSnapshot.get",arguments,1,2),e=Mc("DocumentSnapshot.get",e),this.yf){var i=this.yf.data().field(Qa("DocumentSnapshot.get",t));if(null!==i)return new hc(this.If.xo,this.If.Ef(),e.serverTimestamps||"none",function(t){return new yc(t,n.If,n.Uo)}).j_(i)}},Object.defineProperty(Dc.prototype,"id",{get:function(){return this.Bo.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(Dc.prototype,"ref",{get:function(){return new yc(this.Bo,this.If,this.Uo)},enumerable:!0,configurable:!0}),Object.defineProperty(Dc.prototype,"exists",{get:function(){return null!==this.yf},enumerable:!0,configurable:!0}),Object.defineProperty(Dc.prototype,"metadata",{get:function(){return new vc(this.bf,this.gf)},enumerable:!0,configurable:!0}),Dc.prototype.isEqual=function(t){if(!(t instanceof Dc))throw Xu("isEqual","DocumentSnapshot",1,t);return this.If===t.If&&this.gf===t.gf&&this.Bo.isEqual(t.Bo)&&(null===this.yf?null===t.yf:this.yf.isEqual(t.yf))&&this.Uo===t.Uo},Dc),mc=(n(_c,uc=gc),_c.prototype.data=function(t){return uc.prototype.data.call(this,t)},_c),wc=(Nc.prototype.Sf=function(t,e,n){var i;if(t.Y()){if("array-contains"===e||"array-contains-any"===e)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+e+"' queries on FieldPath.documentId().");if("in"===e){this.Cf(n,e);for(var r=[],o=0,s=n;o<s.length;o++){var u=s[o];r.push(this.Df(u))}i={arrayValue:{values:r}}}else i=this.Df(n)}else"in"!==e&&"array-contains-any"!==e||this.Cf(n,e),i=this.af.ea("Query.where",n,"in"===e);var a=Io.create(t,e,i);return this.Ff(a),a},Nc.prototype.Nf=function(t,e){if(null!==this.vf.startAt)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.vf.endAt)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var n=new Ro(t,e);return this.$f(n),n},Nc.prototype.Lf=function(t,e,n){if(!e)throw new Ni(Ai.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");for(var i=[],r=0,o=this.vf.orderBy;r<o.length;r++){var s=o[r];if(s.field.Y())i.push(dr(this.xo,e.key));else{var u=e.field(s.field);if(nr(u))throw new Ni(Ai.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var a=s.field.j();throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+a+"' (used as the orderBy) does not exist.")}i.push(u)}}return new So(i,n)},Nc.prototype.Of=function(t,e,n){var i=this.vf.Mt;if(e.length>i.length)throw new Ni(Ai.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var r=[],o=0;o<e.length;o++){var s=e[o];if(i[o].field.Y()){if("string"!=typeof s)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.vf.le()&&-1!==s.indexOf("/"))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.vf.path.child(Li.G(s));if(!Qi.et(u))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new Qi(u);r.push(dr(this.xo,a))}else{var h=this.af.ea(t,s);r.push(h)}}return new So(r,n)},Nc.prototype.kf=function(t){if(t.ae()&&0===t.Mt.length)throw new Ni(Ai.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},Nc.prototype.Df=function(t){if("string"==typeof t){if(""===t)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.vf.le()&&-1!==t.indexOf("/"))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.vf.path.child(Li.G(t));if(!Qi.et(e))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return dr(this.xo,new Qi(e))}if(t instanceof Na)return dr(this.xo,t.Bo);throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Wu(t)+".")},Nc.prototype.Cf=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},Nc.prototype.Ff=function(t){if(t instanceof Io){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],i=0<=e.indexOf(t.op),r=0<=n.indexOf(t.op);if(t.ue()){var o=this.vf.jt();if(null!==o&&!o.isEqual(t.field))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.vf.Gt();null!==s&&this.qf(t.field,s)}else if(r||i){var u=null;if(r&&(u=this.vf.ce(n)),null===u&&i&&(u=this.vf.ce(e)),null!=u)throw u===t.op?new Ni(Ai.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Ni(Ai.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},Nc.prototype.$f=function(t){var e;null!==this.vf.Gt()||null!==(e=this.vf.jt())&&this.qf(e,t.field)},Nc.prototype.qf=function(t,e){if(!e.isEqual(t))throw new Ni(Ai.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},n(Ac,sc=Nc),Ac.prototype.where=function(t,e,n){Vu("Query.where",arguments,3),Qu("Query.where",3,n);var i=Gu("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),r=Qa("Query.where",t),o=this.Sf(r,i,n);return new Ac(this.vf.Ht(o),this.firestore,this.Uo)},Ac.prototype.orderBy=function(t,e){var n;if(Cu("Query.orderBy",arguments,1,2),xu("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Ni(Ai.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var i=Qa("Query.orderBy",t),r=this.Nf(i,n);return new Ac(this.vf.Kt(r),this.firestore,this.Uo)},Ac.prototype.limit=function(t){return Vu("Query.limit",arguments,1),qu("Query.limit","number",1,t),Ku("Query.limit",1,t),new Ac(this.vf.zt(t),this.firestore,this.Uo)},Ac.prototype.limitToLast=function(t){return Vu("Query.limitToLast",arguments,1),qu("Query.limitToLast","number",1,t),Ku("Query.limitToLast",1,t),new Ac(this.vf.Yt(t),this.firestore,this.Uo)},Ac.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Mu("Query.startAt",arguments,1);var i=this.Mf("Query.startAt",t,e,!0);return new Ac(this.vf.Xt(i),this.firestore,this.Uo)},Ac.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Mu("Query.startAfter",arguments,1);var i=this.Mf("Query.startAfter",t,e,!1);return new Ac(this.vf.Xt(i),this.firestore,this.Uo)},Ac.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Mu("Query.endBefore",arguments,1);var i=this.Mf("Query.endBefore",t,e,!0);return new Ac(this.vf.Jt(i),this.firestore,this.Uo)},Ac.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Mu("Query.endAt",arguments,1);var i=this.Mf("Query.endAt",t,e,!1);return new Ac(this.vf.Jt(i),this.firestore,this.Uo)},Ac.prototype.isEqual=function(t){if(!(t instanceof Ac))throw Xu("isEqual","Query",1,t);return this.firestore===t.firestore&&this.vf.isEqual(t.vf)&&this.Uo===t.Uo},Ac.prototype.withConverter=function(t){return new Ac(this.vf,this.firestore,t)},Ac.prototype.Mf=function(t,e,n,i){if(Qu(t,1,e),e instanceof gc)return Vu(t,y([e],n),1),this.Lf(t,e.yf,i);var r=[e].concat(n);return this.Of(t,r,i)},Ac.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Cu("Query.onSnapshot",arguments,1,4);var n,i={},r=0;return"object"!=typeof t[r]||rc(t[r])||(Yu("Query.onSnapshot",i=t[r],["includeMetadataChanges"]),Fu("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++),n=rc(t[r])?t[r]:(qu("Query.onSnapshot","function",r,t[r]),xu("Query.onSnapshot","function",r+1,t[r+1]),xu("Query.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.kf(this.vf),this.Vf(i,n)},Ac.prototype.Vf=function(t,e){var n=this,i=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(i=e.error.bind(e));var r=new Xh({next:function(t){e.next&&e.next(new bc(n.firestore,n.vf,t,n.Uo))},error:i}),o=this.firestore.tf(),s=o.listen(this.vf,r,t);return function(){r.U_(),o.bu(s)}},Ac.prototype.get=function(n){var i=this;return Cu("Query.get",arguments,0,1),Cc("Query.get",n),this.kf(this.vf),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.tf().x_(i.vf).then(function(t){e(new bc(i.firestore,i.vf,t,i.Uo))},t):i.pf(e,t,n)})},Ac.prototype.pf=function(e,n,i){var r=this.Vf({includeMetadataChanges:!0,Pl:!0},{next:function(t){r(),t.metadata.fromCache&&i&&"server"===i.source?n(new Ni(Ai.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},Ac),bc=(Object.defineProperty(Tc.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(Tc.prototype,"empty",{get:function(){return this.Bf.docs.M()},enumerable:!0,configurable:!0}),Object.defineProperty(Tc.prototype,"size",{get:function(){return this.Bf.docs.size},enumerable:!0,configurable:!0}),Tc.prototype.forEach=function(e,n){var i=this;Cu("QuerySnapshot.forEach",arguments,1,2),qu("QuerySnapshot.forEach","function",1,e),this.Bf.docs.forEach(function(t){e.call(n,i.Wf(t))})},Object.defineProperty(Tc.prototype,"query",{get:function(){return new wc(this.xf,this.If,this.Uo)},enumerable:!0,configurable:!0}),Tc.prototype.docChanges=function(t){t&&(Yu("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Fu("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Bf.hs)throw new Ni(Ai.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Uf&&this.Qf===e||(this.Uf=function(r,e,o,s){if(o.ss.M()){var n=0;return o.docChanges.map(function(t){var e=new mc(r,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var u=o.ss;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new mc(r,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s),n=-1,i=-1;return 0!==t.type&&(n=u.indexOf(t.doc.key),u=u.delete(t.doc.key)),1!==t.type&&(i=(u=u.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Fs()}}(t.type),doc:e,oldIndex:n,newIndex:i}})}(this.If,e,this.Bf,this.Uo),this.Qf=e),this.Uf},Tc.prototype.isEqual=function(t){if(!(t instanceof Tc))throw Xu("isEqual","QuerySnapshot",1,t);return this.If===t.If&&this.xf.isEqual(t.xf)&&this.Bf.isEqual(t.Bf)&&this.Uo===t.Uo},Tc.prototype.Wf=function(t){return new mc(this.If,t.key,t,this.metadata.fromCache,this.Bf.ns.has(t.key),this.Uo)},Tc),Ec=(n(Ic,oc=wc),Object.defineProperty(Ic.prototype,"id",{get:function(){return this.vf.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(Ic.prototype,"parent",{get:function(){var t=this.vf.path.O();return t.M()?null:new yc(new Qi(t),this.firestore,null)},enumerable:!0,configurable:!0}),Object.defineProperty(Ic.prototype,"path",{get:function(){return this.vf.path.j()},enumerable:!0,configurable:!0}),Ic.prototype.doc=function(t){Cu("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Gs.cn()),qu("CollectionReference.doc","non-empty string",1,t);var e=Li.G(t);return yc.Tf(this.vf.path.child(e),this.firestore,this.Uo)},Ic.prototype.add=function(t){Vu("CollectionReference.add",arguments,1),qu("CollectionReference.add","object",1,this.Uo?this.Uo.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Ic.prototype.withConverter=function(t){return new Ic(this.jf,this.firestore,t)},Ic);function Ic(t,e,n){var i=this;if(((i=oc.call(this,Eo.Wt(t),e,n)||this).jf=t).length%2!=1)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.j()+" has "+t.length);return i}function Tc(t,e,n,i){this.If=t,this.xf=e,this.Bf=n,this.Uo=i,this.Uf=null,this.Qf=null,this.metadata=new vc(n.hasPendingWrites,n.fromCache)}function Ac(t,e,n){var i=this;return(i=sc.call(this,e.xo,e.af,t)||this).vf=t,i.firestore=e,i.Uo=n,i}function Nc(t,e,n){this.xo=t,this.af=e,this.vf=n}function _c(){return null!==uc&&uc.apply(this,arguments)||this}function Dc(t,e,n,i,r,o){this.If=t,this.Bo=e,this.yf=n,this.gf=i,this.bf=r,this.Uo=o}function Sc(t,e){this.hasPendingWrites=t,this.fromCache=e}function Rc(t,e,n){var i=this;return(i=ac.call(this,e.xo,t,n)||this).Bo=t,i.firestore=e,i.Uo=n,i.ef=i.firestore.tf(),i}function Oc(t){this.If=t,this.mf=[],this.Af=!1}function kc(t,e){this.If=t,this.Rf=e}function Pc(t,e,n){var i=this;if(void 0===n&&(n=new Qh),this.J_=null,this.Z_=new Eu,this.INTERNAL={delete:function(){return l(i,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.tf(),[4,this.ef.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var r=t;this.J_=r,this.xo=Pc.sf(r),this.if=r.name,this.nf=new Di(e)}else{var o=t;if(!o.projectId)throw new Ni(Ai.INVALID_ARGUMENT,"Must provide projectId");this.xo=new Ys(o.projectId,o.database),this.if="[DEFAULT]",this.nf=new _i}this.rf=n,this.hf=new fc({})}function Lc(t){var e,n,i,r;if(void 0===t.host){if(void 0!==t.ssl)throw new Ni(Ai.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ju("settings","non-empty string","host",t.host),this.host=t.host,Fu("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Yu("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Fu("settings","object","credentials",t.credentials),this.credentials=t.credentials,Fu("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Fu("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?xs("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&xs("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(i=t.ignoreUndefinedProperties)&&void 0!==i&&i,Fu("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Nu.hh;else{if(t.cacheSizeBytes!==cc&&t.cacheSizeBytes<Nu.rh)throw new Ni(Ai.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Nu.rh);this.cacheSizeBytes=t.cacheSizeBytes}Fu("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(r=t.experimentalForceLongPolling)&&void 0!==r&&r}function Uc(t,e,n,i){this.ii=t,this.timestampsInSnapshots=e,this.Q_=n,this.W_=i}function Vc(t,e){if(void 0===e)return{merge:!1};if(Yu(t,e,["merge","mergeFields"]),Fu(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,i){if(!(n instanceof Array))throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Wu(n));for(var r=0;r<n.length;++r)if(!i(n[r]))throw new Ni(Ai.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+Wu(n[r]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof ra}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Ni(Ai.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Mc(t,e){return void 0===e?{}:(Yu(t,e,["serverTimestamps"]),Bu(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Cc(t,e){xu(t,"object",1,e),e&&(Yu(t,e,["source"]),Bu(t,0,"source",e.source,["default","server","cache"]))}function qc(t,e,n){if(e instanceof Na){if(e.firestore!==n)throw new Ni(Ai.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Xu(t,"DocumentReference",1,e)}function xc(t,e,n){var i;return t?(i=t.toFirestore(e),n="toFirestore() in "+n):i=e,[i,n]}function jc(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new Ni(Ai.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}var Fc,Bc=jc(lc,"Use firebase.firestore() instead."),Gc=jc(pc,"Use firebase.firestore().runTransaction() instead."),zc=jc(dc,"Use firebase.firestore().batch() instead."),Hc=jc(yc,"Use firebase.firestore().doc() instead."),Wc=jc(gc),Qc=jc(mc),Yc=jc(wc),Xc=jc(bc),Kc=jc(Ec,"Use firebase.firestore().collection() instead."),$c=jc(Ea,"Use FieldValue.<field>() instead."),Jc=jc(ia,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Zc={Firestore:Bc,GeoPoint:Ta,Timestamp:Oi,Blob:Jc,Transaction:Gc,WriteBatch:zc,DocumentReference:Hc,DocumentSnapshot:Wc,Query:Yc,QueryDocumentSnapshot:Qc,QuerySnapshot:Xc,CollectionReference:Kc,FieldPath:ra,FieldValue:$c,setLogLevel:lc.setLogLevel,CACHE_SIZE_UNLIMITED:cc},tf=(cf.prototype.ou=function(t){},cf.prototype.yu=function(){},cf),ef=(hf.prototype.ou=function(t){this.Yf.push(t)},hf.prototype.yu=function(){window.removeEventListener("online",this.Gf),window.removeEventListener("offline",this.Kf)},hf.prototype.Xf=function(){window.addEventListener("online",this.Gf),window.addEventListener("offline",this.Kf)},hf.prototype.Hf=function(){qs("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Yf;t<e.length;t++)(0,e[t])(0)},hf.prototype.zf=function(){qs("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Yf;t<e.length;t++)(0,e[t])(1)},hf.Jf=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},hf),nf=(af.prototype.Aa=function(t){this.ed=t},af.prototype.Ta=function(t){this.sd=t},af.prototype.onMessage=function(t){this.nd=t},af.prototype.close=function(){this.td()},af.prototype.send=function(t){this.Zf(t)},af.prototype.rd=function(){this.ed()},af.prototype.hd=function(t){this.sd(t)},af.prototype.od=function(t){this.nd(t)},af),rf={BatchGetDocuments:"batchGet",Commit:"commit"},of="gl-js/ fire/"+mi,sf=(uf.prototype.ud=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=of},uf.prototype.La=function(a,i,r){var h=this,c=this.ld(a);return new Promise(function(o,s){var u=new gi;u.listenOnce(yi.COMPLETE,function(){try{switch(u.getLastErrorCode()){case di.NO_ERROR:var t=u.getResponseJson();qs("Connection","XHR received:",JSON.stringify(t)),o(t);break;case di.TIMEOUT:qs("Connection",'RPC "'+a+'" timed out'),s(new Ni(Ai.DEADLINE_EXCEEDED,"Request time out"));break;case di.HTTP_ERROR:var e,n,i=u.getStatus();qs("Connection",'RPC "'+a+'" failed with status:',i,"response text:",u.getResponseText()),0<i?(e=u.getResponseJson().error)&&e.status&&e.message?(r=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Ai).indexOf(r)?r:Ai.UNKNOWN,s(new Ni(n,e.message))):s(new Ni(Ai.UNKNOWN,"Server responded with status "+u.getStatus())):(qs("Connection",'RPC "'+a+'" failed'),s(new Ni(Ai.UNAVAILABLE,"Connection failed.")));break;default:Fs()}}finally{qs("Connection",'RPC "'+a+'" completed.')}var r});var t=Object.assign({},i);delete t.database;var e=JSON.stringify(t);qs("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.ud(n,r),u.send(c,"POST",e,n,15)})},uf.prototype.Oa=function(t,e,n){return this.La(t,e,n)},uf.prototype.Pa=function(t,e){var n,i,r=[this.ad,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=pi(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ii.projectId+"/databases/"+this.ii.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.ud(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=v().indexOf("Electron/")||0<=(i=v()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=v().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}qs("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new nf({Zf:function(t){f?qs("Connection","Not sending because WebChannel is closed:",t):(c||(qs("Connection","Opening WebChannel transport."),h.open(),c=!0),qs("Connection","WebChannel sending:",t),h.send(t))},td:function(){return h.close()}});return a(vi.EventType.OPEN,function(){f||qs("Connection","WebChannel transport opened.")}),a(vi.EventType.CLOSE,function(){f||(f=!0,qs("Connection","WebChannel transport closed"),l.hd())}),a(vi.EventType.ERROR,function(t){f||(f=!0,function(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Vs.logLevel<=p.WARN&&(e=n.map(js),Vs.warn.apply(Vs,y(["Firestore ("+mi+"): Connection"],e)))}("Connection","WebChannel transport errored:",t),l.hd(new Ni(Ai.UNAVAILABLE,"The operation could not be completed")))}),a(vi.EventType.MESSAGE,function(t){var e,n,i,r,o,s;f||(Bs(!!(n=t.data[0])),(i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(qs("Connection","WebChannel received error:",i),r=i.status,o=function(){var t=oo[r];if(void 0!==t)return Wo(t)}(),s=i.message,void 0===o&&(o=Ai.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),f=!0,l.hd(new Ni(o,s)),h.close()):(qs("Connection","WebChannel received:",n),l.od(n)))}),setTimeout(function(){l.rd()},0),l},uf.prototype.ld=function(t){var e=rf[t];return this.ad+"/v1/projects/"+this.ii.projectId+"/databases/"+this.ii.database+"/documents:"+e},uf);function uf(t){this.ii=t.ii;var e=t.ssl?"https":"http";this.ad=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function af(t){this.Zf=t.Zf,this.td=t.td}function hf(){var t=this;this.Gf=function(){return t.Hf()},this.Kf=function(){return t.zf()},this.Yf=[],this.Xf()}function cf(){}function ff(){this.yo="undefined"!=typeof atob}Us.an((Object.defineProperty(ff.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(ff.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),ff.prototype.L_=function(t){return Promise.resolve(new sf(t))},ff.prototype.D_=function(){return new(ef.Jf()?ef:tf)},ff.prototype.Yo=function(t){return new ks(t,{hi:!0})},ff.prototype.un=function(t){return JSON.stringify(t)},ff.prototype.atob=function(t){return atob(t)},ff.prototype.btoa=function(t){return btoa(t)},ff.prototype.ln=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n},new ff)),(Fc=lf).INTERNAL.registerComponent(new T("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new lc(e,n,new Qh);var e,n},"PUBLIC").setServiceProps(Object.assign({},Zc))),Fc.registerVersion("@firebase/firestore","1.15.4")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
